<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/linux/SRE/03-identity-security/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.0, mkdocs-material-7.3.6"><title>Identity & Security - UPSkilling</title><link rel=stylesheet href=../../../assets/stylesheets/main.a57b2b03.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.3f5d1f46.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <script>function __prefix(e){return new URL("../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=UPSkilling class="md-header__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> UPSkilling </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Identity & Security </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> UPSkilling </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Linux </a> </li> <li class=md-tabs__item> <a href=../../../k8s/ class=md-tabs__link> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../python/ class=md-tabs__link> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=UPSkilling class="md-nav__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> UPSkilling </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> UPSkilling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=UPSkilling data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> UPSkilling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-fundamentals/ class=md-nav__link> Linux Fundamentals </a> </li> <li class=md-nav__item> <a href=../02-filesystem/ class=md-nav__link> File System </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Identity & Security <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Identity & Security </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 用户、组、权限 </a> </li> <li class=md-nav__item> <a href=#selinux-acl class=md-nav__link> SELinux &amp; ACL </a> <nav class=md-nav aria-label="SELinux & ACL"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selinux class=md-nav__link> SELinux主要概念 </a> </li> <li class=md-nav__item> <a href=#selinux-in-opensuse class=md-nav__link> SELinux in openSUSE </a> </li> <li class=md-nav__item> <a href=#selinux-in-ubuntu class=md-nav__link> SELinux in Ubuntu </a> </li> <li class=md-nav__item> <a href=#selinux-in-rocky class=md-nav__link> SELinux in Rocky </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 用户和组的配置文件 </a> <nav class=md-nav aria-label=用户和组的配置文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcpasswd class=md-nav__link> /etc/passwd </a> </li> <li class=md-nav__item> <a href=#etcshadow class=md-nav__link> /etc/shadow </a> </li> <li class=md-nav__item> <a href=#etcgroup class=md-nav__link> /etc/group </a> </li> <li class=md-nav__item> <a href=#etcgshadow class=md-nav__link> /etc/gshadow </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 生成随机密码 </a> </li> <li class=md-nav__item> <a href=#vipwvigrpwckgrpck class=md-nav__link> vipw/vigr/pwck/grpck命令 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 用户和组的管理文件 </a> <nav class=md-nav aria-label=用户和组的管理文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#useradd class=md-nav__link> useradd命令 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Case Study <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Case Study" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Case Study </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/demo/cap_on_kyma/ class=md-nav__link> Build CAP application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Foundation/ch00/ class=md-nav__link> 安装 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch01/ class=md-nav__link> 语言基础 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch02/ class=md-nav__link> 打包和拆包 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch03/ class=md-nav__link> 函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch04/ class=md-nav__link> 面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch05/ class=md-nav__link> 面向对象特性 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/Algorithms/ class=md-nav__link> 数据结构和算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 用户、组、权限 </a> </li> <li class=md-nav__item> <a href=#selinux-acl class=md-nav__link> SELinux &amp; ACL </a> <nav class=md-nav aria-label="SELinux & ACL"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#selinux class=md-nav__link> SELinux主要概念 </a> </li> <li class=md-nav__item> <a href=#selinux-in-opensuse class=md-nav__link> SELinux in openSUSE </a> </li> <li class=md-nav__item> <a href=#selinux-in-ubuntu class=md-nav__link> SELinux in Ubuntu </a> </li> <li class=md-nav__item> <a href=#selinux-in-rocky class=md-nav__link> SELinux in Rocky </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 用户和组的配置文件 </a> <nav class=md-nav aria-label=用户和组的配置文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#etcpasswd class=md-nav__link> /etc/passwd </a> </li> <li class=md-nav__item> <a href=#etcshadow class=md-nav__link> /etc/shadow </a> </li> <li class=md-nav__item> <a href=#etcgroup class=md-nav__link> /etc/group </a> </li> <li class=md-nav__item> <a href=#etcgshadow class=md-nav__link> /etc/gshadow </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 生成随机密码 </a> </li> <li class=md-nav__item> <a href=#vipwvigrpwckgrpck class=md-nav__link> vipw/vigr/pwck/grpck命令 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 用户和组的管理文件 </a> <nav class=md-nav aria-label=用户和组的管理文件> <ul class=md-nav__list> <li class=md-nav__item> <a href=#useradd class=md-nav__link> useradd命令 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/linux/SRE/03-identity-security.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg> </a> <h1 id=_1>身份与安全<a class=headerlink href=#_1 title="Permanent link"> ¶</a></h1> <h2 id=_2>用户、组、权限<a class=headerlink href=#_2 title="Permanent link"> ¶</a></h2> <p>用户和组</p> <ul> <li>用户user和组group在Linux系统中以数字形式进行管理。</li> <li>用户被分配的号码称为用户ID（UID）。 </li> <li>每个Linux系统都有一个特权用户，即<code>root</code>用户。 <code>root</code>是系统管理员。 此用户的UID始终为0。</li> <li>普通用户的UID编号（默认情况下）为1000。</li> <li>每个组也分配了一个称为组ID（GID）的编号。</li> <li>每个用户有一个主要组（primary group），有零个或者任意个附加组（supplementary group）。</li> </ul> <p>以openSUSE为例：</p> <ul> <li>UID</li> <li>0: root</li> <li>1 – 99: System</li> <li>100 – 499: System accounts</li> <li> <p>≥ 1000: Normal (unprivileged) accounts</p> </li> <li> <p>GID</p> </li> <li>0: root</li> <li>1 – 99: System Groups</li> <li>100 – 499: Dynamically Allocated System Groups</li> <li>≥ 1000: Normal Groups</li> </ul> <p>举例： <div class=highlight><pre><span></span><code>$ id postfix
uid=51(postfix) gid=51(postfix) groups=482(mail),59(maildrop),51(postfix)

$ id vagrant
uid=1000(vagrant) gid=478(wheel) groups=0(root),478(wheel)
</code></pre></div></p> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p>UID和GID等编号规则，是在文件<code>/etc/login.defs</code>中约定的。</p> </div> <h2 id=selinux-acl>SELinux &amp; ACL<a class=headerlink href=#selinux-acl title="Permanent link"> ¶</a></h2> <p>Security-Enhanced Linux (SELinux) 是一种Linux系统的安全架构，它允许管理员更好地控制谁可以访问系统。 SELinux于2000年向开源社区发布，并于2003年集成到上游 Linux 内核中。</p> <p>SELinux为系统上的应用程序、进程和文件定义了访问控制。 它使用安全策略（一组规则告诉SELinux什么可以访问或不可以访问）来强制执行策略允许的访问。</p> <p>当称为主体（subject）的应用程序或进程请求访问对象（如文件）时，SELinux会检查访问向量缓存(AVC, Access Vector Cache)，其中缓存了主体和对象的权限。</p> <p>如果SELinux无法根据缓存的权限做出访问决定，它会将请求发送到安全服务器。 安全服务器检查应用程序或进程和文件的安全上下文。 从SELinux策略数据库应用安全上下文（Security context），然后授予或拒绝许可。 如果权限被拒绝，<code>avc: denied</code>消息将在<code>/var/log.messages</code>中体现。</p> <p>传统上，Linux和UNIX系统都使用DAC（Discretionary Access Control）。 SELinux是Linux的MAC（Mandatory Access Control）系统的一个示例。</p> <p>在DAC方式下，文件和进程有自己的属主（所有者）。 用户可以拥有一个文件，一个组也可以拥有一个文件，或者其他人。 用户可以更改自己文件的权限。<code>root</code>用户对DAC系统具有完全访问控制权。 </p> <p>但是在像SELinux这样的MAC系统上，对于访问的管理是通过设置策略来实现的。即使用户主目录上的DAC设置发生更改，用于防止其他用户或进程访问该目录的SELinux策略也将继续确保系统安全。</p> <p>MAC方式是控制一个进程对具体文件系统上面的文件或目录是否拥有访问权限。判断进程是否可以访问文件或目录的依据，取决于SELinux中设定的很多策略规则。</p> <p>访问控制列表 (ACL，Access Control List) 为文件系统提供了一种额外的、更灵活的权限机制。 它旨在协助 UNIX 文件权限。ACL允许授予任何用户或组对任何磁盘资源的权限。ACL适用于在不使某个用户成为组成员的情况下，仍旧授予一些读或写访问权限。</p> <p>下面示例对比说明了SELinux和ACL在文件属性展现上的特点。</p> <ul> <li><code>-rwxr-xr-- vagrant wheel</code> ：没有selinux上下文，没有ACL</li> <li><code>-rwx--xr-x+ vagrant wheel</code> ：只有ACL，没有selinux上下文</li> <li><code>-rw-r--r--. vagrant wheel</code> ：只有selinux上下文，没有ACL</li> <li><code>-rwxrwxr--+ vagrant wheel</code> ：有selinux上下文，有ACL</li> </ul> <h3 id=selinux>SELinux主要概念<a class=headerlink href=#selinux title="Permanent link"> ¶</a></h3> <ul> <li> <p>用户(Users)：</p> <ul> <li>SELinux的用户不等同与Linux用户。</li> <li>SELinux用户以后缀<code>_u</code>结尾。</li> </ul> </li> <li> <p>角色(Roles)：</p> <ul> <li>角色Roles是由策略Policies定义的，角色决定了使用哪个策略。</li> <li>SELinux角色以后缀<code>_r</code>结尾。</li> </ul> </li> <li> <p>类型(Types)：</p> <ul> <li>SELinux是类型强制的，类型Types决定进程能否访问某个文件。</li> <li>SELinux类型是以后缀<code>_t</code>结尾。</li> </ul> </li> <li> <p>上下文(Contexts)：</p> <ul> <li>用来标记进程和文件。分别是用户Users，角色Roles，类型Types，范围Ranges。</li> <li>格式：<code>user:role:type:range</code></li> </ul> </li> <li> <p>文件类型(Object Classes)：</p> <ul> <li>每个文件类型Types都对应一套策略Policies。策略Policies决定了进程对这类文件的访问权限。</li> <li>访问权限有4种：<ul> <li>创建create</li> <li>读取read</li> <li>写入write</li> <li>删除unlink（注意，这里不是链接的意思）</li> </ul> </li> </ul> </li> <li> <p>规则(Rules)</p> <ul> <li>格式：<code>allow user_t user_home_t:file {create read write unlink};</code></li> <li>含义：<code>user_t</code>类型对<code>user_home_t</code>类型有创建create，读取read，写入write，删除unlink权限。</li> </ul> </li> </ul> <h3 id=selinux-in-opensuse>SELinux in openSUSE<a class=headerlink href=#selinux-in-opensuse title="Permanent link"> ¶</a></h3> <p>作为SELinux的替代品，2005年被Novell收购的Immunix公司开发了AppArmor。SUSE在openSUSE Leap中提供对SELinux框架的支持。这并不意味着openSUSE Leap的默认安装会在不久的将来从AppArmor切换到SELinux。</p> <p>添加SELinux的源。可以从<code>https://download.opensuse.org/repositories/security:/SELinux/</code>下载对应的策略policy。 <div class=highlight><pre><span></span><code>$ sudo zypper ar -f https://download.opensuse.org/repositories/security:/SELinux/openSUSE_Factory/ Security-SELinux
</code></pre></div></p> <p>安装C++等基础开发包： <div class=highlight><pre><span></span><code># 列出当前可安装的Pattern
sudo zypper pt

# 安装下面几个开发相关的Pattern
sudo zypper in -t pattern devel_C_C++ devel_basis devel_kernel
</code></pre></div></p> <p>安装SELinux packages： <div class=highlight><pre><span></span><code>$ zypper se --search-descriptions selinux
$ sudo zypper in restorecond policycoreutils setools-console
$ sudo zypper in selinux-tools libselinux-devel
</code></pre></div></p> <p>安装SELinux policy： <div class=highlight><pre><span></span><code>$ sudo zypper in selinux-policy-targeted selinux-policy-devel selinux-autorelabel
</code></pre></div></p> <p>更新GRUB2 bootloader（GRUB2引导加载程序）：</p> <p>编辑文件<code>/etc/default/grub</code>，添加下面内容到<code>GRUB_CMDLINE_LINUX_DEFAULT=</code>这一行： <div class=highlight><pre><span></span><code>security=selinux selinux=1
</code></pre></div> 记录这一行的原始信息： <div class=highlight><pre><span></span><code>GRUB_CMDLINE_LINUX_DEFAULT=&quot;splash=silent resume=/dev/disk/by-uuid/47c36ad7-f49f-4ecd-9b72-4801c5bb3a04 preempt=full mitigations=auto quiet security=apparmor&quot;
</code></pre></div> 运行下面的命令生成新的GRUB2引导加载程序配置文件。 <div class=highlight><pre><span></span><code>$ sudo grub2-mkconfig -o /boot/grub2/grub.cfg
</code></pre></div></p> <p>编辑文件<code>/etc/selinux/config</code> 并设置 <code>SELINUX=permissive</code>来启用SElinux。这与前面GRUB2的启动配置是一致的。 如文件不存在，则创建。 <div class=highlight><pre><span></span><code>$ sudo cat /etc/selinux/config
SELINUX=permissive
SELINUXTYPE=targeted
</code></pre></div></p> <p>重启系统。系统启动可能需要一些时间，SELinux需要给整个文件系统重新进行标签化。</p> <p>重启后，运行下面的命令来查看SELinux是否运行正常。 <div class=highlight><pre><span></span><code>$ sudo getenforce
Permissive
</code></pre></div></p> <div class=highlight><pre><span></span><code>$ sudo sestatus -v
SELinux status:                 enabled
SELinuxfs mount:                /sys/fs/selinux
SELinux root directory:         /etc/selinux
Loaded policy name:             targeted
Current mode:                   permissive
Mode from config file:          permissive
Policy MLS status:              enabled
Policy deny_unknown status:     allowed
Memory protection checking:     requested (insecure)
Max kernel policy version:      33

Process contexts:
Current context:                unconfined_u:unconfined_r:unconfined_t:s0
Init context:                   system_u:system_r:kernel_t:s0
/sbin/agetty                    system_u:system_r:kernel_t:s0
/usr/sbin/sshd                  system_u:system_r:kernel_t:s0

File contexts:
Controlling terminal:           unconfined_u:object_r:devpts_t:s0
/etc/passwd                     system_u:object_r:unlabeled_t:s0
/etc/shadow                     system_u:object_r:unlabeled_t:s0
/bin/bash                       system_u:object_r:unlabeled_t:s0 -&gt; system_u:object_r:unlabeled_t:s0
/bin/login                      system_u:object_r:unlabeled_t:s0
/bin/sh                         system_u:object_r:unlabeled_t:s0 -&gt; system_u:object_r:unlabeled_t:s0
/sbin/agetty                    system_u:object_r:unlabeled_t:s0 -&gt; system_u:object_r:unlabeled_t:s0
/sbin/init                      system_u:object_r:unlabeled_t:s0 -&gt; system_u:object_r:unlabeled_t:s0
/usr/sbin/sshd                  system_u:object_r:unlabeled_t:s0
</code></pre></div> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p>GRUB2引导加载程序中添加的三个参数的解释：</p> <p><code>security=selinux</code>: This option tells the kernel to use SELinux and not AppArmor.</p> <p><code>selinux=1</code>: This option switches on SELinux.</p> <p><code>enforcing=0</code>: This option puts SELinux in permissive mode. In this mode, SELinux is fully functional, but does not enforce any of the security settings in the policy. Use this mode for testing and configuring your system. To switch on SELinux protection, when the system is fully operational, change the option to <code>enforcing=1</code> and add <code>SELINUX=enforcing</code> in <code>/etc/selinux/config</code>. </p> </div> <div class="admonition tips"> <p class=admonition-title>Tips</p> <p>在首次启用SELinux后，如果只在grub2里面添加selinux=1，通过<code>getenforce</code>命令看的SELinux一直就是disabled的状态，需要手工创建/etc/selinux/config文件添加配置才行。感觉grub2里面无需设置，直接配置/etc/selinux/config文件。不确定这个想法是否正确。</p> <p>在grub2中设定selinux=1，在/etc/selinux/config文件中：</p> <ul> <li>设定SELINUX=permissive，重启后通过<code>getenforce</code>命令看到的是permissive。</li> <li>设定SELINUX=disabled，则重启后<code>getenforce</code>命令看到的是disabled。</li> </ul> <p>这说明配置文件后启动，覆盖了内核设置。</p> <p>注意，如果仅仅完成了上面的enable SELinux，立刻设定SELINUX=enforcing，会引起ssh无法登录，错误信息是<code>/bin/bash: Permission denied</code>。</p> </div> <p>配置SELinux。</p> <p><div class=highlight><pre><span></span><code>sudo semanage boolean -l
</code></pre></div> Failed to use semanage</p> <p>添加下面内容到.bashrc文件。 <div class=highlight><pre><span></span><code>export PATH=/usr/local/bin:/home/$USER/.local/bin:$PATH
</code></pre></div> 更新pip3. <div class=highlight><pre><span></span><code>pip3 install --upgrade pip
</code></pre></div></p> <p>安装下面几个包 <div class=highlight><pre><span></span><code>sudo zypper in libselinux libselinux-devel
sudo zypper in python3-semanage
sudo zypper in libsemanage-devel libsemanage-devel-static
sudo zypper in policycoreutils-python-utils
sudo zypper in cross-x86_64-linux-glibc-devel glibc-utils glibc-profile

sudo zypper in policycoreutils-devel
</code></pre></div></p> <h3 id=selinux-in-ubuntu>SELinux in Ubuntu<a class=headerlink href=#selinux-in-ubuntu title="Permanent link"> ¶</a></h3> <h3 id=selinux-in-rocky>SELinux in Rocky<a class=headerlink href=#selinux-in-rocky title="Permanent link"> ¶</a></h3> <h2 id=_3>用户和组的配置文件<a class=headerlink href=#_3 title="Permanent link"> ¶</a></h2> <ul> <li><code>/etc/passwd</code>：用户及其属性信息（用户名，UID，主组ID等）</li> <li><code>/etc/shadow</code>：用户密码机器属性</li> <li><code>/etc/group</code>：组及其属性</li> <li><code>/etc/gshadow</code>：组密码及其属性</li> </ul> <h3 id=etcpasswd>/etc/passwd<a class=headerlink href=#etcpasswd title="Permanent link"> ¶</a></h3> <p>格式说明： <div class=highlight><pre><span></span><code>vagrant:x:1001:474:vagrant:/home/vagrant:/bin/bash
[-----] - [--] [-] [-----] [-----------] [-------]
   |    |  |    |     |          |           +--------&gt; 7. Login shell
   |    |  |    |     |          +--------------------&gt; 6. Home directory
   |    |  |    |     +-------------------------------&gt; 5. GECOS or the full name of the user
   |    |  |    +-------------------------------------&gt; 4. GID
   |    |  +------------------------------------------&gt; 3. UID
   |    +---------------------------------------------&gt; 2. Password
   +--------------------------------------------------&gt; 1. Username
</code></pre></div></p> <h3 id=etcshadow>/etc/shadow<a class=headerlink href=#etcshadow title="Permanent link"> ¶</a></h3> <p>格式说明： <div class=highlight><pre><span></span><code>vagrant:$6$.n.:17736:0:99999:7:::
[-----] [----] [---] - [---] ----
|         |      |   |   |   |||+-----------&gt; 9. Unused
|         |      |   |   |   ||+------------&gt; 8. Expiration date since Jan 1, 1970
|         |      |   |   |   |+-------------&gt; 7. Inactivity period 密码过期后的宽限期
|         |      |   |   |   +--------------&gt; 6. Warning period, default 7 days
|         |      |   |   +------------------&gt; 5. Maximum password age
|         |      |   +----------------------&gt; 4. Minimum password age
|         |      +--------------------------&gt; 3. Last password change since Jan 1, 1970
|         +---------------------------------&gt; 2. Encrypted Password
+-------------------------------------------&gt; 1. Username
</code></pre></div></p> <h3 id=etcgroup>/etc/group<a class=headerlink href=#etcgroup title="Permanent link"> ¶</a></h3> <p>格式说明： <div class=highlight><pre><span></span><code>audio:x:492:pulse
[---] - [-] [---]
  |   |  |    +----&gt; 4. username-list, who have this group as their supplementary
  |   |  +---------&gt; 3. GID
  |   +------------&gt; 2. group-password. Real password is in /etc/gshadow
  +----------------&gt; 1. groupname
</code></pre></div></p> <h3 id=etcgshadow>/etc/gshadow<a class=headerlink href=#etcgshadow title="Permanent link"> ¶</a></h3> <p>格式说明： <div class=highlight><pre><span></span><code>general:!!:shelley:juan,bob
[-----] -- [-----] [------]
   |     |     |       +-------&gt; 4. group members (in a comma delimited list)
   |     |     +---------------&gt; 3. group adminstrators (in a comma delimited list)
   |     +---------------------&gt; 2. encrypted password. `!`, `!!`, and null
   +---------------------------&gt; 1. group name
</code></pre></div></p> <p>Encrypted password</p> <ul> <li><code>!</code>：no user is allowed to access the group using the newgrp command.</li> <li><code>!!</code>：the same as a value of <code>!</code> — however, it also indicates that a password has never been set before. </li> <li>null：only group members can log into the group.</li> </ul> <h3 id=_4>生成随机密码<a class=headerlink href=#_4 title="Permanent link"> ¶</a></h3> <div class=highlight><pre><span></span><code># 通过`/dev/urandom`生成随机数，通过`tr -dc`过滤随机数，只保留字母和数字，通过`head -c`保留指定位数
$ tr -dc &#39;[:alnum:]&#39; &lt; /dev/urandom | head -c 12
xFw7vfma54D8

$ openssl rand -base64 9
I5TZXJfpd3Pg
</code></pre></div> <h3 id=vipwvigrpwckgrpck>vipw/vigr/pwck/grpck命令<a class=headerlink href=#vipwvigrpwckgrpck title="Permanent link"> ¶</a></h3> <p><code>vipw</code>和<code>vigr</code>命令分别编辑文件<code>/etc/passwd</code>和<code>/etc/group</code>。 如果指定了<code>-s</code>标志，这些命令将分别编辑其文件的影子（安全）版本：<code>/etc/shadow</code>和<code>/etc/gshadow</code>。 <code>vipw</code>和<code>vigr</code>命令在编辑文件时会设置锁以防止文件损坏。 <code>vipw</code>和<code>vigr</code>命令会首先尝试环境变量<code>$VISUAL</code>，然后是环境变量<code>$EDITOR</code>，最后是默认编辑器<code>vi</code>。</p> <div class=highlight><pre><span></span><code>$ sudo vipw
$ sudo vipw -s
$ sudo vigr
$ sudo vigr -s
</code></pre></div> <p><code>pwck</code>命令实现验证系统认证信息的完整性。 检查<code>/etc/passwd</code>和<code>/etc/shadow</code>中的所有条目每个字段是否具有正确的格式和有效数据。 系统会提示用户删除格式不正确或存在其他错误的条目。</p> <p><code>pwck</code>返回值：</p> <ul> <li><code>0</code>: success</li> <li><code>1</code>: invalid command syntax</li> <li><code>2</code>: one or more bad password entries</li> <li><code>3</code>: can’t open password files</li> <li><code>4</code>: can’t lock password files</li> <li><code>5</code>: can’t update password files </li> </ul> <p><code>grpck</code>命令实现验证系统认证信息的完整性。 检查<code>/etc/group</code>和<code>/etc/gshadow</code>中的所有条目每个字段是否具有正确的格式和有效数据。 系统会提示用户删除格式不正确或存在其他错误的条目。</p> <p><code>grpck</code>返回值：</p> <ul> <li><code>0</code>: success</li> <li><code>1</code>: invalid command syntax</li> <li><code>2</code>: one or more bad group entries</li> <li><code>3</code>: can’t open group files</li> <li><code>4</code>: can’t lock group files</li> <li><code>5</code>: can’t update group files </li> </ul> <h2 id=_5>用户和组的管理文件<a class=headerlink href=#_5 title="Permanent link"> ¶</a></h2> <p>用户管理命令：</p> <ul> <li><code>useradd</code></li> <li><code>usermod</code></li> <li><code>userdel</code></li> </ul> <p>组管理命令：</p> <ul> <li><code>groupadd</code></li> <li><code>groupmod</code></li> <li><code>groupdel</code></li> </ul> <h3 id=useradd>useradd命令<a class=headerlink href=#useradd title="Permanent link"> ¶</a></h3> <p>举例： <div class=highlight><pre><span></span><code># 普通用户
$ useradd -m -g wheel -G root -c &quot;vagrant&quot; vagrant

# 非交互用户
$ useradd -r -u 48 -g apache -d /var/www -s /sbin/nologin -g postfix -c &quot;Apache&quot; apache 2&gt;/dev/null
</code></pre></div></p> <p><code>useradd</code>命令的默认值是在<code>/etc/default/useradd</code>文件中设定。</p> <p>openSUSE的<code>/etc/default/useradd</code>文件内容： <div class=highlight><pre><span></span><code>GROUP=100
HOME=/home
INACTIVE=-1              # 对应/etc/shadow文件第7列，Inactivity period，密码过期后的宽限期，-1表示不限制
EXPIRE=                  # 对应/etc/shadow文件第8列，Expiration date since Jan 1, 1970，即账号有效期
SHELL=/bin/bash
SKEL=/etc/skel
USRSKEL=/usr/etc/skel    # 用于生成用户主目录的模版文件
CREATE_MAIL_SPOOL=yes
</code></pre></div></p> <p>Rocky的<code>/etc/default/useradd</code>文件内容： <div class=highlight><pre><span></span><code>GROUP=100
HOME=/home
INACTIVE=-1
EXPIRE=
SHELL=/bin/bash
SKEL=/etc/skel
CREATE_MAIL_SPOOL=yes
</code></pre></div></p> <p>在Ubuntu中<code>/etc/default/useradd</code>文件只有下面这一行。 <div class=highlight><pre><span></span><code>SHELL=/bin/sh
</code></pre></div></p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top data-md-state=hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../02-filesystem/ class="md-footer__link md-footer__link--prev" aria-label="Previous: File System" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> File System </div> </div> </a> <a href=../../Administration/01/ class="md-footer__link md-footer__link--next" aria-label="Next: Linux File System Overview" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Linux File System Overview </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.fcfe8b6d.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "version": null}</script> <script src=../../../assets/javascripts/bundle.b1047164.min.js></script> </body> </html>