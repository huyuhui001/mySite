<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/linux/SRE/04-TextTools/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>Text Tools - UPSkilling</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=UPSkilling class="md-header__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> UPSkilling </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Text Tools </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> UPSkilling </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Linux </a> </li> <li class=md-tabs__item> <a href=../../../k8s/ class=md-tabs__link> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../python/ class=md-tabs__link> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=UPSkilling class="md-nav__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> UPSkilling </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> UPSkilling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=UPSkilling data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> UPSkilling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-fundamentals/ class=md-nav__link> Linux Fundamentals </a> </li> <li class=md-nav__item> <a href=../02-filesystem/ class=md-nav__link> File System </a> </li> <li class=md-nav__item> <a href=../03-identity-security/ class=md-nav__link> Identity & Security </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Text Tools <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Text Tools </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 文本编辑器 </a> <nav class=md-nav aria-label=文本编辑器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vim class=md-nav__link> vim工具 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 文本处理工具 </a> <nav class=md-nav aria-label=文本处理工具> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cat class=md-nav__link> 显示文本内容cat </a> </li> <li class=md-nav__item> <a href=#nl class=md-nav__link> 显示文本行号nl </a> </li> <li class=md-nav__item> <a href=#tac class=md-nav__link> 逆向显示文本内容tac </a> </li> <li class=md-nav__item> <a href=#rev class=md-nav__link> 逆向显示同行内容rev </a> </li> <li class=md-nav__item> <a href=#hexdump class=md-nav__link> 显示非文本文件内容hexdump </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 分页查看文件内容 </a> </li> <li class=md-nav__item> <a href=#head class=md-nav__link> 显示文件头部内容head </a> </li> <li class=md-nav__item> <a href=#tail class=md-nav__link> 显示文件尾部内容tail </a> </li> <li class=md-nav__item> <a href=#cut class=md-nav__link> 按列抽取文本cut </a> </li> <li class=md-nav__item> <a href=#paste class=md-nav__link> 合并多个文件paste </a> </li> <li class=md-nav__item> <a href=#wc class=md-nav__link> 文本统计数据wc </a> </li> <li class=md-nav__item> <a href=#sort class=md-nav__link> 文本排序sort </a> </li> <li class=md-nav__item> <a href=#uniq class=md-nav__link> 去重uniq </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 文本比较 </a> <nav class=md-nav aria-label=文本比较> <ul class=md-nav__list> <li class=md-nav__item> <a href=#diff class=md-nav__link> diff </a> </li> <li class=md-nav__item> <a href=#patch class=md-nav__link> patch </a> </li> <li class=md-nav__item> <a href=#vimdiff class=md-nav__link> vimdiff </a> </li> <li class=md-nav__item> <a href=#cmp class=md-nav__link> cmp </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../05-RegExpress/ class=md-nav__link> Regular Expression </a> </li> <li class=md-nav__item> <a href=../06-FileLookup/ class=md-nav__link> File Lookup </a> </li> <li class=md-nav__item> <a href=../07-FilePacking/ class=md-nav__link> FIle Packing & Unpacking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Case Study <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Case Study" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Case Study </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/demo/cap_on_kyma/ class=md-nav__link> Build CAP application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Foundation/ch00/ class=md-nav__link> 安装 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch01/ class=md-nav__link> 语言基础 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch02/ class=md-nav__link> 打包和拆包 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch03/ class=md-nav__link> 函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch04/ class=md-nav__link> 面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch05/ class=md-nav__link> 面向对象特性 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/Algorithms/ class=md-nav__link> 数据结构和算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 文本编辑器 </a> <nav class=md-nav aria-label=文本编辑器> <ul class=md-nav__list> <li class=md-nav__item> <a href=#vim class=md-nav__link> vim工具 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 文本处理工具 </a> <nav class=md-nav aria-label=文本处理工具> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cat class=md-nav__link> 显示文本内容cat </a> </li> <li class=md-nav__item> <a href=#nl class=md-nav__link> 显示文本行号nl </a> </li> <li class=md-nav__item> <a href=#tac class=md-nav__link> 逆向显示文本内容tac </a> </li> <li class=md-nav__item> <a href=#rev class=md-nav__link> 逆向显示同行内容rev </a> </li> <li class=md-nav__item> <a href=#hexdump class=md-nav__link> 显示非文本文件内容hexdump </a> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 分页查看文件内容 </a> </li> <li class=md-nav__item> <a href=#head class=md-nav__link> 显示文件头部内容head </a> </li> <li class=md-nav__item> <a href=#tail class=md-nav__link> 显示文件尾部内容tail </a> </li> <li class=md-nav__item> <a href=#cut class=md-nav__link> 按列抽取文本cut </a> </li> <li class=md-nav__item> <a href=#paste class=md-nav__link> 合并多个文件paste </a> </li> <li class=md-nav__item> <a href=#wc class=md-nav__link> 文本统计数据wc </a> </li> <li class=md-nav__item> <a href=#sort class=md-nav__link> 文本排序sort </a> </li> <li class=md-nav__item> <a href=#uniq class=md-nav__link> 去重uniq </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 文本比较 </a> <nav class=md-nav aria-label=文本比较> <ul class=md-nav__list> <li class=md-nav__item> <a href=#diff class=md-nav__link> diff </a> </li> <li class=md-nav__item> <a href=#patch class=md-nav__link> patch </a> </li> <li class=md-nav__item> <a href=#vimdiff class=md-nav__link> vimdiff </a> </li> <li class=md-nav__item> <a href=#cmp class=md-nav__link> cmp </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/linux/SRE/04-TextTools.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=_1>文本编辑<a class=headerlink href=#_1 title="Permanent link"> ¶</a></h1> <h2 id=_2>文本编辑器<a class=headerlink href=#_2 title="Permanent link"> ¶</a></h2> <h3 id=vim>vim工具<a class=headerlink href=#vim title="Permanent link"> ¶</a></h3> <p>vim命令格式：</p> <ul> <li><code>+# file</code>: 打开文件后，让光标处于第#行首，+默认行尾</li> <li><code>+/PATTERN file</code>: 打开文件有，让光标处于第一个被PATTERN匹配到的行首</li> <li><code>-b file</code>: 二进制方式打开文件</li> <li><code>-d file1 file2 ...</code>: 比较多个文件，相当于<code>vimdiff</code></li> <li><code>-m file</code>: 只读方式打开文件</li> <li><code>-e file</code>: 进入ex模式，相当于<code>ex file</code></li> <li><code>-y file</code>: </li> </ul> <p>vim三种常见模式：</p> <ul> <li>普通模式Normal或命令模式</li> <li>插入Insert或编辑模式</li> <li>扩展命令模式Extended Command</li> </ul> <p>三种模式切换</p> <ul> <li>命令模式&rarr;插入模式</li> <li>i：insert，在光标处输入</li> <li>I：在光标所在行首输入</li> <li>a：append，在光标处后面输入</li> <li>A：在光标所在行尾输入</li> <li>o：在光标所在行的下方打开一个新行</li> <li>O：在光标所在行的上方打开一个新行</li> <li>插入模式&rarr; ESC &rarr; 命令模式</li> <li>命令模式&rarr; : &rarr; 扩展命令模式</li> <li>扩展命令模式&rarr; ESC, enter &rarr; 命令模式</li> </ul> <p>扩展命令模式常用命令：</p> <ul> <li><code>:wq</code>: 保存文件并退出</li> <li><code>:w</code>: 保存文件</li> <li><code>:w filename</code>: 写入指定文件，相当于另存为</li> <li><code>:q!</code>: 放弃任何修改并退出</li> <li><code>ZQ</code>: 无条件退出</li> <li><code>:join</code>: 合并多行</li> <li><code>J</code>: 合并两行</li> </ul> <p>设置：（可以在<code>/etc/vimrc</code>文件中配置）</p> <ul> <li><code>:set textwidth</code>: 设置文本宽度（从左向右计数）</li> <li><code>:set wrapmargin=#</code>: 设置行边距（从右向左计数）</li> <li><code>:set endofline</code>: 设置文件结束符</li> <li><code>:set noendofline</code>: 取消文件结束符</li> <li><code>:set wrap</code>: 自动换行</li> <li><code>:set nowrap</code>: 取消自动换行</li> <li><code>:set number</code>: 显示行号</li> <li><code>:set nonumber</code>: 取消显示行号</li> <li><code>:set list</code>: 进入List Mode，显示Tab ^I，换行符，和$显示</li> <li><code>:set nolist</code>: 退出List Mode</li> <li><code>:set ignorecase</code>: 忽略字符的大小写</li> <li><code>:set noic</code>: 不忽略字符大小写</li> <li><code>:set autoindent</code>: 启用自动缩进</li> <li><code>:set noai</code>: 关闭自动缩进</li> <li><code>:set hlsearch</code>: 启用高亮搜索</li> <li><code>:set nohlsearch</code>: 关闭高亮搜索</li> <li><code>:set fileformat=dos</code>: 启用windows格式</li> <li><code>:set fileformat=unix</code>: 启用unix格式</li> <li><code>:set expandtab</code>: 启用空格代替TAB，默认8个空格代替一个TAB</li> <li><code>:set noexpandtab</code>: 关闭空格代替TAB</li> <li><code>:set tabstop=#</code>: 指定#个空格代替一个TAB</li> <li><code>:set shiftwidth=#</code>: 设置#个缩进宽度</li> <li><code>:set cursorline</code>: 设置光标所在行的表示线</li> <li><code>:set cursorline</code>: 关闭光标所在行的表示线</li> <li><code>:set key=PASSWORD</code>: 启用密码保护</li> <li><code>:set key=</code>: 关闭密码保护</li> <li><code>:help option-list</code>: 获取帮助</li> </ul> <p>查找</p> <ul> <li><code>/pattern</code>: 从光标开始处向文件尾搜索pattern</li> <li><code>?pattern</code>: 从光标开始处向文件首搜索pattern</li> <li><code>n</code>: 在同一方向重复上一次搜索命令</li> <li><code>N</code>: 在反方向上重复上一次搜索命令</li> <li><code>#</code>: 向上完整匹配光标下的单词, 相当于？word</li> <li><code>*</code>: 向下完整匹配光标下的单词, 相当于/word</li> <li><code>%</code>: 查找对应的( [ {匹配</li> <li><code>nfx</code>: 在当前行查找光标后第n个x（一般直接fx）</li> </ul> <p>替换</p> <ul> <li><code>:%s/\n//g</code>: 删除换行符</li> <li><code>:s/p1/p2/g</code>: 将当前行中所有p1均用p2替代, 无g，则只替换第一个</li> <li><code>:s/p1/p2/c</code>: 查找替换要求确认</li> <li><code>:n1,n2s/p1/p2/g</code>: 将第n1至n2行中所有p1均用p2替代</li> <li><code>:%s/p1/p2/g</code>: 全局，使用p2替换p1</li> <li><code>:%s/p1/p2/gc</code>: 替换前询问</li> <li><code>:n,$s/vivian/sky/</code>: 替换第n行开始到最后一行中每一行的第一个vivian为sky，n为数字</li> <li><code>:.,$s/vivian/sky/g</code>: 替换当前行开始到最后一行中每一行所有vivian为sky</li> <li><code>:s/vivian\//sky\//</code>: 替换当前行第一个vivian/为sky/，可以使用\作为转义符</li> <li><code>:1,$s/^/some string/</code>: 在文件的第一行至最后一行的行首前插入some string</li> <li><code>:%s/$/some string/g</code>: 在整个文件每一行的行尾添加some string</li> <li><code>:%s/\s\+$//</code>: 去掉所有的行尾空格，“\s”表示空白字符（空格和制表符），“+”对前面的字符匹配一次或多次（越多越好），“<span class=arithmatex>\(”匹配行尾（使用“\$”表示单纯的“\)</span>”字符）</li> <li><code>:%s/\s∗\n\+/\r/</code>: 去掉所有的空白行，“<span class=arithmatex>\(”和“\)</span>”对表达式进行分组，使其被视作一个不可分割的整体</li> <li><code>:%s!\s*//.*!!</code>: 去掉所有的“//”注释</li> <li><code>:%s!\s*/\*\_.\{-}\*/\s*!!g</code>: 去掉所有的“/* */”注释</li> <li><code>:%s= *$==</code>: 将所有行尾多余的空格删除</li> <li><code>:g/^\s*$/d</code>: 将所有不包含字符(空格也不包含)的空行删除</li> <li><code>r</code>: 替换当前字符</li> <li><code>R</code>: 替换当前字符及其后的字符，直至按ESC键</li> </ul> <p>编辑</p> <ul> <li><code>h</code>: 光标左移一个字符[回退键Backspace]</li> <li><code>l</code>: 光标右移一个字符[空格键Space]</li> <li><code>K</code>: 光标上移一行</li> <li><code>j</code>: 光标下移一行</li> <li><code>w</code>: 光标跳到下个word的第一个字母(包括标点符号) [常用]</li> <li><code>W</code>: 移到下一个字的开头，忽略标点符号</li> <li><code>B</code>: 光标回到上个word的第一个字母</li> <li><code>B</code>: 移到前一个字的开头，忽略标点符号 BACK</li> <li><code>E</code>: 光标跳到下个word的最后一个字母</li> <li><code>E</code>: 移到下一个字的结尾，忽略标点符号 END</li> <li><code>0</code>: 移到当前一行的开始[Home]</li> <li><code>$</code>: 移到当前一行的最后[End]</li> <li><code>^</code>: 命令将光标移动到当前行的第一个非空白字符上</li> <li><code>g_</code>: 到本行最后一个不是blank字符的位置</li> <li><code>Enter</code>: 光标下移一行</li> <li><code>n+</code>: 光标下移n行【按上档键 数字shift +】</li> <li><code>n-</code>: 光标上移n行</li> <li><code>G</code>: 移到文件的最后一行</li> <li><code>nG</code>或者<code>:n</code>: 移到文件的第n行</li> <li><code>gg</code>: 移动到文档的开始</li> <li><code>[[</code>: 文件开始位置——开始行</li> <li><code>]]</code>: 文件结束位置——末尾行</li> <li><code>H</code>: 光标移至屏幕顶行HEAD。光标定位在显示屏的第一行</li> <li><code>M</code>: 移到屏幕的中间行开头 Middle。光标定位在显示屏的中间</li> <li><code>L</code>: 移到屏幕的最后一行LAST。光标定位在显示屏的最后一行</li> <li><code>(</code>: 光标移至句首</li> <li><code>)</code>: 光标移至句尾</li> <li><code>{</code>: 移到段落的开头</li> <li><code>}</code>: 移到下一个段落的开头</li> <li><code>%</code>: 匹配括号移动，包括 (, {, [.（需要把光标先移到括号上）跳转到与之匹配的括号处</li> <li><code>*</code> 和 <code>#</code>: 匹配光标当前所在的单词，移动光标到下一个（或上一个）匹配单词（*是下一个，#是上一个）</li> <li><code>zf</code>: 折叠（需加方向键）</li> <li><code>zo</code>: 展开（空格也可以展开）</li> <li><code>CTRL+u</code>: 向文件首翻半屏up</li> <li><code>CTRL+d</code>: 向文件尾翻半屏down</li> <li><code>CTRL+f</code>: 向文件尾翻一屏 forward (fact整屏去两行)</li> <li><code>CTRL+b</code>: 向文件首翻一屏back (fact整屏去两行)</li> <li><code>CTRL-]</code>: 跳转到当前光标所在单词对应的主题</li> <li><code>CTRL-O</code>: 回到前一个位置</li> <li><code>SHIFT+V</code>: 选择整行</li> <li><code>zz</code>: 命令会把当前行置为屏幕正中央(z字取其象形意义模拟一张纸的折叠及变形位置重置)</li> <li><code>zt</code>: 命令会把当前行置于屏幕顶端(top)</li> <li><code>zb</code>: 命令会把当前行置于屏幕底端(bottom)</li> <li><code>50%</code>: 光标定位在文件的中间</li> <li><code>`</code>: 跳转到最近光标定位的位置（只能记忆最近两个位置） 反引号</li> <li><code>I</code>: 在光标前开始插入字符 insert</li> <li><code>I</code>: 在当前行首开始插入字符</li> <li><code>A</code>: 在光标位置后开始加字 append</li> <li><code>A</code>: 在光标所在行的最后面开始加字</li> <li><code>O</code>: 在光标下加一空白行并开始加字 open</li> <li><code>O</code>: 在光标上加一空白行并开始加字</li> <li><code>R</code>: 替换当前字符</li> <li><code>R</code>: 替换当前字符及其后的字符【当前及其后字符被覆盖】</li> <li><code>S</code>: 默认删除光标所在字符，输入内容插入之= xi</li> <li><code>S</code>: 默认删除当前行内容，输入内容作为当前行新内容= dd+o</li> <li><code>nx</code>: 删除由光标位置起始后的n个字符（含光标位置）x =dl(删除当前光标下的字符)</li> <li><code>nX</code>: 删除由光标位置起始前的n个字符（含光标位置）X =dh(删除当前光标左边的字符)</li> <li><code>d0</code>: 删至行首</li> <li><code>d$</code>: 删至行尾</li> <li><code>dfa</code>: 表示删除从当前光标到光标后面的第一个a字符之间的内容</li> <li><code>D</code>: 代表d$(删除到行尾的内容)</li> <li><code>C</code>: 代表c$(修改到行尾的内容)</li> <li><code>ndw</code>: 删除光标处开始及其后的n-1个字</li> <li><code>ndb</code>: 删除光标处开始及其前的n-1个字</li> <li><code>diw</code>: 删除当前光标所在的word(不包括空白字符)，意为Delete Inner Word 两个符号之间的单词</li> <li><code>daw</code>: 删除当前光标所在的word(包括空白字符)，意为Delete A Word</li> <li><code>ndd</code>: 删除当前行及其后n-1行</li> <li><code>:n1,n2 d</code>: 将 n1行到n2行之间的内容删除</li> <li><code>dG</code>: 删除当前行至文件尾的内容</li> <li><code>Dgg</code>: 删除当前行至文件头的内容</li> <li><code>d+enter</code>: 删除2行【包括光标一行】</li> <li><code>cw</code>: 删除当前字，并进入输入模式【很好用，快速更改一个单词】相当于dw+i</li> <li><code>ncw</code>: 删除当前字及其后的n-1个字，并进入输入模式\修改指定数目的字</li> <li><code>cc</code>: 删除当前行，并进入输入模式</li> <li><code>ncc</code>: 删除当前行及其后的n-1行，并进入输入模式</li> <li><code>guw</code>: 光标下的单词变为小写</li> <li><code>gUw</code>: 光标下的单词变为大写</li> <li><code>xp</code>: 左右交换光标处两字符的位置</li> <li><code>ga</code>: 显示光标下的字符在当前使用的encoding下的内码</li> <li><code>nyl</code>: 复制n个字符(也可nyh)</li> <li><code>yw</code>: 复制一个单词</li> <li><code>y0</code>: 表示拷贝从当前光标到光标所在行首的内容</li> <li><code>y$</code>: 复制从当前位置到行尾</li> <li><code>yfa</code>: 表示拷贝从当前光标到光标后面的第一个a字符之间的内容</li> <li><code>yG</code>: 复制从所在行到最后一行</li> <li><code>nyy</code>: 将光标所在位置开始的n行数据复制暂存, 复制一整行</li> <li><code>CTRL+v 方向y</code>: 列选择模式，复制选择的很多行：先使用V进入visual模式，然后j向下移动到你想复制的行为止，然后y</li> <li><code>p</code>: 复制暂存数据在光标的下一行</li> <li><code>P</code>: 复制暂存数据在光标的上一行</li> <li><code>:n1,n2 co n3</code>: 将n1行到n2行之间的内容拷贝到第n3+1行【n3行的下一行】</li> <li><code>:n1,n2 m n3</code>: 将n1行到n2行之间的内容移至到第n3行下</li> <li><code>J</code>: 把下一行的数据连接到本行之后, 多一空格</li> <li><code>~</code>: 改变当前光标下字符的大小写</li> </ul> <p>其他</p> <ul> <li><code>.</code>: 重复前一指令</li> <li><code>u</code>: 取消前一指令undo, :u也行，一般不用，操作太多</li> <li><code>Ctrl + r</code>: 恢复【只对u有效】redo</li> <li><code>Ctrl + l</code>: 刷新屏幕显示</li> <li><code>Ctrl+v 然后 ctrl+A是^A Ctrl+I是\t</code>: 输入特殊字符</li> <li><code>Ctrl+v然后用j、k、l、h或方向键上下选中多列，之后 I I a A r x等，最后按esc，生效</code>: Vim列操作</li> </ul> <p><img alt="VIM Cheet Sheet" src=../assets/vim_cheet_sheet.jpg></p> <h2 id=_3>文本处理工具<a class=headerlink href=#_3 title="Permanent link"> ¶</a></h2> <h3 id=cat>显示文本内容<code>cat</code><a class=headerlink href=#cat title="Permanent link"> ¶</a></h3> <p>命令<code>cat</code>主要参数说明：</p> <ul> <li><code>-E</code>：显示行结束符<code>$</code></li> <li><code>-A</code>：显示所有控制符</li> <li><code>-n</code>：对显示出的每一行进行编号</li> <li><code>-b</code>：非空行编号</li> <li><code>-s</code>：压缩连续的空行成一行</li> </ul> <p>举例：</p> <div class=highlight><pre><span></span><code>cat -nA user-list.txt
     1  user0$
     2  user1$
     3  user2$
     4  user3$
     5  user4$
     6  user5$
     7  user6$
     8  user7$
     9  user8$
    10  user9$
</code></pre></div> <h3 id=nl>显示文本行号<code>nl</code><a class=headerlink href=#nl title="Permanent link"> ¶</a></h3> <p>相当于命令<code>cat -b</code>。</p> <p>命令<code>nl</code>主要参数说明：</p> <ul> <li><code>-b</code> ：指定行号指定的方式，主要有两种：</li> <li><code>-b a</code> ：表示不论是否为空行，也同样列出行号（类似 cat -n）；</li> <li><code>-b t</code> ：如果有空行，空的那一行不要列出行号（默认值）；</li> <li><code>-n</code> ：列出行号表示的方法，主要有三种：</li> <li><code>-n ln</code> ：行号在屏幕的最左方显示；没有前导0；</li> <li><code>-n rn</code> ：行号在自己栏位的最右方显示，没有前导0；</li> <li><code>-n rz</code> ：行号在自己栏位的最右方显示，有前导0；</li> <li><code>-w</code> ：行号栏位的占用的位数。</li> <li><code>-p</code> ：在逻辑定界符处不重新开始计</li> </ul> <p>举例：</p> <div class=highlight><pre><span></span><code>$ nl -b a -n rz user-list.txt
000001  user0
000002  user1
000003  user2
000004  user3
000005  user4
000006  user5
000007  user6
000008  user7
000009  user8
000010  user9
</code></pre></div> <h3 id=tac>逆向显示文本内容<code>tac</code><a class=headerlink href=#tac title="Permanent link"> ¶</a></h3> <p>命令<code>tac</code>逆向显示文本内容。</p> <p>举例：</p> <div class=highlight><pre><span></span><code>$ tac user-list.txt
user9
user8
user7
user6
user5
user4
user3
user2
user1
user0
</code></pre></div> <p>举例：</p> <div class=highlight><pre><span></span><code>$ seq 10 | tac
10
9
8
7
6
5
4
3
2
1
</code></pre></div> <h3 id=rev>逆向显示同行内容<code>rev</code><a class=headerlink href=#rev title="Permanent link"> ¶</a></h3> <p>命令<code>rev</code>逆向显示同一行的内容。</p> <p>举例：</p> <div class=highlight><pre><span></span><code>$ rev user-list.txt
0resu
1resu
2resu
3resu
4resu
5resu
6resu
7resu
8resu
9resu
</code></pre></div> <p>举例：</p> <div class=highlight><pre><span></span><code>$ echo {1..10} | rev
01 9 8 7 6 5 4 3 2 1
</code></pre></div> <h3 id=hexdump>显示非文本文件内容<code>hexdump</code><a class=headerlink href=#hexdump title="Permanent link"> ¶</a></h3> <p>命令<code>hexdump</code>命令一般用来查看“二进制”文件的十六进制编码</p> <p>举例：</p> <div class=highlight><pre><span></span><code>$ hexdump -C -n 32 cp
00000000  7f 45 4c 46 02 01 01 00  00 00 00 00 00 00 00 00  |.ELF............|
00000010  03 00 3e 00 01 00 00 00  e0 48 00 00 00 00 00 00  |..&gt;......H......|
00000020
</code></pre></div> <h3 id=_4>分页查看文件内容<a class=headerlink href=#_4 title="Permanent link"> ¶</a></h3> <p>命令<code>more</code>和<code>less</code>可以实现分页查看文件内容。</p> <p>命令<code>less</code>配合管道符使用。</p> <div class=highlight><pre><span></span><code>$ tree -d /etc | less
</code></pre></div> <h3 id=head>显示文件头部内容<code>head</code><a class=headerlink href=#head title="Permanent link"> ¶</a></h3> <p>命令<code>head</code>显示文件头部内容。</p> <ul> <li><code>head -c 20 cp</code>: 显示文件前20字节内容</li> <li><code>head -n 20 zdiff</code>: 显示文件前20行内容</li> <li><code>head -20 zdiff</code>: 显示文件前20行内容</li> </ul> <div class=highlight><pre><span></span><code>$ echo &quot;我是谁&quot; | head -c3
我

$ echo &quot;我是谁&quot; | head -c6
我是
</code></pre></div> <div class=highlight><pre><span></span><code>$ cat /dev/urandom | tr -dc &#39;[:alnum]&#39; | head -c 10 | tee passwd.txt
</code></pre></div> <div class=highlight><pre><span></span><code>$ cat user-list.txt
user0
user1
user2
user3
user4
user5
user6
user7
user8
user9

$ head -n -3 user-list.txt
user0
user1
user2
user3
user4
user5
user6
</code></pre></div> <h3 id=tail>显示文件尾部内容<code>tail</code><a class=headerlink href=#tail title="Permanent link"> ¶</a></h3> <p>命令<code>tail</code>显示文件头部内容。</p> <ul> <li><code>tail -c 200 cp</code>: 显示文件尾部200个字节的内容</li> <li><code>tail -n 3 user-list.txt</code>: 显示文件最后3行</li> <li><code>tail -n -3 user-list.txt</code>: 显示从-3行到文件结束（即最后三行）</li> <li><code>tail -3 user-list.txt</code>: 显示文件最后3行</li> <li><code>tail -f /var/log/messages</code>: 跟踪显示文件redo.log文件内容，当文件删除，再建同名文件，无法继续追踪</li> <li><code>tail -F /var/log/messages</code>: 跟踪显示文件redo.log文件内容，当文件删除，再建同名文件，继续追踪</li> </ul> <h3 id=cut>按列抽取文本<code>cut</code><a class=headerlink href=#cut title="Permanent link"> ¶</a></h3> <p>命令<code>cut</code>可以提取文本文件或者stdin数据的指定列内容。</p> <p>选项：</p> <ul> <li><code>-f</code> : 通过指定哪一个字段进行提取。cut命令使用“TAB”作为默认的字段分隔符</li> <li><code>-d</code> : “TAB”是默认的分隔符，使用此选项可以更改为其他的分隔符</li> <li><code>--complement</code> : 此选项用于排除所指定的字段</li> <li><code>--output-delimiter=STRING</code> : 指定输出内容的分隔符</li> <li><code>-c</code>: 按字符切割</li> </ul> <p>取/etc/passwd文件第1列内容，以<code>:</code>为分隔符（只取前三行）</p> <div class=highlight><pre><span></span><code>$ cut -d &#39;:&#39; -f 1 /etc/passwd | head -3
root
messagebus
systemd-network
</code></pre></div> <p>取/etc/passwd文件第1和6列内容，以<code>:</code>为分隔符（只取前三行）</p> <div class=highlight><pre><span></span><code>cut -d &#39;:&#39; -f 1,6 /etc/passwd | head -3
root:/root
messagebus:/run/dbus
systemd-network:/
</code></pre></div> <p>取/etc/passwd文件第1到3列以及第6列内容，以<code>:</code>为分隔符（只取前三行）</p> <div class=highlight><pre><span></span><code>$ cut -d &#39;:&#39; -f 1-3,6 /etc/passwd | head -3
root:x:0:/root
messagebus:x:499:/run/dbus
systemd-network:x:497:/
</code></pre></div> <p>下面使用<code>--output-delimiter</code>选项，把输出结果中的分隔符<code>:</code>全部替换成<code>---</code>。</p> <div class=highlight><pre><span></span><code>$ cat /etc/passwd | sort | head -3
admin3:x:1020:100::/home/admin3:/bin/bash
at:x:25:25:Batch jobs daemon:/var/spool/atjobs:/usr/sbin/nologin
bin:x:1:1:bin:/bin:/usr/sbin/nologin

$ cut -d &quot;:&quot; -f 1,7 /etc/passwd | sort | head -3
admin3:/bin/bash
at:/usr/sbin/nologin
bin:/usr/sbin/nologin

$ cut -d &quot;:&quot; -f 1,7 --output-delimiter=&quot;---&quot; /etc/passwd | sort | head -3
admin3---/bin/bash
at---/usr/sbin/nologin
bin---/usr/sbin/nologin
</code></pre></div> <p><code>--output-delimiter</code>选项也可以利用来进行计算。</p> <div class=highlight><pre><span></span><code>$ echo {1..10} | cut -d &quot; &quot; -f 1-10 --output-delimiter=&quot;+&quot; | bc
55
</code></pre></div> <p>从<code>ifconfig</code>命令中截取当前主机的ip地址。（openSUSE需要安装包<code>net-tools-deprecated</code>）</p> <div class=highlight><pre><span></span><code>$ ifconfig | head -2 | tail -1
        inet 192.168.10.210  netmask 255.255.255.0  broadcast 192.168.10.255

$ ifconfig | head -2 | tail -1 | cut -d &quot; &quot; -f 10
192.168.10.210
</code></pre></div> <p>或者</p> <div class=highlight><pre><span></span><code>$ ip addr list | grep eth0 | tail -1 | cut -d &quot; &quot; -f 6
192.168.10.210/24
</code></pre></div> <p>基于上面结果，可以尝试通过<code>--complement</code>参数，以<code>/</code>为分隔符，排除第二列<code>24</code>，只输出第一列IP地址。</p> <div class=highlight><pre><span></span><code>ip addr list | grep eth0 | tail -1 | cut -d &quot; &quot; -f 6 | cut -d &quot;/&quot; --complement -f 2
192.168.10.210
</code></pre></div> <p>显示<code>df</code>命令输出中的分区使用率。</p> <div class=highlight><pre><span></span><code>$ df | tr -s &#39; &#39; | cut -d &#39; &#39; -f 5 | tr -d %
Use
0
0
2
0
8
8
8
8
8
8
8
8
8
8
8
0
</code></pre></div> <p>方法2：先把空格全部替换成%，再去重。</p> <div class=highlight><pre><span></span><code>df | tr -s &#39; &#39; % | cut -d % -f 5
Use
0
0
2
0
8
8
8
8
8
8
8
8
8
8
8
0
</code></pre></div> <h3 id=paste>合并多个文件<code>paste</code><a class=headerlink href=#paste title="Permanent link"> ¶</a></h3> <p>命令<code>paste</code>常用选项：</p> <ul> <li><code>-d</code>：指定分隔符，默认是TAB</li> <li><code>-s</code>：所有行合成一行显示</li> </ul> <p>生成<code>alpha.log</code>和<code>seq.log</code>。</p> <div class=highlight><pre><span></span><code>$ for i in {a..z}; do echo $i &gt;&gt; alpha.log; done

$ seq 10 &gt; seq.log
</code></pre></div> <p>用<code>paste</code>命令合并这2个文件。</p> <div class=highlight><pre><span></span><code>$ paste alpha.log seq.log
a       1
b       2
c       3
d       4
e       5
f       6
g       7
h       8
i       9
j       10
k
l
m
n
o
p
q
r
s
t
u
v
w
x
y
z

$ paste -d &quot;:&quot; alpha.log seq.log
a:1
b:2
c:3
d:4
e:5
f:6
g:7
h:8
i:9
j:10
k:
l:
m:
n:
o:
p:
q:
r:
s:
t:
u:
v:
w:
x:
y:
z:
</code></pre></div> <p>原文件都是列输出，改成行输出。</p> <div class=highlight><pre><span></span><code>$ paste -d <span class=s2>&quot;-&quot;</span> -s alpha.log
a-b-c-d-e-f-g-h-i-j-k-l-m-n-o-p-q-r-s-t-u-v-w-x-y-z

$ paste -d <span class=s2>&quot;-&quot;</span> -s seq.log

$ paste -d <span class=s2>&quot;:&quot;</span> -s alpha.log seq.log
a:b:c:d:e:f:g:h:i:j:k:l:m:n:o:p:q:r:s:t:u:v:w:x:y:z
<span class=m>1</span>:2:3:4:5:6:7:8:9:10

$ paste -d <span class=s2>&quot;:&quot;</span> -s seq.log alpha.log
<span class=m>1</span>:2:3:4:5:6:7:8:9:10
a:b:c:d:e:f:g:h:i:j:k:l:m:n:o:p:q:r:s:t:u:v:w:x:y:z
</code></pre></div> <h3 id=wc>文本统计数据<code>wc</code><a class=headerlink href=#wc title="Permanent link"> ¶</a></h3> <p>常用选项：</p> <ul> <li><code>-l</code>：只计数行数</li> <li><code>-w</code>：只计数单词总数</li> <li><code>-c</code>：只计数字节总数</li> <li><code>-m</code>：只计数字符总数</li> <li><code>-L</code>：显示文件中最长行的长度</li> </ul> <div class=highlight><pre><span></span><code>$ cat text
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou

$ wc text  # 行数 单词数 字节数
 3  9 57 text

$ wc -l text
3 text

$ wc -w text
9 text

$ wc -c text
57 text

$ wc -m text
57 text

$ wc -L text
20 text
</code></pre></div> <p>对比两种不同合并的方法。</p> <div class=highlight><pre><span></span><code>$ cat text1 text2
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou
Tom, 20, Shanghai
Jack, 30, Beijing
Leo, 40, Guangzhou

$ paste text1 text2
Tom, 20, Shanghai       Tom, 20, Shanghai
Jack, 30, Beijing       Jack, 30, Beijing
Smith, 40, Guangzhou    Leo, 40, Guangzhou
</code></pre></div> <h3 id=sort>文本排序<code>sort</code><a class=headerlink href=#sort title="Permanent link"> ¶</a></h3> <p>命令<code>sort</code>把整理过的文本显示在stdout上，不改变原文件。</p> <p>常用选项：</p> <ul> <li> <p><code>-r</code>：执行反方向（从上至下）排序</p> </li> <li> <p><code>-R</code>：随机排序</p> </li> <li> <p><code>-n</code>：按数字大小排序</p> </li> <li> <p><code>-h</code>：人类可读排序，如：2K，1G</p> </li> <li> <p><code>-f</code>：排序时将小写字母视为大写字母</p> </li> <li> <p><code>-u</code>：排序时合并重复项</p> </li> <li> <p><code>-t c</code>：使用c作为字段分隔符</p> </li> <li> <p><code>-k #</code>：按照以c为分隔符的第#列来排序</p> </li> </ul> <p>举例：以<code>,</code>为分隔符，读取<code>text</code>文件内容中第1，3列，对输出结果以<code>,</code>为分隔符，按第二列排序（正序和反序）。</p> <div class=highlight><pre><span></span><code>$ cat text
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou

$ cut -d &quot;,&quot; -f 1,3 text | sort -t &quot;,&quot; -k 1
Jack, Beijing
Smith, Guangzhou
Tom, Shanghai

$ cut -d &quot;,&quot; -f 1,3 text | sort -t &quot;,&quot; -k 1 -r
Tom, Shanghai
Smith, Guangzhou
Jack, Beijing
</code></pre></div> <p>把文件text1和文件text2合并后去重输出。</p> <div class=highlight><pre><span></span><code>$ cat text2
Tom, 20, Shanghai
Jack, 30, Beijing
Leo, 40, Guangzhou

$ cat text1
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou

$ cat text1 text2
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou
Tom, 20, Shanghai
Jack, 30, Beijing
Leo, 40, Guangzhou
</code></pre></div> <p>并集，重复行只保留一行。前面2个命令是同样含义（相同的排序列），第三个命令中对不同列进行了排序，导致去重结果不同。</p> <div class=highlight><pre><span></span><code>$ cat text1 text2 | sort -u
Jack, 30, Beijing
Leo, 40, Guangzhou
Smith, 40, Guangzhou
Tom, 20, Shanghai

$ cat text1 text2 | sort -t &quot;,&quot; -k 1 -u
Jack, 30, Beijing
Leo, 40, Guangzhou
Smith, 40, Guangzhou
Tom, 20, Shanghai

$ cat text1 text2 | sort -t &quot;,&quot; -k 2 -u
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou
</code></pre></div> <h3 id=uniq>去重<code>uniq</code><a class=headerlink href=#uniq title="Permanent link"> ¶</a></h3> <p>命令<code>uniq</code>从输入中删除前后相邻重复的行。经常与<code>sort</code>命令结合使用。</p> <p>主要参数：</p> <ul> <li> <p><code>-c</code>：显示每行重复出现的次数</p> </li> <li> <p><code>-d</code>：仅显示重复的行</p> </li> <li> <p><code>-u</code>：仅显示不重复的行</p> </li> </ul> <p>举例，注意只有对相邻行进行去重。</p> <div class=highlight><pre><span></span><code>$ cat text3
test 30
Hello 95
Hello 95
Linux 85
Linux 85
Hello 95
test 30

$ uniq text3
test 30
Hello 95
Linux 85
Hello 95
test 30
</code></pre></div> <p>把文件text1和文件text2合并后，进行交集和并集，并去重。</p> <div class=highlight><pre><span></span><code>$ cat text1
Tom, 20, Shanghai
Jack, 30, Beijing
Smith, 40, Guangzhou

$ cat text2
Tom, 20, Shanghai
Jack, 30, Beijing
Leo, 40, Guangzhou

# 并集，按首列排序去重
$ cat text1 text2 | sort | uniq
Jack, 30, Beijing
Leo, 40, Guangzhou
Smith, 40, Guangzhou
Tom, 20, Shanghai

# 交集
$ cat text1 text2 | sort | uniq -d
Jack, 30, Beijing
Tom, 20, Shanghai

# 差集
$ cat text1 text2 | sort | uniq -u
Leo, 40, Guangzhou
Smith, 40, Guangzhou
</code></pre></div> <p>查看并发连接数最多的远程主机IP。</p> <div class=highlight><pre><span></span><code>$ ss -nt
State         Recv-Q         Send-Q                    Local Address:Port                      Peer Address:Port          Process
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:41650
ESTAB         0              0                        192.168.10.210:22                      192.168.10.201:65330
ESTAB         0              64                       192.168.10.210:22                      192.168.10.201:63289
ESTAB         0              0                        192.168.10.210:41650                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:47992                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:60268                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:22                      192.168.10.201:65327
ESTAB         0              0                        192.168.10.210:35758                   192.168.10.220:22
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:56818
ESTAB         0              0                        192.168.10.210:56818                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:48006                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:60268
ESTAB         0              0                        192.168.10.210:22                      192.168.10.220:33896
ESTAB         0              0                        192.168.10.210:22                      192.168.10.201:65324
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:47992
ESTAB         0              0                        192.168.10.210:59554                   192.168.10.210:22
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:59554
ESTAB         0              0                        192.168.10.210:22                      192.168.10.210:48006

$ ss -nt | tr -s &quot; &quot; &quot;:&quot; | cut -d &quot;:&quot; -f 6,7 | sort | uniq -c | sort -nr | head -n 1
      6 192.168.10.210:22
</code></pre></div> <h3 id=_5>文本比较<a class=headerlink href=#_5 title="Permanent link"> ¶</a></h3> <h4 id=diff><code>diff</code><a class=headerlink href=#diff title="Permanent link"> ¶</a></h4> <p>命令<code>diff</code>比较两个文件之间的区别。</p> <p>常用选项：</p> <ul> <li><code>-u</code>：以统一的方式来显示文件内容的不同</li> <li><code>-y</code>：以并列的方式显示文件的异同之处</li> <li><code>-W</code>：在使用-y参数时，指定栏宽</li> <li><code>-c</code>：显示全部内文，并标出不同之处</li> <li><code>-N</code>：缺失文件以空文件处理</li> </ul> <p>举例：</p> <div class=highlight><pre><span></span><code>$ cat text5 # 文件尾部没有空行
1001
1002
1003

$ cat text6 # 文件尾部没有空行
1001
1002
1003a
1004
</code></pre></div> <p>显示不同。<code>3c3,4</code>代表两个文件在第3，4行有不同。</p> <div class=highlight><pre><span></span><code>$ diff text5 text6
3c3,4
&lt; 1003
---
&gt; 1003a
&gt; 1004
</code></pre></div> <p>以统一格式输出比较结果。</p> <ul> <li>前2行是文件信息。其中<code>---</code>表示变动前的文件，<code>+++</code>表示变动后的文件。</li> <li>变动的位置用两个@作为起首和结束，<code>@@ -1,3 +1,4 @@</code>。</li> <li><code>-1,3</code>中，<code>-</code>表示第一个文件，即<code>text5</code>。第一个文件从第1行开始连续3行。</li> <li><code>+1,4</code>中，<code>+</code>表示第二个文件，即<code>text6</code>。即，第二个文件从第1行开始连续4行。</li> </ul> <div class=highlight><pre><span></span><code>$ diff -u text5 text6
--- text5    2022-12-07 08:07:05.927805722 +0800
+++ text6    2022-12-07 08:07:24.692234585 +0800
@@ -1,3 +1,4 @@
 1001
 1002
-1003
+1003a
+1004
</code></pre></div> <p>以上下文方式输出比较结果。标有<code>!</code>代表差异行。</p> <div class=highlight><pre><span></span><code>$ diff -c text5 text6
*** text5    2022-12-07 08:24:08.867168414 +0800
--- text6    2022-12-07 08:24:13.939284243 +0800
***************
*** 1,3 ****
  1001
  1002
! 1003
--- 1,4 ----
  1001
  1002
! 1003a
! 1004
</code></pre></div> <p>并排格式输出比较结果。</p> <ul> <li> <p><code>|</code>表示前后2个文件内容有不同</p> </li> <li> <p><code>&lt;</code>表示后面文件比前面文件少了1行内容</p> </li> <li> <p><code>&gt;</code>表示后面文件比前面文件多了1行内容</p> </li> </ul> <div class=highlight><pre><span></span><code>$ diff -y -W 50 text5 text6
1001        1001
1002        1002
1003      | 1003a
        &gt; 1004
</code></pre></div> <p>比较文件夹内容。注意，只比较内容，不比较时间戳。</p> <div class=highlight><pre><span></span><code>$ mkdir dir1
$ mkdir dir2

$ cd dir1
$ touch file1
$ touch file2
$ cp file1 file2 ../dir2/
$ echo &quot;hello&quot; &gt; file3

$ cd ../dir2
$ touch file3
$ touch file4

$ diff dir1 dir2
1d0
&lt; hello
Only in dir2: file4
</code></pre></div> <h4 id=patch><code>patch</code><a class=headerlink href=#patch title="Permanent link"> ¶</a></h4> <p>命令<code>patch</code>复制其他文件中的内容。命令格式：</p> <div class=highlight><pre><span></span><code>$ patch -p[num] &lt; patchfile
$ patch [options] originalfile patchfile 
</code></pre></div> <p>当特定软件有可用的安全修复程序时，我们通常会使用 <code>yum</code>或 <code>apt-get</code> 或<code>zypper</code>等包管理工具进行二进制升级。 </p> <p>但如果我们是通过从源代码编译安装软件的情况下，我们需要下载安全补丁并将其应用于原始源代码并重新编译软件。 </p> <p>这就是我们使用 <code>diff</code> 创建补丁文件（patch file），并使用 <code>patch</code>命令应用它。 </p> <p>补丁文件是一个文本文件，其中包含同一文件（或同一源代码树）的两个版本之间的差异。 补丁文件是使用 <code>diff</code>命令创建的。</p> <p>继续上例。</p> <p>将文件<code>text5</code>的内容同步到文件<code>text6</code>，然后撤销补丁。注意区分源文件和目标文件。</p> <div class=highlight><pre><span></span><code>$ cat text5
1001
1002
1003

$ cat text6
1001
1002
1003a
1004

# 生成补丁文件
$ diff -ruN text5 text6 &gt; patchfile

$ cat patchfile
--- text5    2022-12-07 08:24:08.867168414 +0800
+++ text6    2022-12-07 08:24:13.939284243 +0800
@@ -1,3 +1,4 @@
 1001
 1002
-1003
+1003a
+1004

# 不指明目标文件，则默认给diff命令中的源文件进行打补丁
$ patch &lt; patchfile
patching file text5

$ cat text5
1001
1002
1003a
1004

$ cat text6
1001
1002
1003a
1004

# 撤销补丁
patch -R &lt; patchfile
patching file text5

# cat text5
1001
1002
1003

# 给text6文件打补丁（用text5的文件内容覆盖text6的内容）
$ patch text6 patchfile
patching file text6
Reversed (or previously applied) patch detected!  Assume -R? [n] y

$ cat text6
1001
1002
1003

# 撤销给text6文件打的补丁（恢复text6文件补丁前的内容）
$ patch -R text6 patchfile
patching file text6
Unreversed patch detected!  Ignore -R? [n] y

$ cat text6
1001
1002
1003a
1004
</code></pre></div> <p>使用<code>-b</code>参数，在patch前先备份源文件。</p> <div class=highlight><pre><span></span><code>$ patch -b &lt; patchfile
patching file text5

$ cat text5
1001
1002
1003a
1004

$ cat text5.orig
1001
1002
1003

$ cat text6.orig
1001
1002
1003

$ patch -R &lt; patchfile
patching file text5
</code></pre></div> <p>在-b参数中加入-V参数，指定备份文件名的格式，如下，会得到文件<code>text5.~1~</code>。</p> <div class=highlight><pre><span></span><code>$patch -b -V numbered &lt; patchfile
patching file text5

$ cat text5
1001
1002
1003a
1004

$ cat text5.~1~
1001
1002
1003
</code></pre></div> <p>试运行，不做实际更改。</p> <div class=highlight><pre><span></span><code>patch --dry-run &lt; patchfile
</code></pre></div> <p>对目录打补丁。</p> <ul> <li>执行<code>diff</code>和<code>patch</code>命令是在当前用户<code>vagrant</code>的主目录下，绝对路径是<code>/home/vagrant</code>。</li> <li><code>diff</code>命令中，源目录是<code>/home/vagrant/dir1</code>。目标目录是<code>/home/vagrant/dir2</code>。</li> <li><code>-p3</code>是告诉<code>patch</code>命令忽略上面绝对路径中前三个斜杠<code>/</code>。</li> <li><code>patch</code>命令中用<code>diff</code>的目标目录去覆盖源目录。互换会报错。</li> <li><code>-R</code>：撤销补丁。</li> </ul> <div class=highlight><pre><span></span><code># file3和file4有内容
$ tree ./dir1
./dir1
├── file1
├── file2
├── file3
└── subdir1
  └── file4


都是空文件

$ tree ./dir2
./dir2
├── file1
├── file2
├── file3
└── subdir1
 └── file4

$ diff -ruN /home/vagrant/dir1 /home/vagrant/dir2 &gt; patchdir

$ cat patchdir
diff -ruN /home/vagrant/dir1/file3 /home/vagrant/dir2/file3
--- /home/vagrant/dir1/file3 2022-12-07 08:42:33.108418336 +0800
+++ /home/vagrant/dir2/file3 2022-12-07 21:25:48.156056360 +0800
@@ -1 +0,0 @@
-hello
diff -ruN /home/vagrant/dir1/subdir1/file4 /home/vagrant/dir2/subdir1/file4
--- /home/vagrant/dir1/subdir1/file4 2022-12-07 21:15:09.689912160 +0800
+++ /home/vagrant/dir2/subdir1/file4 2022-12-07 21:26:55.405546177 +0800
@@ -1 +0,0 @@
-/home/vagrant/dir1/subdir1

# 用dir2的内容覆盖dir1的内容

$ patch -p3 &lt; patchdir
patching file dir1/file3
patching file dir1/subdir1/file4

# 现在dir1目录下的内容已经被dir2目录覆盖了。file3和file4都是空文件

$ ll ./dir1
total 0
-rw-r--r--. 1 vagrant wheel 0 Dec 7 08:34 file1
-rw-r--r--. 1 vagrant wheel 0 Dec 7 08:35 file2
-rw-r--r--. 1 vagrant wheel 0 Dec 7 21:40 file3
drwxr-xr-x. 1 vagrant wheel 10 Dec 7 21:40 subdir1

$ ll ./dir1/subdir1
total 0
-rw-r--r--. 1 vagrant wheel 0 Dec 7 21:40 file4

# 撤销补丁，file3和file4已经恢复为原文件

$ patch -R -p3 &lt; patchdir
patching file dir1/file3
patching file dir1/subdir1/file4

$ ll ./dir1
-rw-r--r--. 1 vagrant wheel 0 Dec 7 08:34 file1
-rw-r--r--. 1 vagrant wheel 0 Dec 7 08:35 file2
-rw-r--r--. 1 vagrant wheel 6 Dec 7 21:45 file3
drwxr-xr-x. 1 vagrant wheel 10 Dec 7 21:45 subdir1

$ ll ./dir1/subdir1
-rw-r--r--. 1 vagrant wheel 27 Dec 7 21:45 file4

# 用dir1的内容覆盖dir2的内容，系统拒绝。

patch dir2 -p3 &lt; patchdir
File dir2 is not a regular file -- refusing to patch
1 out of 1 hunk ignored -- saving rejects to file dir2.rej
File dir2 is not a regular file -- refusing to patch
1 out of 1 hunk ignored -- saving rejects to file dir2.rej

$ patch /home/vagrant/dir2 -p3 &lt; patchdir
File /home/vagrant/dir2 is not a regular file -- refusing to patch
1 out of 1 hunk ignored -- saving rejects to file /home/vagrant/dir2.rej
File /home/vagrant/dir2 is not a regular file -- refusing to patch
1 out of 1 hunk ignored -- saving rejects to file /home/vagrant/dir2.rej
</code></pre></div> <h4 id=vimdiff><code>vimdiff</code><a class=headerlink href=#vimdiff title="Permanent link"> ¶</a></h4> <p>命令<code>vimdiff</code>相当于<code>vim -d</code>。</p> <p>举例：</p> <div class=highlight><pre><span></span><code>$ vimdiff text1 text2
</code></pre></div> <h4 id=cmp><code>cmp</code><a class=headerlink href=#cmp title="Permanent link"> ¶</a></h4> <p>命令<code>cmp</code>查看二进制文件的不同。</p> <div class=highlight><pre><span></span><code>$ cmp cp grep
cp grep differ: byte 25, line 1

$ cmp /usr/bin/ls /usr/bin/dir
/usr/bin/ls /usr/bin/dir differ: byte 613, line 1

# 跳过前735个字节，输出后面30个字节内容

$ hexdump -s 735 -Cn 30 /usr/bin/ls
000002df 00 00 00 00 00 5d 00 00 00 50 00 00 00 68 00 00 |.....]...P...h..|
000002ef 00 6a 00 00 00 4f 00 00 00 00 00 00 00 1d |.j...O........|
000002fd $ hexdump -s 735 -Cn 30 /usr/bin/dir
000002df 00 00 00 00 00 5d 00 00 00 50 00 00 00 68 00 00 |.....]...P...h..|
000002ef 00 6a 00 00 00 4f 00 00 00 00 00 00 00 1d |.j...O........|
000002fd
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../03-identity-security/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Identity & Security" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Identity & Security </div> </div> </a> <a href=../05-RegExpress/ class="md-footer__link md-footer__link--next" aria-label="Next: Regular Expression" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Regular Expression </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>