<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/linux/SRE/02-filesystem/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>File System - UPSkilling</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#_1 class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=UPSkilling class="md-header__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> UPSkilling </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> File System </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> UPSkilling </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Linux </a> </li> <li class=md-tabs__item> <a href=../../../k8s/ class=md-tabs__link> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../python/ class=md-tabs__link> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=UPSkilling class="md-nav__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> UPSkilling </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> UPSkilling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=UPSkilling data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> UPSkilling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2 checked> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../01-fundamentals/ class=md-nav__link> Linux Fundamentals </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> File System <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> File System </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 主要目录 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 文件操作命令 </a> <nav class=md-nav aria-label=文件操作命令> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 显示当前工作目录 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 相对和绝对路径 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 更改目录 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 列出目录内容 </a> </li> <li class=md-nav__item> <a href=#stat class=md-nav__link> 文件状态stat </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 确定文件类型 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 文件编码转换 </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 通配符 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 字符集 </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> 特殊符号 </a> </li> <li class=md-nav__item> <a href=#touch class=md-nav__link> 刷新文件时间touch </a> </li> <li class=md-nav__item> <a href=#cp class=md-nav__link> 复制文件和目录cp </a> </li> <li class=md-nav__item> <a href=#mv class=md-nav__link> 移动文件和目录mv </a> </li> <li class=md-nav__item> <a href=#rename class=md-nav__link> 重命名文件和目录rename </a> </li> <li class=md-nav__item> <a href=#rm class=md-nav__link> 删除文件rm </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> 目录操作命令 </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> 练习 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> 七种文件类型 </a> <nav class=md-nav aria-label=七种文件类型> <ul class=md-nav__list> <li class=md-nav__item> <a href=#inode class=md-nav__link> inode结构 </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> 链接类型 </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> 设备文件 </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> 练习 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> 文件属性说明 </a> </li> <li class=md-nav__item> <a href=#_20 class=md-nav__link> 标准输入输出 </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> 重定向和管道 </a> <nav class=md-nav aria-label=重定向和管道> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_22 class=md-nav__link> 输入重定向 </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> 输出重定向 </a> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> 特殊重定向 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_25 class=md-nav__link> 管道 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../03-identity-security/ class=md-nav__link> Identity & Security </a> </li> <li class=md-nav__item> <a href=../04-TextTools/ class=md-nav__link> Text Tools </a> </li> <li class=md-nav__item> <a href=../05-RegExpress/ class=md-nav__link> Regular Expression </a> </li> <li class=md-nav__item> <a href=../06-FileLookup/ class=md-nav__link> File Lookup </a> </li> <li class=md-nav__item> <a href=../07-FilePacking/ class=md-nav__link> FIle Packing & Unpacking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Case Study <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Case Study" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Case Study </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10> <label class=md-nav__link for=__nav_3_10> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/demo/cap_on_kyma/ class=md-nav__link> Build CAP application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Foundation/ch00/ class=md-nav__link> 安装 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch01/ class=md-nav__link> 语言基础 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch02/ class=md-nav__link> 打包和拆包 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch03/ class=md-nav__link> 函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch04/ class=md-nav__link> 面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch05/ class=md-nav__link> 面向对象特性 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/Algorithms/ class=md-nav__link> 数据结构和算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 主要目录 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 文件操作命令 </a> <nav class=md-nav aria-label=文件操作命令> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 显示当前工作目录 </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 相对和绝对路径 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 更改目录 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 列出目录内容 </a> </li> <li class=md-nav__item> <a href=#stat class=md-nav__link> 文件状态stat </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 确定文件类型 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 文件编码转换 </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 通配符 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 字符集 </a> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> 特殊符号 </a> </li> <li class=md-nav__item> <a href=#touch class=md-nav__link> 刷新文件时间touch </a> </li> <li class=md-nav__item> <a href=#cp class=md-nav__link> 复制文件和目录cp </a> </li> <li class=md-nav__item> <a href=#mv class=md-nav__link> 移动文件和目录mv </a> </li> <li class=md-nav__item> <a href=#rename class=md-nav__link> 重命名文件和目录rename </a> </li> <li class=md-nav__item> <a href=#rm class=md-nav__link> 删除文件rm </a> </li> <li class=md-nav__item> <a href=#_13 class=md-nav__link> 目录操作命令 </a> </li> <li class=md-nav__item> <a href=#_14 class=md-nav__link> 练习 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_15 class=md-nav__link> 七种文件类型 </a> <nav class=md-nav aria-label=七种文件类型> <ul class=md-nav__list> <li class=md-nav__item> <a href=#inode class=md-nav__link> inode结构 </a> </li> <li class=md-nav__item> <a href=#_16 class=md-nav__link> 链接类型 </a> </li> <li class=md-nav__item> <a href=#_17 class=md-nav__link> 设备文件 </a> </li> <li class=md-nav__item> <a href=#_18 class=md-nav__link> 练习 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_19 class=md-nav__link> 文件属性说明 </a> </li> <li class=md-nav__item> <a href=#_20 class=md-nav__link> 标准输入输出 </a> </li> <li class=md-nav__item> <a href=#_21 class=md-nav__link> 重定向和管道 </a> <nav class=md-nav aria-label=重定向和管道> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_22 class=md-nav__link> 输入重定向 </a> </li> <li class=md-nav__item> <a href=#_23 class=md-nav__link> 输出重定向 </a> </li> <li class=md-nav__item> <a href=#_24 class=md-nav__link> 特殊重定向 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_25 class=md-nav__link> 管道 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/linux/SRE/02-filesystem.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=_1>文件系统<a class=headerlink href=#_1 title="Permanent link"> ¶</a></h1> <p>文件系统层次标准（Filesystem Hierarchy Standard, FHS），它是Linux 标准库（Linux Standards Base, LSB）规范的一部分。</p> <p>根目录<code>/</code>指文件系统树的最高层。 根分区在系统启动时首先挂载。 系统启动时运行的所有程序都必须在此分区中。</p> <h2 id=_2>主要目录<a class=headerlink href=#_2 title="Permanent link"> ¶</a></h2> <p>以下目录必须在根分区中：</p> <ul> <li><code>/bin</code> - 用户基本程序。</li> <li>包含未挂载其他文件系统时所需的可执行文件。 例如，系统启动、处理文件和配置所需的程序。</li> <li>不能关联到独立分区，操作系统启动即会调用的程序。</li> <li><code>/bin/bash</code> - <code>bash</code>脚本处理</li> <li><code>/bin/cat</code> - 显示文件内容</li> <li><code>/bin/cp</code> - 拷贝文件</li> <li><code>/bin/dd</code> - 拷贝文件（基于字节byte）</li> <li><code>/bin/gzip</code> - 压缩文件</li> <li><code>/bin/mount</code> - 挂载文件系统</li> <li><code>/bin/rm</code> - 删除文件</li> <li><code>/bin/vi</code> - 文件编辑</li> <li><code>/sbin</code> - 系统基本程序。</li> <li>包含基本系统管理的程序。</li> <li>默认是root用户有权限执行，因此它不在常规用户路径中。 </li> <li>不能关联到独立分区，操作系统启动即会调用的程序</li> <li>一些重要管理程序：<ul> <li><code>/sbin/fdisk*</code> - 管理硬盘分区</li> <li><code>/sbin/fsck*</code> - 文件系统检查。不能在运行的系统上面直接执行<code>fsck</code>，损坏根文件系统，执行前需要<code>umount</code>。</li> <li><code>/sbin/mkfs</code> - 创建文件系统</li> <li><code>/sbin/shutdown</code> - 关闭系统</li> </ul> </li> <li><code>/dev</code> - 设备文件</li> <li>以太网卡是内核模块，其他硬件都以设备dev的方式展现。</li> <li>应用程序读取和写入这些文件以操作使用硬件组件。</li> <li>两种类型设备文件：<ul> <li>字符设备（Character-oriented）– 序列设备（打印机，磁带机，鼠标等） </li> <li>块设备（Block-oriented）– 硬盘，DVD等 </li> </ul> </li> <li>与设备驱动程序的连接通过内核中称为主设备号的通道实现。</li> <li>过去，这些文件是使用<code>mknod</code>命令手动创建的。 现在当内核发现设备时，它们会由<code>udev</code>自动创建。</li> <li>一些重要的设备文件：<ul> <li>Null设备: - <code>/dev/null</code></li> <li>Zero设备: - <code>/dev/zero</code></li> <li>系统终端: - <code>/dev/console</code></li> <li>虚拟终端: - <code>/dev/tty1</code></li> <li>串行端口 - <code>/dev/ttyS0</code></li> <li>并行端口: - <code>/dev/lp0</code></li> <li>软盘驱动器: - <code>/dev/fd0</code></li> <li>硬盘驱动器: - <code>/dev/sda</code></li> <li>硬盘分区: - <code>/dev/sda1</code></li> <li>CD-ROM驱动器: - <code>/dev/scd0</code></li> </ul> </li> <li><code>/etc</code> - 配置文件</li> <li>存放系统和服务的配置文件。</li> <li>大部分都是ASCII文件</li> <li>普通用户可以默认读取其中的大部分内容。 这会带来一个潜在的全问题，因为其中一些文件包含密码，因此重要的是要确保这些文件只能由root用户读取。</li> <li>根据FHS标准，此处不能放置任何可执行文件，但子目录可能包含shell脚本。</li> <li>几乎每个已安装的服务在<code>/etc</code>或其子目录中至少有一个配置文件。</li> <li>一些重要的配置文件:<ul> <li><code>/etc/os-release</code> - 系统版本信息</li> <li><code>/etc/DIR_COLORS</code> - <code>ls</code>命令中的颜色配置信息（openSUSE和Rocky）</li> <li><code>/etc/fstab</code> - 配置要挂载的文件系统</li> <li><code>/etc/profile</code> - Shell登录脚本</li> <li><code>/etc/passwd</code> - 用户信息集合（不含密码）</li> <li><code>/etc/shadow</code> - 密码和相关信息</li> <li><code>/etc/group</code> - 用户组信息集合</li> <li><code>/etc/cups/*</code> - 用于CUPS打印系统（CUPS=Common UNIX Printing System）</li> <li><code>/etc/hosts</code> - 主机名机器IP地址</li> <li><code>/etc/motd</code> - 登录后显示的欢迎信息</li> <li><code>/etc/issue</code> - 登录前显示的欢迎信息</li> <li><code>/etc/sysconfig/*</code> - 系统配置文件</li> </ul> </li> <li><code>/lib</code> - 库（Libraries）</li> <li>许多程序都具有一些通用功能。 这些通用功能可以保存在共享库中。</li> <li>共享库中文件的扩展名是<code>.so</code>。 </li> <li>目录<code>/lib</code>包含的共享库文件主要是被<code>/bin</code>和<code>/sbin</code>目录包含的程序所调用。 </li> <li>目录<code>/lib</code>的子目录包含一些额外需要的共享库。 </li> <li>内核模块存储在目录<code>/lib/modules</code>。</li> <li><code>/lib64</code> - 64位共享库（64-Bit Libraries），类似目录<code>/lib</code>。 </li> <li>这个目录因系统架构不同而不同。 </li> <li>一些系统支持不同的二进制格式并保留同一个共享库的不同版本。</li> <li><code>/usr</code> - 包含应用程序、图形界面文件、库、本地程序、文档等。</li> <li><code>/usr</code> 即 Unix System Resources. 例如：</li> <li><code>/usr/X11R6/</code> - X Window 系统文件</li> <li><code>/usr/bin/</code> - 几乎包含所有可执行文件</li> <li><code>/usr/lib/</code> - 包含库和应用程序</li> <li><code>/usr/lib64/</code> - 包含64位库和应用程序</li> <li><code>/usr/include/</code> - 包含C程序的头文件（head file）</li> <li><code>/usr/local/</code> - 包含本地安装程序。这个目录下的内容不会被系统升级所覆盖。下面3个目录在初始安装后是空的。<ul> <li><code>/usr/local/bin</code>- </li> <li><code>/usr/local/sbin</code>- </li> <li><code>/usr/local/lib</code>- </li> </ul> </li> <li><code>/usr/sbin/</code> - 系统管理程序</li> <li><code>/usr/src/</code> - 内核和应用程序的源代码<ul> <li><code>/usr/src/linux</code>- </li> </ul> </li> <li><code>/usr/share/</code> - 结构化独立数据<ul> <li><code>/usr/share/doc/</code> - 文档</li> <li><code>/usr/share/man/</code> - <code>man</code>命令使用的内容</li> </ul> </li> <li><code>/opt</code> - 第三方应用程序目录</li> <li>各发行版包含的应用程序一般存储在目录<code>/usr/lib/</code>。</li> <li>各发行版可选程序，或第三方应用程序则存储在目录<code>/opt</code>。</li> <li>在安装时，会为每个应用程序的文件创建一个目录，其中包含应用程序的名称。比如：<ul> <li><code>/opt/novell</code>- </li> </ul> </li> <li><code>/boot</code> - 引导目录</li> <li><code>/boot/grub2</code> - 包含GRUB2的静态引导加载程序文件（GRUB = Grand Unified Boot Loader）。</li> <li>包含以链接 vmlinuz 和 initrd 标识的内核和 initrd 文件。</li> <li><code>/root</code> - 管理员的主目录（home directory）。</li> <li><code>root</code>用户的主目录。其他用户的主目录是在目录<code>/home</code>下。</li> <li><code>root</code>用户的登录环境配置保存至<code>/root</code>分区中。</li> <li><code>/home</code> - 用户主目录</li> <li>每个系统用户都有一个分配的文件区域，该文件区域在登录后成为当前工作目录。 默认情况下，它们存在于<code>/home</code>中。</li> <li><code>/home</code>中的文件和目录可以位于单独的分区中，也可以位于网络上的另一台计算机上。</li> <li>用户配置信息和配置文件（user profile and configuration files）主要有：<ul> <li>.profile - 用户私有登录脚本</li> <li>.bashrc - <code>bash</code>的配置文件</li> <li>.bash_history - <code>bash</code>环境下保持命令历史记录</li> </ul> </li> <li><code>run</code> - 应用程序状态文件</li> <li>为应用程序提供了一个标准位置来存储它们需要的临时文件，例如套接字和进程ID。 这些文件不能存储在<code>/tmp</code>中，因为<code>/tmp</code>中的文件可能会被删除。</li> <li><code>/run/media/&lt;user&gt;/*</code> - 可移动设备的挂载点，例如：<ul> <li><code>/run/media/media_name/</code></li> <li><code>/run/media/cdrom/</code>- </li> <li><code>/run/media/dvd/</code>- </li> <li><code>/run/media/usbdisk/</code>- </li> </ul> </li> <li><code>/mnt</code> - 文件系统临时挂载点</li> <li>用于挂载临时使用的文件系统的目录。</li> <li>文件系统使用 mount 命令挂载，使用 umount 命令删除。</li> <li>子目录默认不存在，也不会自动创建。</li> <li><code>/srv</code> - 服务数据目录</li> <li>存放各种服务的数据，比如：<ul> <li><code>/srv/www</code> - 用于存放 Apache Web Server 的数据</li> <li><code>/srv/ftp</code> - 用于存放 FTP server 的数据</li> </ul> </li> <li><code>/var</code> - 可变文件（Variable Files）</li> <li>在系统运行过程中会被修改的文件</li> <li>Important subdirectories:<ul> <li><code>/var/lib/</code> - 可变库文件，应用程序状态信息数据</li> <li><code>/var/log/</code> - 日志文件</li> <li><code>/var/run/</code> - 运行中的进程的信息</li> <li><code>/var/lock/</code> - 多用户访问时的锁文件</li> <li><code>/var/cache</code>- 应用程序缓存数据目录</li> <li><code>/var/opt</code> - 专为<code>/opt</code>下的应用程序存储可变数据</li> <li><code>/var/mail</code>- </li> <li><code>/var/spool/</code> - 应用程序数据池，比如：打印机，邮件</li> <li><code>/var/spool/mail</code>- </li> <li><code>/var/spool/cron</code>- </li> </ul> </li> <li><code>/tmp</code> - 临时文件</li> <li>程序在运行时创建临时文件的位置</li> <li><code>/proc</code> - 进程文件</li> <li>虚拟文件系统，不占空间，大小始终为零，保持当前进程的状态信息</li> <li>包含有关各个进程的信息的目录，根据进程的 PID 号命名</li> <li>有些值可以临时在线更改生效，但重启后丢失<ul> <li><code>/proc/cpuinfo/</code> - Processor information</li> <li><code>/proc/dma/</code> - Use of DMA ports</li> <li><code>/proc/interrupts/</code> - Use of interrupts</li> <li><code>/proc/ioports/</code> - Use of I/O ports</li> <li><code>/proc/filesystems/</code> - File system formats the kernel knows</li> <li><code>/proc/modules/</code> - Active modules</li> <li><code>/proc/mounts/</code> - Mounted file systems</li> <li><code>/proc/net/*</code> - Network information and statistics</li> <li><code>/proc/partitions/</code> - Existing partitions</li> <li><code>/proc/bus/pci/</code> - Connected PCI devices</li> <li><code>/proc/bus/scsi/</code> - Connected SCSI devices</li> <li><code>/proc/sys/*</code> - System and kernel information</li> <li><code>/proc/version</code> - Kernel version</li> </ul> </li> <li><code>/sys</code> - 系统信息目录</li> <li>虚拟文件系统，仅存在于内存中，文件大小为零。主要提供如下信息：<ul> <li>硬件总线（hardware buses）</li> <li>硬件设备（hardware devices）</li> <li>有源设备（active devices）</li> <li>驱动程序（drivers）</li> </ul> </li> </ul> <h2 id=_3>文件操作命令<a class=headerlink href=#_3 title="Permanent link"> ¶</a></h2> <h3 id=_4>显示当前工作目录<a class=headerlink href=#_4 title="Permanent link"> ¶</a></h3> <p>pwd命令（print working directory）:</p> <ul> <li>-L: 显示链接路径</li> <li>-P：显示真实物理路径</li> </ul> <h3 id=_5>相对和绝对路径<a class=headerlink href=#_5 title="Permanent link"> ¶</a></h3> <p>对于绝对路径<code>/etc/firewalld/policies</code>，可以通过下面命令得到该路径的基名<code>policies</code>和目录名<code>/etc/firewalld</code>。</p> <div class=highlight><pre><span></span><code>basename /etc/firewalld/policies
dirname /etc/firewalld/policies
</code></pre></div> <h3 id=_6>更改目录<a class=headerlink href=#_6 title="Permanent link"> ¶</a></h3> <p><code>.</code>指当前目录，即<code>pwd</code>命令所返回的目录。</p> <p><code>..</code>指当前目录的上一级目录，及当前目录的父目录。</p> <ul> <li> <p>切换至父目录：<code>cd ..</code></p> </li> <li> <p>切换至当前用户主目录：<code>cd ~</code></p> </li> <li> <p>切换至上次工作目录：<code>cd -</code></p> </li> <li> <p><code>echo $PWD</code>：当前工作目录</p> </li> <li> <p><code>echo $OLDPWD</code>：上次工作目录</p> </li> </ul> <h3 id=_7>列出目录内容<a class=headerlink href=#_7 title="Permanent link"> ¶</a></h3> <p><code>ls</code>命令：</p> <ul> <li><code>-a</code> 显示所有文件及目录 (. 开头的隐藏文件也会列出)</li> <li><code>-A</code> 同 <code>-a</code> ，但不列出 <code>.</code> (目前目录) 及 <code>..</code> (父目录)</li> <li><code>-l</code> 除文件名称外，亦将文件型态、权限、拥有者、文件大小等资讯详细列出</li> <li><code>-r</code> 将文件以相反次序显示(原定依英文字母次序)</li> <li><code>-t</code> 将文件依建立时间之先后次序列出</li> <li><code>-F</code> 在列出的文件名称后加一符号；例如可执行档则加 "*", 目录则加 "/"</li> <li><code>-R</code> 递归列出子目录</li> <li><code>-S</code> 按文件大小排序，从大到小</li> <li><code>-1</code> 按一个文件一行列出</li> <li><code>-t</code> 按文件时间排序，最新的在前</li> <li><code>-U</code> 不排序输出，按目录存放顺序列出</li> <li><code>-u</code> 配合<code>-lt</code>，按访问时间排序并显示；配合<code>-l</code>，显示访问时间并按名称排序； 否则按访问时间排序，最新的在前</li> <li><code>-X</code> 按文件扩展名字母顺序排序输出</li> <li><code>-F</code> 对不同类型文件显示时附加不同的符号，<code>* / = &gt; @ |</code>之一</li> </ul> <p><code>ls</code>命令查看不同文件是的颜色，由<code>/etc/DIR_COLORS</code>和变量<code>@LS_COLORS</code>定义。</p> <h3 id=stat>文件状态stat<a class=headerlink href=#stat title="Permanent link"> ¶</a></h3> <p>每个文件有三个时间戳：</p> <ul> <li>访问时间 Access Time <code>atime</code> : 读取文件内容。</li> <li>修改时间 Modify Time <code>mtime</code> : 改变文件内容（数据）。</li> <li>改变时间 Change Time <code>ctime</code> : 元数据发生改变。</li> </ul> <p>读取三个时间戳的命令<code>stat</code>：</p> <div class=highlight><pre><span></span><code>stat /etc/fstab
</code></pre></div> <p>输出结果：</p> <div class=highlight><pre><span></span><code>  File: /etc/fstab
  Size: 927             Blocks: 8          IO Block: 4096   regular file
Device: 30h/48d Inode: 263         Links: 1
Access: (0644/-rw-r--r--)  Uid: (    0/    root)   Gid: (    0/    root)
Access: 2022-10-31 10:26:34.987466959 +0800
Modify: 2022-06-24 14:50:24.387992912 +0800
Change: 2022-06-24 14:50:24.387992912 +0800
 Birth: 2022-06-24 14:50:23.755992937 +0800
</code></pre></div> <h3 id=_8>确定文件类型<a class=headerlink href=#_8 title="Permanent link"> ¶</a></h3> <p>命令<code>file</code>检查文件类型。</p> <ul> <li><code>-b</code>：列出辨识结果时，不显示文件名称。</li> <li><code>-c</code>：详细显示指令执行过程，便于排错或分析程序执行的情形。</li> <li><code>-f &lt;名称文件&gt;</code>：指定名称文件，其内容有一个或多个文件名称时，让file依序辨识这些文件，格式为每列一个文件名称。</li> <li><code>-L</code>： 直接显示符号连接所指向的文件的类别。</li> <li><code>-v</code>： 显示版本信息。</li> <li><code>-z</code>： 尝试去解读压缩文件的内容。</li> </ul> <p>编辑文件<code>list.txt</code>包含一下内容：</p> <div class=highlight><pre><span></span><code>/etc/
/bin
/etc/issue
</code></pre></div> <p>运行命令<code>file -f list.txt</code>，结果如下：</p> <div class=highlight><pre><span></span><code>/etc/:      directory
/bin:       directory
/etc/issue: symbolic link to ../run/issue
</code></pre></div> <h3 id=_9>文件编码转换<a class=headerlink href=#_9 title="Permanent link"> ¶</a></h3> <p><code>iconv</code>命令用于将一种编码中的某些文本转换为另一种编码。 如果没有提供输入文件，则它从标准输入中读取。 同样，如果没有给出输出文件，那么它会写入标准输出。 如果没有提供 <code>from-encoding</code> 或 <code>to-encoding</code>，则它使用当前本地的字符编码。</p> <p>将文本从 ISO 8859-15 字符编码转换为 UTF-8，读入<code>input.txt</code>，输出<code>output.txt</code>。</p> <div class=highlight><pre><span></span><code>iconv -f ISO-8859-15 -t UTF-8 &lt; input.txt &gt; output.txt
</code></pre></div> <p>从 UTF-8 转换为 ASCII，尽可能进行音译（transliterating）：</p> <div class=highlight><pre><span></span><code>echo abc ß α € àḃç | iconv -f UTF-8 -t ASCII//TRANSLIT
</code></pre></div> <p>运行结果：</p> <div class=highlight><pre><span></span><code>abc ss ? EUR abc
</code></pre></div> <h3 id=_10>通配符<a class=headerlink href=#_10 title="Permanent link"> ¶</a></h3> <p>通配符，指包含这些字符的字符串</p> <ul> <li><code>?</code> ：表示任意一个字符</li> <li><code>*</code> ：表示任意长度的任意字符</li> <li><code>[]</code> ：匹配指定范围内任意一个字符</li> <li><code>[abcd]</code>：匹配abcd中的任何一个字符</li> <li><code>[a-z]</code>：匹配范围a到z内任意一个字符</li> <li><code>[!abcd]</code>：不匹配括号里面任何一个字符</li> <li><code>{}</code> ：表示生成序列，以逗号分割，不能有空格</li> </ul> <p>示例：</p> <div class=highlight><pre><span></span><code>$ touch file_{a..z}.txt
$ touch file_{A..Z}.txt

$ ls
file_a.txt  file_C.txt  file_f.txt  file_H.txt  file_k.txt  file_M.txt  file_p.txt  file_R.txt  file_u.txt  file_W.txt  file_z.txt
file_A.txt  file_d.txt  file_F.txt  file_i.txt  file_K.txt  file_n.txt  file_P.txt  file_s.txt  file_U.txt  file_x.txt  file_Z.txt
file_b.txt  file_D.txt  file_g.txt  file_I.txt  file_l.txt  file_N.txt  file_q.txt  file_S.txt  file_v.txt  file_X.txt
file_B.txt  file_e.txt  file_G.txt  file_j.txt  file_L.txt  file_o.txt  file_Q.txt  file_t.txt  file_V.txt  file_y.txt
file_c.txt  file_E.txt  file_h.txt  file_J.txt  file_m.txt  file_O.txt  file_r.txt  file_T.txt  file_w.txt  file_Y.txt

$ ls file_[a..d].*
file_a.txt  file_d.txt

$ ls file_[a...d].*
file_a.txt  file_d.txt

$ ls file_[ad].*
file_a.txt  file_d.txt

$ ls file_[a-c].*
file_a.txt  file_A.txt  file_b.txt  file_B.txt  file_c.txt

$ ls file_[a-C].*
file_a.txt  file_A.txt  file_b.txt  file_B.txt  file_c.txt  file_C.txt

$ ls file_[!d-W].*
file_a.txt  file_b.txt  file_c.txt  file_x.txt  file_y.txt  file_z.txt
file_A.txt  file_B.txt  file_C.txt  file_X.txt  file_Y.txt  file_Z.txt
</code></pre></div> <p>比较有无<code>*</code>的区别：</p> <div class=highlight><pre><span></span><code>$ ls -a *
file_a.txt  file_D.txt  file_h.txt  file_K.txt  file_o.txt  file_R.txt  file_v.txt  file_Y.txt
file_A.txt  file_e.txt  file_H.txt  file_l.txt  file_O.txt  file_s.txt  file_V.txt  file_z.txt
file_b.txt  file_E.txt  file_i.txt  file_L.txt  file_p.txt  file_S.txt  file_w.txt  file_Z.txt
file_B.txt  file_f.txt  file_I.txt  file_m.txt  file_P.txt  file_t.txt  file_W.txt
file_c.txt  file_F.txt  file_j.txt  file_M.txt  file_q.txt  file_T.txt  file_x.txt
file_C.txt  file_g.txt  file_J.txt  file_n.txt  file_Q.txt  file_u.txt  file_X.txt
file_d.txt  file_G.txt  file_k.txt  file_N.txt  file_r.txt  file_U.txt  file_y.txt

$ ls -a
.           file_C.txt  file_g.txt  file_J.txt  file_n.txt  file_Q.txt  file_u.txt  file_X.txt
..          file_d.txt  file_G.txt  file_k.txt  file_N.txt  file_r.txt  file_U.txt  file_y.txt
file_a.txt  file_D.txt  file_h.txt  file_K.txt  file_o.txt  file_R.txt  file_v.txt  file_Y.txt
file_A.txt  file_e.txt  file_H.txt  file_l.txt  file_O.txt  file_s.txt  file_V.txt  file_z.txt
file_b.txt  file_E.txt  file_i.txt  file_L.txt  file_p.txt  file_S.txt  file_w.txt  file_Z.txt
file_B.txt  file_f.txt  file_I.txt  file_m.txt  file_P.txt  file_t.txt  file_W.txt
file_c.txt  file_F.txt  file_j.txt  file_M.txt  file_q.txt  file_T.txt  file_x.txt
</code></pre></div> <h3 id=_11>字符集<a class=headerlink href=#_11 title="Permanent link"> ¶</a></h3> <ul> <li><code>[:alpha:]</code>：表示所有的字母（不区分大小写），效果同<code>[a-z]</code></li> <li><code>[:digit:]</code>：表示任意单个数字，效果同<code>[0-9]</code></li> <li><code>[:xdigit:]</code>：表示十六进制数字</li> <li><code>[:lower:]</code>：表示任意单个小写字母</li> <li><code>[:upper:]</code>：表示任意单个大写字母</li> <li><code>[:alnum:]</code>：表示任意单个字母或数字</li> <li><code>[:blank:]</code>：表示空白字符（空格和制表符）</li> <li><code>[:space:]</code>：表示包括空格、制表符（水平和垂直）、换行符、回车符等各种类型的空白，比<code>[:blank:]</code>范围更广</li> <li><code>[:cntrl:]</code>：表示不可打印的控制字符（退格、删除、警铃等）</li> <li><code>[:graph:]</code>：表示可打印的非空白字符</li> <li><code>[:print:]</code>：表示可打印字符</li> <li><code>[:punct:]</code>：表示标点符号</li> </ul> <p>举例：</p> <ul> <li><code>ls -d [[:alpha:]]</code>即<code>ls -d [a-Z]</code>：显示当前目录下所有单个字母的目录和文件</li> <li><code>ls -d *[[:digit:]]</code>即<code>ls -d *[0-9]</code>：显示当前目录下所有以数字结尾的目录和文件</li> <li><code>ls [[:lower:]].txt</code>：显示当前目录下所有以单个小写字母为名的.txt格式的文件</li> <li><code>ls -d [[:alnum:]]</code>：显示当前目录下所有单个字母（不区分大小写）或数字为名的目录或文件</li> </ul> <h3 id=_12>特殊符号<a class=headerlink href=#_12 title="Permanent link"> ¶</a></h3> <ul> <li><code>|</code> ：管道符，或者（正则）</li> <li><code>&gt;</code> ：输出重定向</li> <li><code>&gt;&gt;</code> ：输出追加重定向</li> <li><code>&lt;</code> ：输入重定向</li> <li><code>&lt;&lt;</code> ：追加输入重定向</li> <li><code>~</code> ：当前用户家目录</li> <li><code>$()</code> ：引用命令被执行后的结果</li> <li><code>$</code> ：以...结尾（正则）</li> <li><code>^</code> ：以...开头（正则）</li> <li><code>*</code> ：匹配全部字符，通配符</li> <li><code>?</code> ：任意一个字符，通配符</li> <li><code>#</code> ：注释</li> <li><code>&amp;</code> ：让程序或脚本切换到后台执行</li> <li><code>&amp;&amp;</code> ：并且，同时成立</li> <li><code>[]</code> ：表示一个范围（正则，通配符）</li> <li><code>{}</code> ：产生一个序列（通配符）</li> <li><code>.</code> ：当前目录的硬链接</li> <li><code>..</code> ：上级目录的硬链接</li> </ul> <h3 id=touch>刷新文件时间<code>touch</code><a class=headerlink href=#touch title="Permanent link"> ¶</a></h3> <p><code>touch</code>命令可以创建空文件，也可以刷新文件时间。参数如下：</p> <ul> <li><code>-a</code>：仅改变<code>atime</code>和<code>ctime</code></li> <li><code>-m</code>：仅改变<code>mtime</code>和<code>ctime</code></li> <li><code>-t [[CC]YY]MMDDhhmm[.ss]</code>：指定<code>atime</code>和<code>mtime</code></li> <li><code>-c</code>：如果文件不存在，则不创建</li> </ul> <div class=highlight><pre><span></span><code>$ touch file1
$ touch file2

$ ll
-rw-r--r--. 1 vagrant wheel 5 Nov  8 20:49 file1
-rw-r--r--. 1 vagrant wheel 0 Nov  8 20:28 file2
</code></pre></div> <p>创建文件file-non.log，如果不存在则不创建。</p> <div class=highlight><pre><span></span><code>touch -c file-non.log
</code></pre></div> <p>更新<code>file1</code>的时间和<code>file2</code>一致。</p> <div class=highlight><pre><span></span><code>$ touch -r file1 file2

$ ll
-rw-r--r--. 1 vagrant wheel 5 Nov  8 20:49 file1
-rw-r--r--. 1 vagrant wheel 0 Nov  8 20:49 file2
</code></pre></div> <p>指定<code>file2</code>的时间。<code>202210012135.25</code>代表<code>YYYYMMDDHHMM.SS</code>。</p> <div class=highlight><pre><span></span><code>$ touch -t 202210012135.25 file2

$ ll
-rw-r--r--. 1 vagrant wheel 5 Nov  8 20:49 file1
-rw-r--r--. 1 vagrant wheel 0 Oct  1 21:35 file2

$ stat file2
  File: file2
  Size: 0               Blocks: 0          IO Block: 4096   regular empty file
Device: fd02h/64770d    Inode: 140         Links: 1
Access: (0644/-rw-r--r--)  Uid: ( 1000/ vagrant)   Gid: (   10/   wheel)
Context: unconfined_u:object_r:user_home_t:s0
Access: 2022-10-01 21:35:25.000000000 +0800
Modify: 2022-10-01 21:35:25.000000000 +0800
Change: 2022-11-08 20:56:18.306315887 +0800
 Birth: 2022-11-08 20:28:37.809551441 +0800
</code></pre></div> <h3 id=cp>复制文件和目录<code>cp</code><a class=headerlink href=#cp title="Permanent link"> ¶</a></h3> <p><code>cp</code>命令：Copy SOURCE to DEST, or multiple SOURCE(s) to DIRECTORY.</p> <p>常用参数：</p> <ul> <li><code>-a</code>：归档，相当于<code>-dR --preserv=all</code>参数组合，常用于备份。</li> <li><code>-d</code>：不复制原文件，只复制链接名。相当于<code>--no-dereference --preserve=links</code>参数组合。</li> <li><code>-f</code>：覆盖已经存在的目标文件。</li> <li><code>-i</code>：覆盖目标文件之前给出提示。</li> <li><code>-p</code>：除复制文件的内容外，也复制文件权限，时间戳，属主属组。相当于<code>--preserve=mode,ownership,timestamps</code>。</li> <li><code>-r, -R, --recursive</code>：递归复制目录所包含的全部内容。</li> <li><code>-l</code>：不复制文件，只是生成硬链接文件。</li> </ul> <p>参数<code>--preserv</code>可选项：</p> <ul> <li>mode：权限</li> <li>ownership：属主属组</li> <li>timestamp</li> <li>links</li> <li>xattr</li> <li>context</li> <li>all</li> </ul> <p>创建测试目录。</p> <div class=highlight><pre><span></span><code>$ cd ~
$ mkdir test
</code></pre></div> <p>对比参数<code>-p</code>的差别。</p> <div class=highlight><pre><span></span><code>$ cp /etc/issue ~/test/issue1
$ cp -p /etc/issue ~/test/issue1
$ sudo cp /etc/issue ~/test/issue3
$ sudo cp -p /etc/issue ~/test/issue4

$ ll ~/test
-rw-r--r--. 1 vagrant wheel 23 Nov  8 22:25 issue1
-rw-r--r--. 1 vagrant wheel 23 Jul 21 01:10 issue2
-rw-r--r--. 1 root    root  23 Nov  8 22:43 issue3
-rw-r--r--. 1 root    root  23 Jul 21 01:10 issue4

$ ll /etc/issue
-rw-r--r--. 1 root root 23 Jul 21 01:10 /etc/issue
</code></pre></div> <p>对比参数<code>-r</code>。</p> <div class=highlight><pre><span></span><code>$ sudo cp /etc/sysconfig/ ~/test
cp: -r not specified; omitting directory &#39;/etc/sysconfig/&#39;

$ sudo cp -r /etc/sysconfig/ ~/test

$ tree -L 2 ~/test
/home/vagrant/test
├── issue1
├── issue2
├── issue3
├── issue4
└── sysconfig
    ├── anaconda
    ├── atd
    ├── chronyd
    ├── cpupower
    ├── crond
    ├── firewalld
    ├── irqbalance
    ├── kdump
    ├── kernel
    ├── man-db
    ├── network
    ├── network-scripts
    ├── nftables.conf
    ├── raid-check
    ├── rsyslog
    ├── run-parts
    ├── samba
    ├── selinux -&gt; ../selinux/config
    ├── smartmontools
    └── sshd
</code></pre></div> <p>参数<code>-b</code>，如果目标文件存在，复制前先将原文件复制并以<code>~</code>结尾。</p> <div class=highlight><pre><span></span><code>$ ll /etc/motd
-rw-r--r--. 1 root root 0 Jun 23  2020 /etc/motd

$ ll ~/test/issue1
-rw-r--r--. 1 vagrant wheel 23 Nov  8 22:25 /home/vagrant/test/issue1

$ cp -b /etc/motd ~/test/issue
$ cp -b /etc/motd ~/test/issue1 

$ ll ~/test
-rw-r--r--. 1 vagrant wheel    0 Nov  8 23:00 issue
-rw-r--r--. 1 vagrant wheel    0 Nov  8 22:57 issue1
-rw-r--r--. 1 vagrant wheel   23 Nov  8 22:25 issue1~
-rw-r--r--. 1 vagrant wheel   23 Jul 21 01:10 issue2
-rw-r--r--. 1 root    root    23 Nov  8 22:43 issue3
-rw-r--r--. 1 root    root    23 Jul 21 01:10 issue4
drwxr-xr-x. 3 root    root  4096 Nov  8 22:49 sysconfig
</code></pre></div> <p>参数<code>--backup=numbered</code>会在复制原文件时加上数字序号，序号1代表原始的文件。</p> <div class=highlight><pre><span></span><code>$ cp --backup=numbered /etc/motd ~/test/issue2
$ cp --backup=numbered /etc/motd ~/test/issue2
$ cp --backup=numbered /etc/motd ~/test/issue2

$ ll ~/test
-rw-r--r--. 1 vagrant wheel    0 Nov  8 23:00 issue
-rw-r--r--. 1 vagrant wheel    0 Nov  8 22:57 issue1
-rw-r--r--. 1 vagrant wheel   23 Nov  8 22:25 issue1~
-rw-r--r--. 1 vagrant wheel    0 Nov  8 23:09 issue2
-rw-r--r--. 1 vagrant wheel   23 Jul 21 01:10 issue2.~1~
-rw-r--r--. 1 vagrant wheel    0 Nov  8 23:09 issue2.~2~
-rw-r--r--. 1 vagrant wheel    0 Nov  8 23:09 issue2.~3~
-rw-r--r--. 1 root    root    23 Nov  8 22:43 issue3
-rw-r--r--. 1 root    root    23 Jul 21 01:10 issue4
drwxr-xr-x. 3 root    root  4096 Nov  8 22:49 sysconfig
</code></pre></div> <h3 id=mv>移动文件和目录<code>mv</code><a class=headerlink href=#mv title="Permanent link"> ¶</a></h3> <p><code>mv</code>命令。Rename SOURCE to DEST, or move SOURCE(s) to DIRECTORY.</p> <p>常用参数：</p> <ul> <li><code>-v</code>：显示命令执行的信息。</li> <li><code>-i</code>：交互式，比如，重名覆盖时会提升是否确认。</li> <li><code>-b</code>：覆盖时创建备份。默认情况下，移动文件将会覆盖已存在的目标文件。</li> </ul> <p>移动多个文件到某个目录。</p> <div class=highlight><pre><span></span><code>$ mv file1 file2 file3 ~/dest
$ mv file* ~/dest
</code></pre></div> <p>移动目录。</p> <div class=highlight><pre><span></span><code>mv ~/test ~/dest/new/one/
</code></pre></div> <p>重命名文件和目录。</p> <div class=highlight><pre><span></span><code>$ mv file1 file2
$ mv ~/test ~/dest
</code></pre></div> <h3 id=rename>重命名文件和目录<code>rename</code><a class=headerlink href=#rename title="Permanent link"> ¶</a></h3> <p><code>rename</code>命令。分为perl版本和C语言版本。 区分方法: <code>rename --version</code>。如果返回结果中包含 <code>util-linux</code>，说明是C语言版本, 反之是Perl版本。 openSUSE和Rocy是C语言版本，Ubuntu是Perl版本。</p> <p>举例：修改当前目录所有扩展名为<code>s</code>的文件改为扩展名为<code>gz</code>。</p> <div class=highlight><pre><span></span><code>$ touch file{1..3}.s

$ rename -v &#39;.s&#39; &#39;.gz&#39; *.s
$ rename -v &quot;.s&quot; &quot;.gz&quot; *.s
`file1.txt&#39; -&gt; `file1.html&#39;
`file2.txt&#39; -&gt; `file2.html&#39;
`file3.txt&#39; -&gt; `file3.html&#39;
</code></pre></div> <p>在Ubuntu上完成同样任务，则需要使用正则。</p> <div class=highlight><pre><span></span><code>rename -v &quot;s/s/gz/g&quot; *.s
</code></pre></div> <h3 id=rm>删除文件<code>rm</code><a class=headerlink href=#rm title="Permanent link"> ¶</a></h3> <p><code>rm</code>命令。建议使用<code>mv</code>命令代替<code>rm</code>命令。</p> <h3 id=_13>目录操作命令<a class=headerlink href=#_13 title="Permanent link"> ¶</a></h3> <p>创建目录：<code>mkdir</code></p> <p>删除空目录：<code>rmdir</code></p> <p>删除非空目录：<code>rm -r</code></p> <p>显示目录树：<code>tree</code></p> <h3 id=_14>练习<a class=headerlink href=#_14 title="Permanent link"> ¶</a></h3> <ol> <li>显示<code>/etc</code>目录下所有以<code>l</code>开头，以一个小写字母结尾，且中间出现至少一位数字的文件或目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls -d /etc/l*[0-9]*[a-z]
ls -d /etc/l*[[:digit:]]*[[:lower:]]
</code></pre></div> <p>如果无符合条件的记录返回，可以手工创建一个符合条件的文件和目录。</p> <div class=highlight><pre><span></span><code>sudo touch /etc/lam4you
sudo mkdir /etc/lam5you
</code></pre></div> <p>验证后删除。</p> <div class=highlight><pre><span></span><code>sudo rm /etc/lam4you
sudo rm -rf /etc/lam5you
</code></pre></div> <ol> <li>显示<code>/etc</code>目录下以任意一位数字开头，且以非数字结尾的文件或目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls /etc/[0-9]*[!0-9]
ls /etc/[[:digit:]]*[^[:digit:]]
</code></pre></div> <p>如果无符合条件的记录返回，可以手工创建一个符合条件的文件和目录。</p> <div class=highlight><pre><span></span><code>sudo touch /etc/5am4yo.
sudo mkdir /etc/5am5yo.
</code></pre></div> <p>验证后删除。</p> <div class=highlight><pre><span></span><code>sudo rm /etc/5am4yo.
sudo rm -rf /etc/5am5yo.
</code></pre></div> <ol> <li>显示<code>/etc</code>目录下以非字母开头，后面跟了一个字母及其它任意长度任意字符的文件或目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls /etc/[!a-zA-Z][a-zA-Z]*
ls /etc/[^[:alpha:]][[:alpha:]]*
</code></pre></div> <p>如果无符合条件的记录返回，可以手工创建一个符合条件的文件和目录。</p> <div class=highlight><pre><span></span><code>sudo touch /etc/5Ato3
sudo mkdir /etc/6dog6
</code></pre></div> <p>验证后删除。</p> <div class=highlight><pre><span></span><code>sudo rm /etc/5Ato3
sudo rm -rf /etc/6dog6
</code></pre></div> <ol> <li>显示<code>/etc</code>目录下，所有以<code>rc</code>开头，并后面是0-6之间的数字，其它为任意字符的文件或目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls /etc/rc[0-6]*
</code></pre></div> <p>如果无符合条件的记录返回，可以手工创建一个符合条件的文件和目录。</p> <div class=highlight><pre><span></span><code>sudo touch /etc/rc5come
sudo mkdir /etc/rc0123
</code></pre></div> <p>验证后删除。</p> <div class=highlight><pre><span></span><code>sudo rm /etc/rc5come
sudo rm -rf /etc/rc0123
</code></pre></div> <ol> <li>显示<code>/etc</code>目录下，所有以<code>.conf</code>结尾，且以<code>m</code>、<code>n</code>、<code>r</code>、<code>p</code>开头的文件或目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls /etc/[mnrp]*.conf
</code></pre></div> <ol> <li>只显示<code>/root</code>下的隐藏文件和目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls .*
</code></pre></div> <ol> <li>只显示/etc下非隐藏目录列表。</li> </ol> <div class=highlight><pre><span></span><code>ls /etc/[^.]*/
</code></pre></div> <ol> <li>将<code>/etc</code>目录下所有文件，备份到<code>~/test/</code>目录下，并要求子目录格式为<code>backupYYYY-mm-dd</code>，备份过程可见。</li> </ol> <div class=highlight><pre><span></span><code>$ sudo cp -av /etc/ ~/test/backup`date +%F`
$ sudo cp -av /etc/ ~/test/backup`date +%F_%H-%M-%S`
</code></pre></div> <ol> <li>创建目录<code>~/testdir/dir1/x</code>，<code>~/testdir/dir1/y</code>，<code>~/testdir/dir1/x/a</code>，<code>~/testdir/dir1/x/b</code>，<code>~/testdir/dir1/y/a</code>，<code>~/testdir/dir1/y/b</code>。</li> </ol> <div class=highlight><pre><span></span><code>$ mkdir -p ~/testdir/dir1/{x,y}/{a,b}

$ tree ~/testdir/dir1/
/home/vagrant/testdir/dir1/
├── x
│   ├── a
│   └── b
└── y
  ├── a
  └── b
</code></pre></div> <ol> <li> <p>创建目录<code>~/testdir/dir2/x</code>，<code>~/testdir/dir2/y</code>，<code>~/testdir/dir2/x/a</code>，<code>~/testdir/dir2/x/b</code>。</p> <div class=highlight><pre><span></span><code>$ mkdir -p ~/testdir/dir2/{x/{a,b},y}

$ tree ~/testdir/dir2/
/home/vagrant/testdir/dir2/
├── x
│   ├── a
│   └── b
└── y
</code></pre></div> </li> <li> <p>创建目录<code>~/testdir/dir3</code>、<code>~/testdir/dir4</code>、<code>~/testdir/dir5</code>、<code>~/testdir/dir5/dir6</code>、<code>~/testdir/dir5/dir7</code>。</p> <div class=highlight><pre><span></span><code>$ mkdir -p ~/testdir/dir{3,4,5/dir{6,7}}

$ tree ~/testdir
/home/vagrant/testdir
├── dir1
│   ├── x
│   │   ├── a
│   │   └── b
│   └── y
│       ├── a
│       └── b
├── dir2
│   ├── x
│   │   ├── a
│   │   └── b
│   └── y
├── dir3
├── dir4
└── dir5
 ├── dir6
 └── dir7
</code></pre></div> </li> </ol> <h2 id=_15>七种文件类型<a class=headerlink href=#_15 title="Permanent link"> ¶</a></h2> <ul> <li>普通文件（Normal Files）</li> <li>ASCII 文本文件</li> <li>可执行文件</li> <li>图形文件</li> <li>目录（Directories）</li> <li>组织规划磁盘上的文件</li> <li>包含文件和子目录</li> <li>实现分层文件系统</li> <li>链接（Links）</li> <li>硬链接（Hard links）<ul> <li>磁盘上文件的辅助文件名</li> <li>多个文件名引用单个<code>inode</code></li> <li>引用的文件必须存在于同一个文件系统中</li> </ul> </li> <li>符号链接（Symbolic links）<ul> <li>对磁盘上其他文件的引用</li> <li><code>inode</code>包含对另一个文件名的引用</li> <li>被引用的文件可以存在于同一个文件系统中，也可以存在于其他文件系统中</li> <li>符号链接可以引用不存在的文件（断开的链接）</li> </ul> </li> <li>套接字Sockets - 用于进程之间的双向通信。</li> <li>管道（Pipes）(FIFOs) - 用于从一个进程到另一个进程的单向通信。</li> <li>块设备（Block Devices）</li> <li>字符设备（Character Devices）</li> </ul> <h3 id=inode>inode结构<a class=headerlink href=#inode title="Permanent link"> ¶</a></h3> <p>文件储存在硬盘上，硬盘的最小存储单位叫做“扇区”（Sector）。每个扇区储存512字节（相当于0.5KB）。</p> <p>操作系统读取硬盘的时候，不是一个一个扇区读取，而是一次性连续读取多个扇区，我们称为读取一个“块”（block）。</p> <p>常见的block的大小是4KB（连续八个sector组成一个block）。</p> <p>多个扇区组成的block是文件存取的*最小单位*。</p> <p>文件数据储存在block中，文件的元信息，比如文件的创建者、创建日期、文大小等，存储在inode，即“索引节点”。</p> <p>每一个文件都有对应的inode，里面包含了与该文件有关的一些信息。注意，除了文件名以外的其它文件信息，都存在inode之中。</p> <p>inode包含文件的元信息主要有：</p> <ul> <li>文件的字节数</li> <li>文件拥有者的 User ID</li> <li>文件的 Group ID</li> <li>文件的读、写、执行权限</li> <li>文件的时间戳，共有三个：ctime指inode上一次变动的时间，mtime指文件内容上一次变动的时间，atime指文件上一次打开的时间。</li> <li>链接数，即有多少文件名指向这个inode</li> <li>文件数据block的位置</li> </ul> <p>查看inode信息的命令<code>stat</code>：</p> <div class=highlight><pre><span></span><code>$ stat file1
  File: file1
  Size: 5               Blocks: 8          IO Block: 4096   regular file
Device: fd02h/64770d    Inode: 143         Links: 1
Access: (0644/-rw-r--r--)  Uid: ( 1000/ vagrant)   Gid: (   10/   wheel)
Context: unconfined_u:object_r:user_home_t:s0
Access: 2022-11-08 20:49:26.019678244 +0800
Modify: 2022-11-08 20:49:26.019678244 +0800
Change: 2022-11-08 20:49:26.028678455 +0800
 Birth: 2022-11-08 20:49:26.019678244 +0800
</code></pre></div> <p>格式化硬盘时，操作系统会自动将硬盘分成两个区域。一个是数据区，存放文件数据。另一个是inode区（inode table），存放inode所包含的文件的元信息。</p> <p>每个inode节点的大小，一般是128字节或256字节。inode节点的总数，在格式化时就确定了，一般是每1KB或每2KB就设置一个inode。</p> <p>假定一块1GB的硬盘，如果每个inode节点的大小为128字节，且每1KB就设置一个inode，则inode table的大小就会达到128MB，占整块硬盘的12.8%。</p> <p>通过<code>df</code>命令查看每个硬盘分区的inode总数和已经使用的数量。 由于每个文件都必须有一个inode，因此有可能发生inode已经用光，但是硬盘还未存满的情况，也就无法在硬盘上创建新文件。</p> <div class=highlight><pre><span></span><code>$ df -i
Filesystem                         Inodes IUsed   IFree IUse% Mounted on
tmpfs                              497897   872  497025    1% /run
/dev/mapper/ubuntu--vg-ubuntu--lv 3211264 81473 3129791    3% /
tmpfs                              497897     1  497896    1% /dev/shm
tmpfs                              497897     3  497894    1% /run/lock
/dev/sda2                          131072   316  130756    1% /boot
tmpfs                               99579    25   99554    1% /run/user/1000
</code></pre></div> <p>下面命令可以查看每个inode节点的大小：</p> <div class=highlight><pre><span></span><code>$ sudo dumpe2fs -h /dev/sda2 | grep &quot;Inode size&quot;
dumpe2fs 1.46.5 (30-Dec-2021)
Inode size:               256
</code></pre></div> <p>每个inode都有一个号码，操作系统用inode号码来识别不同的文件，注意，不是通过文件名来识别不同文件。从操作系统角度看，文件名只是inode号码对一个别名。</p> <p>用户通过文件名，打开某个文件的过程，操作系统分成三步完成： 首先，系统找到这个文件名对应的inode号码。 其次，通过inode号，获取inode信息。 第三，通过inode信息，找到文件数据所在的block，读出数据。</p> <p>通过<code>ls -i</code>命令，可以得到文件对应的inode号：</p> <div class=highlight><pre><span></span><code>$ ls -i file1
143 file1
</code></pre></div> <p>目录（directory）也是一种文件。打开目录，实际上就是打开目录文件。</p> <p>目录文件的结构是由一个包含一系列目录项（dirent）的列表组成。 每个目录项由两部分组成：所包含文件的文件名，以及该文件名对应的inode号。</p> <p>命令<code>ls -i</code>列出整个目录文件，即文件名和inode号：</p> <div class=highlight><pre><span></span><code>$ ls -i
143 file1  140 file2  139 test

$ ls -il
143 -rw-r--r--. 1 vagrant wheel    5 Nov  8 20:49 file1
140 -rw-r--r--. 1 vagrant wheel    0 Oct  1 21:35 file2
139 drwxr-xr-x. 5 vagrant wheel 4096 Nov  9 22:00 test
</code></pre></div> <h3 id=_16>链接类型<a class=headerlink href=#_16 title="Permanent link"> ¶</a></h3> <p><strong>硬链接</strong>（Hard links）硬链接是存储卷上文件的目录引用或指针。 文件名是存储在目录结构中的标签，目录结构指向文件数据。 因此，可以将多个文件名与同一文件关联。 通过不同的文件名访问时，所做的任何更改都是针对源文件数据。</p> <p><strong>符号链接</strong>（Symbolic links）: 符号链接包含一个文本字符串，操作系统将其解释为另一个文件或目录。 它本身就是一个文件，可以独立于目标而存在。 如果删除了符号链接，则其目标文件或目录不受影响。 如果移动，重命名或删除目标文件或目录，则用于指向它的任何符号链接将继续存在，但指向的是一个不存在的文件。</p> <p>仅当文件和链接文件位于同一文件系统（在同一分区上）时，才能使用硬链接，因为inode编号在同一文件系统中仅是唯一的。 可以使用<code>ln</code>命令创建硬链接，指向已存在文件的inode，可以通过文件名或者硬链接名访问文件。 </p> <p>可以使用<code>ln -s</code>选项创建符号链接。 一个符号链接会被分配一个单独的inode，并指向一个文件，所以可以明显区分符号链接文件和实际文件。 </p> <p>文件系统本质上是一个用于跟踪分区卷中的文件的数据库。 对于普通文件，分配数据块以存储文件的数据，分配inode以指向数据块以及存储关于文件的元数据，然后将文件名分配给inode。 硬链接是与现有inode关联的辅助文件名。 对于符号链接，将为新的inode分配一个与之关联的新文件名，但inode引用另一个文件名而不是引用数据块。</p> <p>查看文件名和inode之间关系的一个方法是使用<code>ls -il</code>命令。inode的典型大小为128位，数据块的大小范围可以是1k，2k，4k或更大，具体取决于文件系统类型。</p> <p>软连接可以针对目录，硬连接只能针对文件。</p> <p>硬链接相当于增加了一个登记项，使得原来的文件多了一个名字，至于inode都没变。所谓的登记项其实是目录文件中的一个条目(目录项)，使用hard link 是让多个不同的目录项指向同一个文件的inode，没有多余的内容需要存储在磁盘扇区中，所以hardlink不占用额外的空间。</p> <p>符号链接有单独的inode，在inode中存放另一个文件的路径而不是文件数据，所以符号链接会占用额外的空间。</p> <table> <thead> <tr> <th>特征</th> <th>硬链接</th> <th>符号链接</th> </tr> </thead> <tbody> <tr> <td>本质</td> <td>同一个文件</td> <td>不是同一个文件</td> </tr> <tr> <td>跨设备</td> <td>不支持</td> <td>支持</td> </tr> <tr> <td>inode</td> <td>相同</td> <td>不同</td> </tr> <tr> <td>链接数</td> <td>创建硬链接，链接数会增加，删除则减少</td> <td>创建或删除，链接数都不变</td> </tr> <tr> <td>文件夹</td> <td>不支持</td> <td>支持</td> </tr> <tr> <td>相对路径</td> <td>原始文件的相对路径是相对于当前工作目录</td> <td>原始文件的相对路径是相对于链接文件的相对路径</td> </tr> <tr> <td>删除源文件</td> <td>只是链接数减少，链接文件访问不受影响</td> <td>链接文件将无法访问</td> </tr> <tr> <td>文件类型</td> <td>和源文件相同</td> <td>链接文件，和源文件无关</td> </tr> <tr> <td>文件大小</td> <td>和源文件相同</td> <td>源文件的路径的长度</td> </tr> </tbody> </table> <h3 id=_17>设备文件<a class=headerlink href=#_17 title="Permanent link"> ¶</a></h3> <p><strong>设备文件</strong>（Device File）表示硬件（网卡除外）。 每个硬件都由一个设备文件表示。 网卡是接口。</p> <p>设备文件把内核驱动和物理硬件设备连接起来。 内核驱动程序通过对设备文件进行读写（正确的格式）来实现对硬件的读写。</p> <p>类型：</p> <ul> <li>块设备（Block Devices）：块设备（通常）在512字节的大块中读取/写入信息。</li> <li>字符设备（Character Devices）：字符设备以字符方式读取/写入信息。 字符设备直接提供对硬件设备的无缓冲访问。</li> <li>有时称为裸设备（raw devices）。（注意：裸设备被视为字符设备，不是块设备）</li> <li>通过辅以不同选项，可以广泛而多样地应用和使用字符设备。</li> <li>当内核发现设备时由操作系统<code>udev</code>自动创建。</li> </ul> <h3 id=_18>练习<a class=headerlink href=#_18 title="Permanent link"> ¶</a></h3> <div class="admonition 目标"> <p class=admonition-title>目标</p> <p>以Rocky 9为例。</p> <ul> <li>查看软/硬链接文件的特征。</li> <li>查看目录结构。</li> </ul> </div> <p>可以通过下面命令得到当前系统的2级目录的结构。</p> <div class=highlight><pre><span></span><code>$ tree -L 2 -d /
</code></pre></div> <p>创建练习目录。</p> <div class=highlight><pre><span></span><code>$ mkdir data
$ mkdir -p data/typelink
$ cd data
</code></pre></div> <p>创建硬链接。注意：<code>file</code>、<code>hardlinkfile1</code>、<code>hardlinkfile2</code> 文件的链接位置的数值的变化)</p> <div class=highlight><pre><span></span><code>$ echo &quot;it&#39;s original file&quot; &gt; file
$ ln file hardlinkfile1
$ ln -s file symlinkfile1
$ ln -s file symlinkfile2
</code></pre></div> <p>执行<code>ls -l</code>命令可以得到下面的结果：</p> <div class=highlight><pre><span></span><code>-rw-r--r--. 2 vagrant wheel 19 Nov  1 10:42 file
-rw-r--r--. 2 vagrant wheel 19 Nov  1 10:42 hardlinkfile1
lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile1 -&gt; file
lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile2 -&gt; file
</code></pre></div> <p>创建另外一个硬链接。</p> <div class=highlight><pre><span></span><code>$ ln file hardlinkfile2
</code></pre></div> <p>执行<code>ls -l</code>命令可以得到下面的结果：</p> <div class=highlight><pre><span></span><code>-rw-r--r--. 3 vagrant wheel  19 Nov  1 10:42 file
-rw-r--r--. 3 vagrant wheel  19 Nov  1 10:42 hardlinkfile1
-rw-r--r--. 3 vagrant wheel  19 Nov  1 10:42 hardlinkfile2
lrwxrwxrwx. 1 vagrant wheel   4 Nov  1 10:43 symlinkfile1 -&gt; file
lrwxrwxrwx. 1 vagrant wheel   4 Nov  1 10:43 symlinkfile2 -&gt; file
</code></pre></div> <p>修改<code>file</code>文件的内容。</p> <div class=highlight><pre><span></span><code>$ echo &quot;add oneline&quot; &gt;&gt; file
</code></pre></div> <p>通过命令<code>cat file</code>查看当前<code>file</code>的内容。</p> <div class=highlight><pre><span></span><code>it&#39;s original file
add oneline
</code></pre></div> <p>通过下面的命令，可以看到所以软/硬链接文件内容都更新了，和<code>file</code>文件更新后的内容保持一致。</p> <div class=highlight><pre><span></span><code>$ cat hardlinkfile1
$ cat hardlinkfile2
$ cat symlinkfile1
$ cat symlinkfile2
</code></pre></div> <p>对文件<code>symlinkfile1</code>再创建新的软连接。</p> <div class=highlight><pre><span></span><code>$ ln -s symlinkfile1 symlinkfile1-1
</code></pre></div> <p>通过命令<code>ls -il</code>查看现在的目录信息。</p> <div class=highlight><pre><span></span><code>67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 file
67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 hardlinkfile1
67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 hardlinkfile2
67274681 lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile1 -&gt; file
67274683 lrwxrwxrwx. 1 vagrant wheel 12 Nov  1 11:20 symlinkfile1-1 -&gt; symlinkfile1
67274682 lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile2 -&gt; file
</code></pre></div> <p>读取软链接文件的源文件信息</p> <div class=highlight><pre><span></span><code>$ readlink symlinkfile1
$ readlink symlinkfile2
</code></pre></div> <p>注意，对于<code>symlinkfile1-1</code>的情况有些不同。</p> <div class=highlight><pre><span></span><code>$ readlink symlinkfile1-1
</code></pre></div> <p>上面命令返回结果<code>symlinkfile1</code>仍然是一个符号链接文件。通过<code>readlink -f</code>可以直接定位真正的源文件。</p> <div class=highlight><pre><span></span><code>$ readlink -f symlinkfile1-1
</code></pre></div> <p>上面的返回结果<code>/data/linktype/file</code>是<code>symlinkfile1-1</code>真正的源文件。</p> <p>显示<code>data</code>目录下的文件和子目录：</p> <div class=highlight><pre><span></span><code>$ cd ~
$ tree ./data
</code></pre></div> <p>运行结果：</p> <div class=highlight><pre><span></span><code>./data
├── file
├── hardlinkfile1
├── hardlinkfile2
├── symlinkfile1 -&gt; file
├── symlinkfile1-1 -&gt; symlinkfile1
├── symlinkfile2 -&gt; file
└── typelink
</code></pre></div> <p>只显示<code>data</code>目录下的子目录：</p> <div class=highlight><pre><span></span><code>$ tree -d ./data
</code></pre></div> <p>运行结果：</p> <div class=highlight><pre><span></span><code>./data
└── typelink
</code></pre></div> <p>显示<code>data</code>目录下的文件和子目录，包含全目录：</p> <div class=highlight><pre><span></span><code>$ tree -f ./data
</code></pre></div> <p>运行结果：</p> <div class=highlight><pre><span></span><code>./data
├── ./data/file
├── ./data/hardlinkfile1
├── ./data/hardlinkfile2
├── ./data/symlinkfile1 -&gt; file
├── ./data/symlinkfile1-1 -&gt; symlinkfile1
├── ./data/symlinkfile2 -&gt; file
└── ./data/typelink
</code></pre></div> <h2 id=_19>文件属性说明<a class=headerlink href=#_19 title="Permanent link"> ¶</a></h2> <p>执行命令<code>ls -ihl</code>，可以得到下面的输出结果（Rocky 9）。</p> <div class=highlight><pre><span></span><code>67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 file
67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 hardlinkfile1
67274680 -rw-r--r--. 3 vagrant wheel 31 Nov  1 11:14 hardlinkfile2
67274681 lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile1 -&gt; file
67274683 lrwxrwxrwx. 1 vagrant wheel 12 Nov  1 11:20 symlinkfile1-1 -&gt; symlinkfile1
67274682 lrwxrwxrwx. 1 vagrant wheel  4 Nov  1 10:43 symlinkfile2 -&gt; file
33555262 drwxr-xr-x. 2 vagrant wheel  6 Nov  1 11:30 typelink
</code></pre></div> <p>以<code>67274680 -rw-r--r--. 3 vagrant wheel 31 Nov 1 11:14 file</code>为例：</p> <ul> <li><code>67274680</code>: inode 索引节点编号。</li> <li><code>-rw-r--r--</code>：文件类型及权限</li> <li><code>-</code>：文件类型，例子中出现了三种，<code>-</code>，<code>l</code>和<code>d</code>。<ul> <li><code>-</code>：普通文件</li> <li><code>d</code>：目录</li> <li><code>l</code>：符号链接文件（link）</li> <li><code>b</code>：块设备（block）</li> <li><code>c</code>：字符设备（character）</li> <li><code>p</code>：管道文件（pipe）</li> <li><code>s</code>：套接字文件（socket）</li> </ul> </li> <li><code>rw-r--r--</code>：文件权限，从左到右依次为：<ul> <li><code>rw-</code>：文件属主权限，例子中是<code>vagrant</code>。</li> <li><code>r--</code>：文件属组的权限，例子中是<code>wheel</code>。</li> <li><code>r--</code>：其他组的权限。</li> </ul> </li> <li><code>.</code>：这个点表示文件带有SELinux的安全上下文（SELinux Contexts）。关闭SELinux，新创建的文件就不会再有这个点了。但是，以前创建的文件本来有这个点的还会显示这个点（虽然SELinux不起作用了）。</li> <li><code>3</code>：硬链接数，例子中<code>file</code>和<code>hardlinkfile1</code>和<code>hardlinkfile2</code>之间是硬链接，所以这三个文件的硬链接数都是<code>3</code>。</li> <li><code>vagrant</code>：文件属主</li> <li><code>wheel</code>：文件属组</li> <li><code>31</code>：文件或目录的大小</li> <li><code>Nov 1 11:14</code>：文件或目录的创建日期和时间</li> <li><code>file</code>：文件或目录名称</li> </ul> <p>下面是命令<code>ls -ihl</code>在openSUSE和Ubuntu上的显示结果。</p> <div class=highlight><pre><span></span><code>$ ls -ihl
233647 -rw-r--r-- 3 vagrant wheel 31 Nov  1 15:52 file
233647 -rw-r--r-- 3 vagrant wheel 31 Nov  1 15:52 hardlinkfile1
233647 -rw-r--r-- 3 vagrant wheel 31 Nov  1 15:52 hardlinkfile2
233648 lrwxrwxrwx 1 vagrant wheel  4 Nov  1 15:52 symlinkfile1 -&gt; file
233650 lrwxrwxrwx 1 vagrant wheel 12 Nov  1 15:52 symlinkfile1-1 -&gt; symlinkfile1
233649 lrwxrwxrwx 1 vagrant wheel  4 Nov  1 15:52 symlinkfile2 -&gt; file
233646 drwxr-xr-x 1 vagrant wheel  0 Nov  1 15:51 typelink
</code></pre></div> <h2 id=_20>标准输入输出<a class=headerlink href=#_20 title="Permanent link"> ¶</a></h2> <p>标准输入输出，即I/O，I/O的I是Input，O是output。</p> <ul> <li>I：从外部设备输入到内存</li> <li>O：从内存输出到外部设备</li> </ul> <p>标准输入和标准输出是用于IO的，它们属于外部设备（逻辑上的外部设备），不是内存。</p> <p>linux中一切设备皆是文件！因此标准输入和输出本质就是文件，外部设备以文件形式表现。</p> <p>在Linux系统中，标准输入和标准输出对应的文件是<code>/dev/stdin</code>和<code>/dev/stdout</code>这两个文件。</p> <p>从标准输入读，从逻辑上讲，就是打开<code>/dev/stdin</code>这个文件，并读入文件内容。 输出到标准输出，从逻辑上讲，就是打开<code>/dev/stdout</code>这个文件，并把内容输出到这个文件里去。</p> <p>这里强调的是“逻辑上”，因为<code>/dev/stdin</code>和<code>/dev/stdout</code>这2个文件本身不是设备文件。Linux中设备是文件，但是文件不一定是设备。 因此，操作<code>/dev/stdin</code>和/dev/stdout`这2个文件，实际上是操作两个文件存放地址对应的设备文件。</p> <p>通过下面命令可以看到标准输入输出文件的特点，他们虽然在<code>/dev</code>目录下，都是以<code>l</code>开头的链接文件，指向的是另一个文件的地址。</p> <div class=highlight><pre><span></span><code>$ ls -l /dev/std*
lrwxrwxrwx 1 root root 15 Nov 13 10:39 /dev/stderr -&gt; /proc/self/fd/2
lrwxrwxrwx 1 root root 15 Nov 13 10:39 /dev/stdin -&gt; /proc/self/fd/0
lrwxrwxrwx 1 root root 15 Nov 13 10:39 /dev/stdout -&gt; /proc/self/fd/1

# Rocky
$ ll /proc/self/fd/
lrwx------. 1 vagrant wheel 64 Nov 13 22:38 0 -&gt; /dev/pts/0
lrwx------. 1 vagrant wheel 64 Nov 13 22:38 1 -&gt; /dev/pts/0
lrwx------. 1 vagrant wheel 64 Nov 13 22:38 2 -&gt; /dev/pts/0
lr-x------. 1 vagrant wheel 64 Nov 13 22:38 3 -&gt; /proc/1702/fd

# Ubuntu
$ ll /proc/self/fd/
lrwx------ 1 vagrant sudo 64 Nov 13 14:38 0 -&gt; /dev/pts/0
lrwx------ 1 vagrant sudo 64 Nov 13 14:38 1 -&gt; /dev/pts/0
lrwx------ 1 vagrant sudo 64 Nov 13 14:38 2 -&gt; /dev/pts/0
lr-x------ 1 vagrant sudo 64 Nov 13 14:38 3 -&gt; /proc/2062/fd/

# openSUSE
$ ll /proc/self/fd/*
ls: cannot access &#39;/proc/self/fd/255&#39;: No such file or directory
ls: cannot access &#39;/proc/self/fd/3&#39;: No such file or directory
lrwx------ 1 vagrant wheel 64 Nov 13 22:37 /proc/self/fd/0 -&gt; /dev/pts/0
lrwx------ 1 vagrant wheel 64 Nov 13 22:37 /proc/self/fd/1 -&gt; /dev/pts/0
lrwx------ 1 vagrant wheel 64 Nov 13 22:37 /proc/self/fd/2 -&gt; /dev/pts/0
</code></pre></div> <p>Linux进程默认会打开的三个文件：</p> <ul> <li>标准输入<code>/dev/stdin</code>，描述符为 0，默认是键盘输入。</li> <li>标准输出<code>/dev/stdout</code>，描述符为 1，默认是输出到屏幕。</li> <li>标准输出<code>/dev/stderr</code>，描述符为 2，默认是输出到屏幕。</li> </ul> <p>以Rocky为例，创建<code>file.py</code>文件。</p> <div class=highlight><pre><span></span><code>$ cat &gt; file.py &lt;&lt;EOF
import time
f = open(&#39;test.txt&#39;, &#39;r&#39;)
time.sleep(1000)
EOF
</code></pre></div> <p>创建<code>test.txt</code>文件。</p> <div class=highlight><pre><span></span><code>$ echo &quot;hello&quot; &gt; test.txt
</code></pre></div> <p>运行<code>file.py</code>程序。</p> <div class=highlight><pre><span></span><code>$ python3 file.py
</code></pre></div> <p>打开新的终端窗口，执行下面命令，得到python3这个程序运行的process ID。其中可以看到有一个来自文件test.txt被程序file.py打开（输入）。</p> <div class=highlight><pre><span></span><code>$ pidof python3
1739 788

$ sudo ls -l /proc/788/fd/
lr-x------. 1 root root 64 Nov 13 23:00 0 -&gt; /dev/null
l-wx------. 1 root root 64 Nov 13 23:00 1 -&gt; /dev/null
lrwx------. 1 root root 64 Nov 13 23:00 10 -&gt; &#39;socket:[24677]&#39;
lrwx------. 1 root root 64 Nov 13 23:00 11 -&gt; &#39;socket:[24678]&#39;
l-wx------. 1 root root 64 Nov 13 23:00 2 -&gt; /dev/null
l-wx------. 1 root root 64 Nov 13 10:41 3 -&gt; /var/log/firewalld
lrwx------. 1 root root 64 Nov 13 23:00 4 -&gt; &#39;socket:[23421]&#39;
lrwx------. 1 root root 64 Nov 13 23:00 5 -&gt; &#39;anon_inode:[eventfd]&#39;
lrwx------. 1 root root 64 Nov 13 23:00 6 -&gt; &#39;socket:[24586]&#39;
lr-x------. 1 root root 64 Nov 13 23:00 7 -&gt; anon_inode:inotify
lrwx------. 1 root root 64 Nov 13 23:00 8 -&gt; &#39;anon_inode:[eventfd]&#39;
lrwx------. 1 root root 64 Nov 13 23:00 9 -&gt; &#39;/memfd:libffi (deleted)&#39;

$ sudo ls -l /proc/1739/fd/
lrwx------. 1 vagrant wheel 64 Nov 13 23:00 0 -&gt; /dev/pts/0
lrwx------. 1 vagrant wheel 64 Nov 13 23:00 1 -&gt; /dev/pts/0
lrwx------. 1 vagrant wheel 64 Nov 13 23:00 2 -&gt; /dev/pts/0
lr-x------. 1 vagrant wheel 64 Nov 13 23:00 3 -&gt; /home/vagrant/test.txt
</code></pre></div> <p>在Ubuntu中运行<code>file.py</code>程序，pidof会取得3个process IDs。</p> <div class=highlight><pre><span></span><code>$ pidof python3
2128 924 873

$ sudo ls -l /proc/2128/fd/
lrwx------ 1 vagrant sudo 64 Nov 13 15:10 0 -&gt; /dev/pts/0
lrwx------ 1 vagrant sudo 64 Nov 13 15:10 1 -&gt; /dev/pts/0
lrwx------ 1 vagrant sudo 64 Nov 13 15:10 2 -&gt; /dev/pts/0
lr-x------ 1 vagrant sudo 64 Nov 13 15:10 3 -&gt; /home/vagrant/test.txt

$ sudo ls -l /proc/924/fd/
lr-x------ 1 root root 64 Nov 13 15:11 0 -&gt; /dev/null
lrwx------ 1 root root 64 Nov 13 15:11 1 -&gt; &#39;socket:[31593]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 2 -&gt; &#39;socket:[31593]&#39;
l-wx------ 1 root root 64 Nov 13 02:40 3 -&gt; /var/log/unattended-upgrades/unattended-upgrades-shutdown.log
lrwx------ 1 root root 64 Nov 13 15:11 4 -&gt; &#39;socket:[31652]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 5 -&gt; &#39;anon_inode:[eventfd]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 6 -&gt; &#39;anon_inode:[eventfd]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 7 -&gt; &#39;socket:[31657]&#39;
l-wx------ 1 root root 64 Nov 13 15:11 8 -&gt; /run/systemd/inhibit/1.ref
lrwx------ 1 root root 64 Nov 13 15:11 9 -&gt; &#39;socket:[31658]&#39;

$ sudo ls -l /proc/873/fd/
lr-x------ 1 root root 64 Nov 13 15:11 0 -&gt; /dev/null
lrwx------ 1 root root 64 Nov 13 15:11 1 -&gt; &#39;socket:[31412]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 2 -&gt; &#39;socket:[31412]&#39;
lrwx------ 1 root root 64 Nov 13 02:40 3 -&gt; &#39;socket:[31650]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 4 -&gt; &#39;anon_inode:[eventfd]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 5 -&gt; &#39;socket:[31663]&#39;
lrwx------ 1 root root 64 Nov 13 15:11 6 -&gt; &#39;socket:[31664]&#39;
</code></pre></div> <p>openSUSE需要安装包<code>sysvinit-tools</code>才能使用<code>pidof</code>命令。</p> <div class=highlight><pre><span></span><code>$ sudo zypper in sysvinit-tools
</code></pre></div> <p>由于openSUSE中pidof python3只返回一个process ID，所以可以简化命令行得到process ID的详细信息。</p> <div class=highlight><pre><span></span><code>$ sudo ls -l /proc/`pidof python3`/fd/
lrwx------ 1 vagrant wheel 64 Nov 13 23:21 0 -&gt; /dev/pts/0
lrwx------ 1 vagrant wheel 64 Nov 13 23:21 1 -&gt; /dev/pts/0
lrwx------ 1 vagrant wheel 64 Nov 13 23:21 2 -&gt; /dev/pts/0
lr-x------ 1 vagrant wheel 64 Nov 13 23:21 3 -&gt; /home/vagrant/test.txt
</code></pre></div> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p>当键盘和鼠标等设备通过串口直接连接到计算机时，这种连接称为TTY。 伪终端pseudoterminal（缩写为“pty”）是一对提供双向通信通道的虚拟字符设备。 通道的一端称为主端master； 另一端称为从端slave。 </p> <p><code>/dev/pts</code>表示与伪终端pseudoterminal的主端master或从端slave相关的master文件，操作系统将其保存为<code>/dev/ptmx</code>文件。 <code>telnet</code>和<code>ssh</code>等程序能够仿真终端，用户与它们的交互，虽然本质上是与文件<code>/dev/ptmx</code>进行交互，但呈现给用户的却是好像运行在真正的终端窗口一样，从端的文件是主端的输入。</p> <p>伪终端进程在Linux中被存储在<code>/dev/pts/</code>目录下。<code>/dev/pts/</code>目录下的内容是一些特殊的目录，由Linux内核所创建。</p> <p>每个唯一的终端窗口都与<code>/dev/pts</code>系统中的一个Linux<code>pts</code>条目相关。</p> <p>下面返回的结果说明有2个远程终端连接到当前的机器。 <div class=highlight><pre><span></span><code>$ ll /dev/pts/
crw--w----. 1 vagrant tty  136, 0 Nov 13 23:18 0
crw--w----. 1 vagrant tty  136, 1 Nov 13 23:48 1
c---------. 1 root    root   5, 2 Nov 13 10:41 ptmx
</code></pre></div></p> <p>也可以通过<code>w</code>命令看到2个终端进程。 <div class=highlight><pre><span></span><code>$ w
 23:55:05 up 13:14,  2 users,  load average: 0.00, 0.00, 0.00
USER     TTY        LOGIN@   IDLE   JCPU   PCPU WHAT
vagrant  pts/0     10:51   37:03   0.05s  0.05s -bash
vagrant  pts/1     23:48    0.00s  0.03s  0.00s w
</code></pre></div></p> <p>单个伪终端pseudoterminal可以同时接收来自不同的程序的输出。 多个程序同时对一个伪终端pseudoterminal进行读取会引起混淆。</p> <p>存储在<code>/dev/pts</code>目录中的文件是抽象文件而不是真实文件，是伪终端中执行程序时临时存储的数据。 打开<code>/dev/pts</code>下的文件通常没有什么实际意义。</p> </div> <h2 id=_21>重定向和管道<a class=headerlink href=#_21 title="Permanent link"> ¶</a></h2> <h3 id=_22>输入重定向<a class=headerlink href=#_22 title="Permanent link"> ¶</a></h3> <p>常用命令格式：</p> <ul> <li><code>command &lt; file</code>：将指定文件<code>file</code>作为命令的输入设备。</li> <li><code>command &lt;&lt; delimiter</code>：表示从标准输入设备（键盘）中读入，直到遇到分界符<code>delimiter</code>停止（读入的数据不包括分界符），这里的分界符可以理解为自定义的字符串。</li> <li><code>command &lt; file1 &gt; file2</code>：将<code>file1</code>作为命令的输入设备，该命令的执行结果输出到<code>file2</code>中。</li> </ul> <div class=highlight><pre><span></span><code># 输出文件file.py内容（输入设备是键盘）
$ cat file.py

# 输出文件file.py内容（输入设备是文件file.py）
$ cat &lt; file.py

# 指定分界符（这里是EOF），读取键盘输入内容，直到遇到指定分界符为止，将所读取的内容输出到文件file.py。
$ cat &gt; file.py &lt;&lt;EOF
import time
f = open(&#39;test.txt&#39;, &#39;r&#39;)
time.sleep(1000)
EOF

# 读取文件file.py内容，输出到新文件new.py。
$ cat &lt; file.py &gt; new.py
</code></pre></div> <h3 id=_23>输出重定向<a class=headerlink href=#_23 title="Permanent link"> ¶</a></h3> <p>输出重定向分为标准输出重定向和错误输出重定向两种。</p> <p>常用命令格式：</p> <ul> <li><code>command &gt; file</code>：将命令<code>command</code>执行的标准输出结果重定向输出到指定的文件<code>file</code>中，如果该文件已包含数据，会清空原有数据，再写入新数据。</li> <li><code>command 2&gt; file</code>：将命令<code>command</code>执行的错误输出结果重定向到指定的文件<code>file</code>中，如果该文件中已包含数据，会清空原有数据，再写入新数据。</li> <li><code>command &gt;&gt; file</code>：将命令<code>command</code>执行的标准输出结果重定向输出到指定的文件<code>file</code>中，如果该文件已包含数据，新数据将追加写入到原有内容的后面。</li> <li><code>command 2&gt;&gt; file</code>：将命令<code>command</code>执行的错误输出结果重定向到指定的文件<code>file</code>中，如果该文件中已包含数据，新数据将追加写入到原有内容的后面。</li> <li><code>command &gt;&gt; file 2&gt;&amp;1</code> 或者 <code>command &amp;&gt;&gt; file</code>：将标准输出或者错误输出写入到指定文件<code>file</code>中，如果该文件中已包含数据，新数据将追加写入到原有内容的后面。</li> </ul> <p>注意：上面的<code>file</code>可以是一个普通文件，也可以使用一个特殊的文件<code>/dev/null</code>。<code>/dev/null</code>并不保存数据，被写入<code>/dev/null</code>的数据最终都会丢失。</p> <p>举例：2个python文件存在，其他2个无扩展名的文件不存在。</p> <div class=highlight><pre><span></span><code>$ ls file.py &gt; out
$ ls file 2&gt; out.err

$ ls new.py &gt;&gt; out
$ ls new 2&gt;&gt; out.err
</code></pre></div> <p>可以得到预期的结果。两个错误记录都被追加到<code>out.err</code>文件中。两个成功执行的命令的返回结果也输出到<code>out</code>文件中。</p> <div class=highlight><pre><span></span><code>$ccat out
file.py
new.py

$ cat out.err
ls: cannot access &#39;file&#39;: No such file or directory
ls: cannot access &#39;new&#39;: No such file or directory
</code></pre></div> <p>上例命令也可以合并。</p> <div class=highlight><pre><span></span><code>$ ls file.py &gt; out 2&gt; out.err
$ ls file &gt;&gt; out 2&gt;&gt; out.err
</code></pre></div> <p><code>2&gt;&amp;1</code>格式举例：</p> <div class=highlight><pre><span></span><code>$ ls file &gt;&gt; out.txt 2&gt;&amp;1
$ cat out.txt
ls: cannot access &#39;file&#39;: No such file or directory

$ ls file.py &amp;&gt;&gt; out.txt
$ cat out.txt
ls: cannot access &#39;file&#39;: No such file or directory
file.py
</code></pre></div> <h3 id=_24>特殊重定向<a class=headerlink href=#_24 title="Permanent link"> ¶</a></h3> <p>格式：<code>command1 &lt; &lt;(command2)</code></p> <div class=highlight><pre><span></span><code>tr &#39;a-z&#39; &#39;A-Z&#39; &lt; &lt;(echo &quot;Hello World&quot;)
</code></pre></div> <p>应用：修改密码</p> <p>密码保存在<code>passwd.txt</code>文件中，并严格限制改文件的权限。 通过参数<code>--stdin</code>实现模拟键盘输入操作输入用户名。</p> <p>在Rocky中可以使用<code>--stdin</code>参数。</p> <div class=highlight><pre><span></span><code>$ passwd --stdin vagrant &lt; passwd.txt
</code></pre></div> <p>在openSUSE和Ubuntu中，<code>--stdin</code>参数无法识别。可以改用下面的方法。</p> <div class=highlight><pre><span></span><code>$ echo passwd.txt | chpasswd
</code></pre></div> <p>其中passwd.txt的格式为<code>username:password</code>。</p> <div class="admonition reference"> <p class=admonition-title>Reference</p> <p>Here-document(Here-doc)：输入的文本块重定向至标准输入流，直至遇到特殊的文件结束标记符为止（文件结束标记符可以是任意的唯一的字符串，但大部分人都默认使用 <code>EOF</code>）。</p> <p><div class=highlight><pre><span></span><code>cat &lt;&lt;EOF
This is line1
Another line
Finally 3rd line
EOF
</code></pre></div> 文本块中含有tab键。 <div class=highlight><pre><span></span><code>cat &lt;&lt;-EOF
    This message is indented
        This message is double indented
EOF
</code></pre></div></p> <p>文本块中含有参数。 <div class=highlight><pre><span></span><code>cat &lt;&lt;EOF
Hello ${USER}
EOF
</code></pre></div></p> <p>文本块中含有命令。 <div class=highlight><pre><span></span><code>cat &lt;&lt;EOF
Hello! It is currently: $(date)
EOF
</code></pre></div></p> <p>Here-string：与<code>Here-doc</code>相似，但是它只有一个字符串，或者几个被引号括起来的字符串。</p> <p>基本用法。 <div class=highlight><pre><span></span><code>cat &lt;&lt;&lt; &quot;This is a string&quot;
</code></pre></div> 使用变量。 <div class=highlight><pre><span></span><code>WELCOME_MESSAGE=&quot;Welcome!&quot;
cat &lt;&lt;&lt; $WELCOME_MESSAGE
</code></pre></div> 使用参数。 <div class=highlight><pre><span></span><code>cat &lt;&lt;&lt; &quot;Welcome! ${USER}&quot;
</code></pre></div></p> </div> <h2 id=_25>管道<a class=headerlink href=#_25 title="Permanent link"> ¶</a></h2> <p>Linux中使用竖线<code>|</code>连接多个命令，这被称为管道符。</p> <p>当在两个命令之间设置管道时，管道符<code>|</code>左边命令的输出就变成了右边命令的输入。管道符<code>|</code>左边正确的输出才能被右边处理，管道符<code>|</code>右边不能处理左边错误的输出。</p> <p>重定向和管道的区别：重定向操作符<code>&gt;</code>将命令与文件连接起来，用文件来接收命令的输出；而管道符<code>|</code>将命令与命令连接起来，用右边命令来接收左边命令的输出。</p> <div class=highlight><pre><span></span><code>$ ls | tr &#39;a-z&#39; &#39;A-Z&#39;
BIN
F1.TXT
F2.TXT
FILE.PY
NEW.PY
OUT
OUT.ERR
TEST.TXT
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../01-fundamentals/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Linux Fundamentals" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Linux Fundamentals </div> </div> </a> <a href=../03-identity-security/ class="md-footer__link md-footer__link--next" aria-label="Next: Identity & Security" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Identity & Security </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>