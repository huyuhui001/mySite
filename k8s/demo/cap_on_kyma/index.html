<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/k8s/demo/cap_on_kyma/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>Build CAP application on Kyma - UPSkilling</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#build-cap-application-on-kyma class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=UPSkilling class="md-header__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> UPSkilling </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Build CAP application on Kyma </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> UPSkilling </a> </li> <li class=md-tabs__item> <a href=../../../linux/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../python/ class=md-tabs__link> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=UPSkilling class="md-nav__button md-logo" aria-label=UPSkilling data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> UPSkilling </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> UPSkilling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=UPSkilling data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> UPSkilling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Welcome </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/SRE/01-fundamentals/ class=md-nav__link> Linux Fundamentals </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/02-filesystem/ class=md-nav__link> File System </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/03-identity-security/ class=md-nav__link> Identity & Security </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/04-TextTools/ class=md-nav__link> Text Tools </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/05-RegExpress/ class=md-nav__link> Regular Expression </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/06-FileLookup/ class=md-nav__link> File Lookup </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/07-FilePacking/ class=md-nav__link> FIle Packing & Unpacking </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_5 type=checkbox id=__nav_3_5> <label class=md-nav__link for=__nav_3_5> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_5> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_6 type=checkbox id=__nav_3_6> <label class=md-nav__link for=__nav_3_6> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=2> <label class=md-nav__title for=__nav_3_6> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_7 type=checkbox id=__nav_3_7> <label class=md-nav__link for=__nav_3_7> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_7> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_8 type=checkbox id=__nav_3_8> <label class=md-nav__link for=__nav_3_8> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_3_8> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_9 type=checkbox id=__nav_3_9> <label class=md-nav__link for=__nav_3_9> Case Study <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Case Study" data-md-level=2> <label class=md-nav__title for=__nav_3_9> <span class="md-nav__icon md-icon"></span> Case Study </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_10 type=checkbox id=__nav_3_10 checked> <label class=md-nav__link for=__nav_3_10> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_10> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Build CAP application on Kyma <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Build CAP application on Kyma </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sap-btp-subaccount-configuration class=md-nav__link> SAP BTP subaccount configuration </a> </li> <li class=md-nav__item> <a href=#set-up-local-btp-environment class=md-nav__link> Set up local BTP environment </a> </li> <li class=md-nav__item> <a href=#install-homebrew class=md-nav__link> Install Homebrew </a> </li> <li class=md-nav__item> <a href=#install-kubetcl class=md-nav__link> Install kubetcl </a> </li> <li class=md-nav__item> <a href=#sap-kyma-runtime class=md-nav__link> SAP Kyma runtime </a> </li> <li class=md-nav__item> <a href=#install-nodejs class=md-nav__link> Install Node.js </a> </li> <li class=md-nav__item> <a href=#install-sqlite class=md-nav__link> Install SQLite </a> </li> <li class=md-nav__item> <a href=#install-xcode class=md-nav__link> Install Xcode </a> </li> <li class=md-nav__item> <a href=#install-git class=md-nav__link> Install Git </a> </li> <li class=md-nav__item> <a href=#install-sapui5 class=md-nav__link> Install SAPUI5 </a> </li> <li class=md-nav__item> <a href=#install-cf-cli class=md-nav__link> Install CF CLI </a> </li> <li class=md-nav__item> <a href=#install-cap-tooling class=md-nav__link> Install CAP Tooling </a> </li> <li class=md-nav__item> <a href=#install-vscode class=md-nav__link> Install VSCode </a> </li> <li class=md-nav__item> <a href=#install-yeoman class=md-nav__link> Install Yeoman </a> </li> <li class=md-nav__item> <a href=#install-docker class=md-nav__link> Install Docker </a> </li> <li class=md-nav__item> <a href=#install-helm class=md-nav__link> Install Helm </a> </li> <li class=md-nav__item> <a href=#install-paketopack class=md-nav__link> Install Paketo(pack) </a> </li> <li class=md-nav__item> <a href=#install-rancher-desktop class=md-nav__link> Install Rancher Desktop </a> </li> <li class=md-nav__item> <a href=#download-tutorial class=md-nav__link> Download tutorial </a> </li> <li class=md-nav__item> <a href=#initialize-the-project class=md-nav__link> Initialize the project </a> </li> <li class=md-nav__item> <a href=#add-files-to-the-project class=md-nav__link> Add files to the project </a> </li> <li class=md-nav__item> <a href=#prepare-kyma-development-environment class=md-nav__link> Prepare Kyma Development Environment </a> </li> <li class=md-nav__item> <a href=#set-up-sap-hana-cloud-for-kyma class=md-nav__link> Set Up SAP HANA Cloud for Kyma </a> </li> <li class=md-nav__item> <a href=#user-authentication-and-authorization-xsuaa-setup class=md-nav__link> User Authentication and Authorization (XSUAA) Setup </a> </li> <li class=md-nav__item> <a href=#add-helm-chart class=md-nav__link> Add Helm Chart </a> </li> <li class=md-nav__item> <a href=#deploy-cap-application-to-kyma class=md-nav__link> Deploy CAP Application to Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Foundation/ch00/ class=md-nav__link> 安装 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch01/ class=md-nav__link> 语言基础 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch02/ class=md-nav__link> 打包和拆包 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch03/ class=md-nav__link> 函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch04/ class=md-nav__link> 面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch05/ class=md-nav__link> 面向对象特性 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/Algorithms/ class=md-nav__link> 数据结构和算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#sap-btp-subaccount-configuration class=md-nav__link> SAP BTP subaccount configuration </a> </li> <li class=md-nav__item> <a href=#set-up-local-btp-environment class=md-nav__link> Set up local BTP environment </a> </li> <li class=md-nav__item> <a href=#install-homebrew class=md-nav__link> Install Homebrew </a> </li> <li class=md-nav__item> <a href=#install-kubetcl class=md-nav__link> Install kubetcl </a> </li> <li class=md-nav__item> <a href=#sap-kyma-runtime class=md-nav__link> SAP Kyma runtime </a> </li> <li class=md-nav__item> <a href=#install-nodejs class=md-nav__link> Install Node.js </a> </li> <li class=md-nav__item> <a href=#install-sqlite class=md-nav__link> Install SQLite </a> </li> <li class=md-nav__item> <a href=#install-xcode class=md-nav__link> Install Xcode </a> </li> <li class=md-nav__item> <a href=#install-git class=md-nav__link> Install Git </a> </li> <li class=md-nav__item> <a href=#install-sapui5 class=md-nav__link> Install SAPUI5 </a> </li> <li class=md-nav__item> <a href=#install-cf-cli class=md-nav__link> Install CF CLI </a> </li> <li class=md-nav__item> <a href=#install-cap-tooling class=md-nav__link> Install CAP Tooling </a> </li> <li class=md-nav__item> <a href=#install-vscode class=md-nav__link> Install VSCode </a> </li> <li class=md-nav__item> <a href=#install-yeoman class=md-nav__link> Install Yeoman </a> </li> <li class=md-nav__item> <a href=#install-docker class=md-nav__link> Install Docker </a> </li> <li class=md-nav__item> <a href=#install-helm class=md-nav__link> Install Helm </a> </li> <li class=md-nav__item> <a href=#install-paketopack class=md-nav__link> Install Paketo(pack) </a> </li> <li class=md-nav__item> <a href=#install-rancher-desktop class=md-nav__link> Install Rancher Desktop </a> </li> <li class=md-nav__item> <a href=#download-tutorial class=md-nav__link> Download tutorial </a> </li> <li class=md-nav__item> <a href=#initialize-the-project class=md-nav__link> Initialize the project </a> </li> <li class=md-nav__item> <a href=#add-files-to-the-project class=md-nav__link> Add files to the project </a> </li> <li class=md-nav__item> <a href=#prepare-kyma-development-environment class=md-nav__link> Prepare Kyma Development Environment </a> </li> <li class=md-nav__item> <a href=#set-up-sap-hana-cloud-for-kyma class=md-nav__link> Set Up SAP HANA Cloud for Kyma </a> </li> <li class=md-nav__item> <a href=#user-authentication-and-authorization-xsuaa-setup class=md-nav__link> User Authentication and Authorization (XSUAA) Setup </a> </li> <li class=md-nav__item> <a href=#add-helm-chart class=md-nav__link> Add Helm Chart </a> </li> <li class=md-nav__item> <a href=#deploy-cap-application-to-kyma class=md-nav__link> Deploy CAP Application to Kyma </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/k8s/demo/cap_on_kyma.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=build-cap-application-on-kyma>Build CAP Application on Kyma<a class=headerlink href=#build-cap-application-on-kyma title="Permanent link"> ¶</a></h1> <p>This is the memo of self-practice following the tutorials from <a href=https://developers.sap.com/mission.btp-deploy-cap-kyma.html>Deploy Your CAP Application on SAP BTP Kyma Runtime</a>.</p> <p>Prerequisites:</p> <ul> <li>Register account in <a href=https://developers.sap.com/ >Developer@SAP</a>.</li> <li>Register trial account in <a href=https://account.hanatrial.ondemand.com/ >SAP BTP</a>.</li> </ul> <p>Tasks:</p> <ul> <li>Configure Kyma in SAP Business Technology Platform (SAP BTP) subaccount and prepare Kyma development environment. </li> <li>Create an HDI container for an SAP HANA Cloud instance on Cloud Foundry and create credentials for this SAP HANA cloud instance in Kyma cluster. </li> <li>Develop a business application using SAP Cloud Application Programming Model (CAP). </li> <li>Start on local environment, enhance it with an SAP Fiori UI, add business logic to it, and also roles and authorization check. </li> <li>Add a Helm chart to the application, build docker images, push them to your container registry, and deploy your application to your Kyma cluster on SAP BTP.</li> </ul> <p>Local environment:</p> <ul> <li>Applel Silicon M1 chipset</li> <li>macOS 12.6 (command <code>sw_vers</code>)</li> <li>Nodejs version: </li> <li>CDS version: </li> <li>jq - for JSON processing in CLI (<code>brew install jq</code>)</li> </ul> <h2 id=sap-btp-subaccount-configuration>SAP BTP subaccount configuration<a class=headerlink href=#sap-btp-subaccount-configuration title="Permanent link"> ¶</a></h2> <p>For the SAP BTP free tier, the recommendation is as well to use an AWS-based subaccount. Kyma runtime in the free tier is only available on AWS. </p> <p>Choose the entitlements for the subdomain:</p> <ul> <li>Alert Notification: Standard plan</li> <li>Continuous Integration &amp; Delivery: default (Application) or the trial (Application) or free (Application) plans which are not charged</li> <li>Kyma runtime: any available plan in the list (trial and free are not charged)</li> <li>Launchpad Service: standard (Application) or free (Application)</li> <li>SAP HANA Cloud: hana</li> <li>SAP HANA Schemas &amp; HDI Containers: hdi-shared</li> </ul> <h2 id=set-up-local-btp-environment>Set up local BTP environment<a class=headerlink href=#set-up-local-btp-environment title="Permanent link"> ¶</a></h2> <p>Here we will use btp command to set up cloud environment. Details we can refer to help document <a href=https://help.sap.com/docs/BTP/65de2977205c403bbc107264b8eccf4b/48db1553eb18451e8f71fc56d99ede71.html>Working with Environments Using the btp CLI</a>.</p> <p>Download BTP CLI package <code>btp-cli-darwin-amd64-&lt;ver_num&gt;.tar.gz</code> via <a href=https://tools.hana.ondemand.com/#cloud>link</a> and unpackage it. <div class=highlight><pre><span></span><code>tar xvf btp-cli-darwin-amd64-&lt;ver_num&gt;.tar.gz
</code></pre></div></p> <p>A new subfolder <code>darwin-amd64</code> will be created in current path and a bin file <code>btp</code> is under the subfolder. Move file <code>btp</code> to folder <code>/usr/local/bin/</code>. <div class=highlight><pre><span></span><code>sudo mv ./darwin-amd64/btp /usr/local/bin/
</code></pre></div></p> <p>Log on to the subaccount on BTP. <div class=highlight><pre><span></span><code>btp login --url https://cpcli.cf.eu10.hana.ondemand.com --subdomain &lt;your_subdomain&gt; --user &lt;your_registered_email_address&gt;
</code></pre></div></p> <p>Configuration file was stored at <code>/Users/$USER/Library/Application Support/.btp/config.json</code>. In Linux, the configuration file is on <code>/home/$USER/.config/.btp/config.json</code>. We can get current user via command <code>echo $USER</code>.</p> <div class="admonition tips"> <p class=admonition-title>Tips</p> <p>Commands are executed in the target, unless specified otherwise using a parameter. To change the target, use <code>btp target</code>. For an explanation of the targeting mechanism, use <code>btp help target</code>.</p> </div> <p>Get the subaccount ID in BTP and we will know that kyma and cloundfoundry are available in current trial account. <div class=highlight><pre><span></span><code>btp list accounts/available-environment --subaccount &lt;your_subaccount_id&gt;
</code></pre></div></p> <p>Get details about an environment available for a subaccount <div class=highlight><pre><span></span><code>btp get accounts/available-environment --subaccount &lt;your_subaccount_id&gt; --environment cloudfoundry --service cloudfoundry --plan standard
btp get accounts/available-environment --subaccount &lt;your_subaccount_id&gt; --environment kyma --service kymaruntime --plan trial
</code></pre></div></p> <p>Get status running instances. Here we will also get environment ID of running instances. <div class=highlight><pre><span></span><code>btp list accounts/environment-instance --subaccount &lt;your_subaccount_id&gt;
</code></pre></div></p> <p>Delete a running instance if needed. <div class=highlight><pre><span></span><code>btp delete accounts/environment-instance &lt;environment_ID&gt; --subaccount &lt;your_subaccount_id&gt;
</code></pre></div></p> <p>Create Kyma instance. <div class=highlight><pre><span></span><code>btp create accounts/environment-instance --subaccount &lt;your_subaccount_id&gt; --environment kyma --service kymaruntime --plan trial --parameters &#39;{&quot;name&quot;: &quot;&lt;your_kyma_instance_name&gt;&quot;}&#39;
btp get accounts/environment-instance &lt;environment_ID&gt; --subaccount &lt;your_subaccount_id&gt;
</code></pre></div></p> <p>Create CloudFoundry instance <div class=highlight><pre><span></span><code>btp create accounts/environment-instance --subaccount &lt;your_subaccount_id&gt; --environment cloudfoundry --service cloudfoundry --plan standard --parameters &#39;{&quot;instance_name&quot;: &quot;&lt;your_cf_instance_name&gt;&quot;}&#39;
btp get accounts/environment-instance &lt;environment_ID&gt; --subaccount &lt;your_subaccount_id&gt;
</code></pre></div></p> <p>Log onto CF to create space <code>DEV</code> by providing API endpoint, Email and Password, which are ready in the subaccount overview page. <div class=highlight><pre><span></span><code>cf login
cf create-space DEV
</code></pre></div></p> <h2 id=install-homebrew>Install Homebrew<a class=headerlink href=#install-homebrew title="Permanent link"> ¶</a></h2> <p>Refer to <a href="http://mirrors.ustc.edu.cn/help/brew.git.html?highlight=brew">installation guide</a>.</p> <p>Set environment variables <div class=highlight><pre><span></span><code>export HOMEBREW_BREW_GIT_REMOTE=&quot;https://mirrors.ustc.edu.cn/brew.git&quot;
export HOMEBREW_CORE_GIT_REMOTE=&quot;https://mirrors.ustc.edu.cn/homebrew-core.git&quot;
export HOMEBREW_BOTTLE_DOMAIN=&quot;https://mirrors.ustc.edu.cn/homebrew-bottles&quot;
</code></pre></div></p> <p>Install Homebrew <div class=highlight><pre><span></span><code>/bin/bash -c &quot;$(curl -fsSL https://github.com/Homebrew/install/raw/HEAD/install.sh)&quot;
</code></pre></div></p> <p>Add below in file <code>~/.zprofile</code>. <div class=highlight><pre><span></span><code>export HOMEBREW_BREW_GIT_REMOTE=&quot;https://mirrors.ustc.edu.cn/brew.git&quot;
export HOMEBREW_CORE_GIT_REMOTE=&quot;https://mirrors.ustc.edu.cn/homebrew-core.git&quot;
export HOMEBREW_BOTTLE_DOMAIN=&quot;https://mirrors.ustc.edu.cn/homebrew-bottles&quot;
eval &quot;$(/opt/homebrew/bin/brew shellenv)&quot;
</code></pre></div></p> <p>Make it effected. <div class=highlight><pre><span></span><code>source ~/.zprofile
</code></pre></div></p> <h2 id=install-kubetcl>Install kubetcl<a class=headerlink href=#install-kubetcl title="Permanent link"> ¶</a></h2> <p>The <code>kubectl</code> <a href=https://kubernetes.io/docs/tasks/tools/#kubectl>installation guide</a> <div class=highlight><pre><span></span><code>curl -LO &quot;https://dl.k8s.io/release/$(curl -L -s https://dl.k8s.io/release/stable.txt)/bin/darwin/arm64/kubectl&quot;
chmod +x ./kubectl
sudo mv ./kubectl /usr/local/bin/kubectl
sudo chown root: /usr/local/bin/kubectl
kubectl version --client
</code></pre></div></p> <p>Install plugin <a href=https://github.com/int128/kubelogin#setup>oidc-login</a>. <div class=highlight><pre><span></span><code>curl -fsSLO https://github.com/kubernetes-sigs/krew/releases/latest/download/krew-darwin_arm64.tar.gz
tar xvf krew-darwin_arm64.tar.gz
./krew-darwin_arm64 install krew
</code></pre></div> Add the <code>$HOME/.krew/bin</code> directory to the <code>PATH</code> environment variable by updating <code>~/.zprofile</code>. <div class=highlight><pre><span></span><code>export PATH=$HOME/.krew/bin:$PATH:$PATH
</code></pre></div> Make it effected <div class=highlight><pre><span></span><code>source ~/.zprofile
</code></pre></div></p> <p>Run <code>kubectl krew</code> to check the installation.</p> <p>Install/uninstall plugin <code>oidc-login</code>. <div class=highlight><pre><span></span><code>kubectl krew install oidc-login
kubectl krew uninstall oidc-login
</code></pre></div></p> <h2 id=sap-kyma-runtime>SAP Kyma runtime<a class=headerlink href=#sap-kyma-runtime title="Permanent link"> ¶</a></h2> <p>In the Overview area of your subaccount open the Link to dashboard link which appears next to the Console URL under the Kyma Environment area. At the top left of the window choose the Clusters Overview drop down and choose your cluster. In the Clusters Overview window choose the Download Kubeconfig for your Kyma runtime to download your KUBECONFIG.</p> <p>Add below to <code>~/.zprofile</code> to set the kubeconfig to an environment variable. <div class=highlight><pre><span></span><code>export KUBECONFIG=&lt;your_full_path_of_kubeconfig_file&gt;
</code></pre></div> Make above change effected. <div class=highlight><pre><span></span><code>source ~/.zprofile
</code></pre></div> <div class=highlight><pre><span></span><code>chmod 600 &lt;your_full_path_of_kubeconfig_file&gt;
</code></pre></div></p> <p>Test connection between kubectl and Kyma on BTP. <div class=highlight><pre><span></span><code>kubectl cluster-info
</code></pre></div></p> <h2 id=install-nodejs>Install Node.js<a class=headerlink href=#install-nodejs title="Permanent link"> ¶</a></h2> <p>Refer to <a href=https://nodejs.org/en/download/package-manager/ >installation guide</a> <div class=highlight><pre><span></span><code>brew search node
brew install node@16
brew unlink node
brew link node@16
node -v
</code></pre></div></p> <h2 id=install-sqlite>Install SQLite<a class=headerlink href=#install-sqlite title="Permanent link"> ¶</a></h2> <p>Install SQLite via <code>brew</code>. <div class=highlight><pre><span></span><code>brew search sqlite
brew install sqlite
</code></pre></div> Add below to <code>~/.zprofile</code> <div class=highlight><pre><span></span><code>export PATH=/opt/homebrew/opt/sqlite/bin:$PATH
</code></pre></div> Make it effected <div class=highlight><pre><span></span><code>source ~/.zprofile
</code></pre></div></p> <h2 id=install-xcode>Install Xcode<a class=headerlink href=#install-xcode title="Permanent link"> ¶</a></h2> <p>(For macOS) We have to install Command-Line Tools for <a href=https://developer.apple.com/xcode/ >Xcode</a>, cause some node modules need binary modules (node-gyp). <div class=highlight><pre><span></span><code>xcode-select --install
xcode-select --help
</code></pre></div></p> <h2 id=install-git>Install Git<a class=headerlink href=#install-git title="Permanent link"> ¶</a></h2> <p>Refer to <a href=https://git-scm.com/downloads>installation guide</a>. <div class=highlight><pre><span></span><code>brew install git
git version
</code></pre></div></p> <h2 id=install-sapui5>Install SAPUI5<a class=headerlink href=#install-sapui5 title="Permanent link"> ¶</a></h2> <p>Install the UI5 CLI. <div class=highlight><pre><span></span><code>npm search --global @ui5/cli
npm install --global @ui5/cli
npm list --global @ui5/cli
ui5 --version
</code></pre></div></p> <div class=highlight><pre><span></span><code>npm search --global grunt-cli
npm install --global grunt-cli
npm list --global grunt-cli
</code></pre></div> <h2 id=install-cf-cli>Install CF CLI<a class=headerlink href=#install-cf-cli title="Permanent link"> ¶</a></h2> <p>Refer to <a href=https://github.com/cloudfoundry/cli#installers-and-compressed-binaries>installation guide</a>. <div class=highlight><pre><span></span><code>brew install cloudfoundry/tap/cf-cli@8
cf --version
</code></pre></div></p> <h2 id=install-cap-tooling>Install CAP Tooling<a class=headerlink href=#install-cap-tooling title="Permanent link"> ¶</a></h2> <p>See the details in the <a href=https://cap.cloud.sap/docs/get-started/in-a-nutshell>CAP documentation</a>. <div class=highlight><pre><span></span><code>npm search --global @sap/cds-dk
npm install --global @sap/cds-dk
npm list --global @sap/cds-dk
cds --version
</code></pre></div></p> <h2 id=install-vscode>Install VSCode<a class=headerlink href=#install-vscode title="Permanent link"> ¶</a></h2> <p>In VS Code, invoke the Command Palette ( View → Command Palette or ⇧⌘P) and type <code>shell command</code> to find the Shell Command: <code>Install 'code' command in PATH</code>.</p> <p>Install <code>SAP CDS Language Support</code> extension.</p> <p>Install <code>SAP Fiori tools - Extension Pack</code> extension.</p> <h2 id=install-yeoman>Install Yeoman<a class=headerlink href=#install-yeoman title="Permanent link"> ¶</a></h2> <p><a href=https://yeoman.io/ >Yeoman</a> is a tool for scaffolding web apps. You’ll need it if you want to carry out the tutorial Add the SAP Launchpad Service. <div class=highlight><pre><span></span><code>npm install --global yo
yo --version
</code></pre></div></p> <h2 id=install-docker>Install Docker<a class=headerlink href=#install-docker title="Permanent link"> ¶</a></h2> <div class=highlight><pre><span></span><code>brew install docker --cask
</code></pre></div> <h2 id=install-helm>Install Helm<a class=headerlink href=#install-helm title="Permanent link"> ¶</a></h2> <p>Refer to <a href=https://helm.sh/docs/intro/install/ >installation guide</a> <div class=highlight><pre><span></span><code>brew install helm
</code></pre></div></p> <h2 id=install-paketopack>Install Paketo(pack)<a class=headerlink href=#install-paketopack title="Permanent link"> ¶</a></h2> <p>Refer to <a href=https://buildpacks.io/docs/tools/pack/#install>installation guide</a>. <div class=highlight><pre><span></span><code>brew install buildpacks/tap/pack
</code></pre></div></p> <h2 id=install-rancher-desktop>Install Rancher Desktop<a class=headerlink href=#install-rancher-desktop title="Permanent link"> ¶</a></h2> <p>Download the Rancher Desktop installer for macOS from the <a href=https://github.com/rancher-sandbox/rancher-desktop/releases>release page</a>. Refer to <a href=https://docs.rancherdesktop.io/getting-started/installation/#macos>installation guide</a>.</p> <h2 id=download-tutorial>Download tutorial<a class=headerlink href=#download-tutorial title="Permanent link"> ¶</a></h2> <p>Go to tutorial root directory and clone the code. <div class=highlight><pre><span></span><code>git clone https://github.com/SAP-samples/cloud-cap-risk-management tutorial
</code></pre></div></p> <h2 id=initialize-the-project>Initialize the project<a class=headerlink href=#initialize-the-project title="Permanent link"> ¶</a></h2> <p>Install required Node.js modules in the app directory <code>cpapp</code>. <div class=highlight><pre><span></span><code>cd app
cds init
npm install
cds watch
</code></pre></div></p> <h2 id=add-files-to-the-project>Add files to the project<a class=headerlink href=#add-files-to-the-project title="Permanent link"> ¶</a></h2> <p>Copy the file <code>schema.cds</code> from <code>templates/create-cap-application/db</code> to the <code>db</code> folder of the app. It creates two entities in the namespace <code>sap.ui.riskmanagement</code>: <code>Risks</code> and <code>Mitigations</code>. </p> <p>Copy the file <code>risk-service.cds</code> from <code>templates/create-cap-application/srv</code> to the <code>srv</code> folder of the app. It creates a new service <code>RiskService</code> in the namespace <code>sap.ui.riskmanagement</code>. This service exposes two entities: <code>Risks</code> and <code>Mitigations</code>, which are exposing the entities of the database schema we've created in the step before.</p> <p>Copy the folder <code>data</code> from <code>templates/create-cap-application/db</code> to the <code>db</code> folder of the app. There are two comma-separated value (CSV) files that contain local data for both the <code>Risks</code> and the <code>Mitigations</code> entities. </p> <p>Use Fiori Application Generator (VSCode extension) to generate <code>Risk</code> UI with Fiori element template. The generation will create a <code>risks</code> and a <code>webapp</code> folder with a <code>Component.js</code> file in the <code>app</code> folder of the project.</p> <p>Copy the file <code>risks-service-ui.cds</code> from <code>templates/create-ui-fiori-elements/srv</code> to the <code>srv</code> folder of the app. It defines annotations to show a work list with some columns and the data from the service in the <code>Risk</code> UI.</p> <p>Edit <code>app/risks/webapp/manifest.json</code> file to make the header fields editable, that is, shows <code>title</code> and <code>description</code> in <code>Risk</code> UI.</p> <p>Copy the file <code>risk-service.js</code> from <code>templates/cap-business-logic/srv</code>to the <code>srv</code> folder of the app. It now shows the work list in <code>Risk</code> UI with the columns <code>Priority</code> and <code>Impact</code> with color and an icon, depending on the amount in <code>Impact</code>.</p> <p>Use Fiori Application Generator (VSCode extension) to generate <code>Migration</code> UI with Fiori free-style template. The generation will create a <code>migrations</code> and a <code>webapp</code> folder with a <code>Component.js</code> file in the <code>app</code> folder of the project.</p> <p>Update file <code>cpapp/app/mitigations/webapp/view/Worklist.view.xml</code> to show <code>Description</code>, <code>Owner</code>, and <code>Timeline</code> columns, as well as in detail object page.</p> <p>Till now, our <code>risks</code> and <code>mitigations</code> application have been generated by the SAP Fiori Tools Generator and can be started independently. They are launched without a launch page. </p> <p>Copy the file <code>launchpage.html</code> from <code>templates/launchpage/app</code> to the <code>app</code> folder of the app. There are two applications in the launch page with URLs that point to the respective apps. We now see the <code>Mitigations</code> app next to the <code>Risks</code> app on the launch page.</p> <p>Open the file <code>srv/risk-service.cds</code> and add role restrictions to entities.</p> <p>Copy the file <code>templates/cap-roles/.cdsrc.json</code> to the project directory <code>cpapp</code>. The file defines two users <code>risk.viewer@tester.sap.com</code> and <code>risk.manager@tester.sap.com</code>. The default password can be found in the file <code>.cdsrc.json</code>.</p> <p>We will see the CAP server to show above applications via link http://localhost:4004.</p> <h2 id=prepare-kyma-development-environment>Prepare Kyma Development Environment<a class=headerlink href=#prepare-kyma-development-environment title="Permanent link"> ¶</a></h2> <p>Execute <code>cds version</code> to make sure the <code>package.json</code> is using <code>@sap/cds 6.0.1</code> or newer and we have <code>@sap/cds-dk 6.0.1</code> or newer globally installed.</p> <p>Create namespace on Kyma. <div class=highlight><pre><span></span><code>kubectl create namespace risk-management
</code></pre></div></p> <p>Switch to the namespace. <div class=highlight><pre><span></span><code>kubectl config set-context --current --namespace risk-management
</code></pre></div></p> <p>Create container registry secret.</p> <p>Copy the folder <code>scripts</code> from <code>templates/Kyma-Prepare-Dev-Environment</code> to the project root folder <code>cpapp</code>.</p> <p>In the root folder <code>cpapp</code> of the project, run the script to create the secret. <div class=highlight><pre><span></span><code>./scripts/create-container-registry-secret.sh
</code></pre></div></p> <p>Need provide below input: <div class=highlight><pre><span></span><code>docker-server=https://registry-1.docker.io
docker-username=&lt;your_registered_docker_username&gt;
docker-email=&lt;your_registered_docker_email&gt;
docker-password=&lt;your_api_token&gt;
</code></pre></div></p> <p>Verify <div class=highlight><pre><span></span><code>kubectl get secret
</code></pre></div></p> <h2 id=set-up-sap-hana-cloud-for-kyma>Set Up SAP HANA Cloud for Kyma<a class=headerlink href=#set-up-sap-hana-cloud-for-kyma title="Permanent link"> ¶</a></h2> <p>Add SAP HANA support to your project. This adds the <code>db</code> module for SAP HANA access to the <code>package.json</code> file. Execute the command below in the project root directory <code>cpapp</code>. <div class=highlight><pre><span></span><code>cds add hana --for production
</code></pre></div></p> <p>Verify the access to both CF and Kyma by executing below commands. <div class=highlight><pre><span></span><code>cf login
</code></pre></div> <div class=highlight><pre><span></span><code>kubectl cluster-info
</code></pre></div></p> <p>Create HANA Cloud instance <code>cpapp-db</code> in CloudFoundry <code>DEV</code> namespace. The admin user id is <code>DBADMIN</code>. </p> <p>In the root folder <code>cpapp</code> of the project, execute: <div class=highlight><pre><span></span><code>./scripts/create-db-secret.sh cpapp-db
</code></pre></div></p> <p>Get the host name pattern of the cluster with the following command. Result looks like <code>*.c-&lt;xyz123&gt;.sap.kyma.ondemand.com</code>. <div class=highlight><pre><span></span><code>kubectl get gateway -n kyma-system kyma-gateway -o jsonpath=&#39;{.spec.servers[0].hosts[0]}&#39;
</code></pre></div></p> <p>The script will:</p> <ul> <li>Create service key <code>cpapp-db-key</code> for HANA Cloud service instance <code>cpapp-db</code> as <code>&lt;your_btp_registered_email&gt;</code>.</li> <li>Create Kubernetes secret <code>cpapp-db</code> for HANA DB instance. View it using <code>kubectl get secret cpapp-db -o yaml</code>.</li> </ul> <h2 id=user-authentication-and-authorization-xsuaa-setup>User Authentication and Authorization (XSUAA) Setup<a class=headerlink href=#user-authentication-and-authorization-xsuaa-setup title="Permanent link"> ¶</a></h2> <p>Set up XSUAA. <div class=highlight><pre><span></span><code>cds add xsuaa --for production
</code></pre></div></p> <p>Above command will do:</p> <ul> <li>Adds the XSUAA service to the <code>package.json</code> file of the project</li> <li>Creates the XSUAA security configuration <code>xs-security.json</code> for the project</li> </ul> <h2 id=add-helm-chart>Add Helm Chart<a class=headerlink href=#add-helm-chart title="Permanent link"> ¶</a></h2> <p>Add Helm Chart. <div class=highlight><pre><span></span><code>cds add helm
</code></pre></div></p> <p>Get docker server URL by command: <div class=highlight><pre><span></span><code>cat ~/.docker/config.json
</code></pre></div></p> <p>Get the image pull secret for container registry. In the demo, it's <code>container-registry</code>. <div class=highlight><pre><span></span><code>kubectl get secret
</code></pre></div></p> <p>Get the host name pattern of the cluster. <div class=highlight><pre><span></span><code>kubectl get gateway -n kyma-system kyma-gateway -o jsonpath=&#39;{.spec.servers[0].hosts[0]}&#39;
</code></pre></div></p> <p>Open the file <code>chart/values.yaml</code>: </p> <ul> <li>Replace the placeholder <code>&lt;your-container-registry&gt;</code> with docker server URL <code>https://docker.io/</code>. </li> <li>Set <code>imagePullSecret</code> with value <code>name: container-registry</code>. </li> <li>Add host name of the cluster without leading <code>*.</code>.</li> <li>Add the binding <code>db</code> pointing to the SAP HANA Cloud instance secret <code>cpapp-db</code>.</li> <li>Point the binding <code>hana</code> of the SAP HANA Cloud instance secret <code>cpapp-db</code>.</li> <li>Add the Authorization and Trust Management service to allow user login.</li> </ul> <h2 id=deploy-cap-application-to-kyma>Deploy CAP Application to Kyma<a class=headerlink href=#deploy-cap-application-to-kyma title="Permanent link"> ¶</a></h2> <p>Build docker image. <div class=highlight><pre><span></span><code>CONTAINER_REGISTRY=https://index.docker.io/v1
CONTAINER_REGISTRY=https://registry-1.docker.io/yuhuihu
CONTAINER_REGISTRY=yuhuihu
</code></pre></div></p> <p>CAP build. <div class=highlight><pre><span></span><code>cds build --production
</code></pre></div></p> <p>Build CAP service. <div class=highlight><pre><span></span><code>pack build $CONTAINER_REGISTRY/cpapp-srv --path gen/srv \
 --buildpack gcr.io/paketo-buildpacks/nodejs \
 --builder paketobuildpacks/builder:base
</code></pre></div></p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../../foundamentals/kyma/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Kyma" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Kyma </div> </div> </a> <a href=../../../python/ class="md-footer__link md-footer__link--next" aria-label="Next: Index" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Index </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>