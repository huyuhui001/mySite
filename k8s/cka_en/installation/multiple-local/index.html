<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/k8s/cka_en/installation/multiple-local/ rel=canonical><link rel=icon href=../../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>Multiple Nodes Installation - 知行斋</title><link rel=stylesheet href=../../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../../extra.css><script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#multiple-nodes-installation class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title=知行斋 class="md-header__button md-logo" aria-label=知行斋 data-md-component=logo> <img src=../../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 知行斋 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Multiple Nodes Installation </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../.. class=md-tabs__link> Site </a> </li> <li class=md-tabs__item> <a href=../../../../linux/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../ class="md-tabs__link md-tabs__link--active"> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../../python/ class=md-tabs__link> Python </a> </li> <li class=md-tabs__item> <a href=../../../../Reading/Developers/ class=md-tabs__link> 读书有感 </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title=知行斋 class="md-nav__button md-logo" aria-label=知行斋 data-md-component=logo> <img src=../../../../assets/logo.jpg alt=logo> </a> 知行斋 </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Site <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Site data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Site </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../.. class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../linux/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../linux/SRE/01-fundamentals/ class=md-nav__link> 第一章 Linux基础 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/02-filesystem/ class=md-nav__link> 第二章 文件系统 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/03-identity-security/ class=md-nav__link> 第三章 身份与安全 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/04-TextTools/ class=md-nav__link> 第四章 文本编辑 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/05-RegExpress/ class=md-nav__link> 第五章 正则表达式 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/06-FileLookup/ class=md-nav__link> 第六章 文件查找 </a> </li> <li class=md-nav__item> <a href=../../../../linux/SRE/07-FilePacking/ class=md-nav__link> 第七章 文件打包和解包 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../linux/Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../../../linux/Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../../../linux/Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../linux/SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../../../linux/SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3 checked> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2 checked> <label class=md-nav__link for=__nav_3_2> CKA Learning Memo <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="CKA Learning Memo" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> CKA Learning Memo </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_1 type=checkbox id=__nav_3_2_1 checked> <label class=md-nav__link for=__nav_3_2_1> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=3> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Multiple Nodes Installation <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Multiple Nodes Installation </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#local-vm-setting class=md-nav__link> Local VM setting </a> </li> <li class=md-nav__item> <a href=#ubuntu-post-installation class=md-nav__link> Ubuntu Post Installation </a> </li> <li class=md-nav__item> <a href=#install-containerd class=md-nav__link> Install Containerd </a> </li> <li class=md-nav__item> <a href=#install-nerdctl class=md-nav__link> Install nerdctl </a> </li> <li class=md-nav__item> <a href=#install-kubernetes class=md-nav__link> Install Kubernetes </a> </li> <li class=md-nav__item> <a href=#setup-master-node class=md-nav__link> Setup Master Node </a> <nav class=md-nav aria-label="Setup Master Node"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubeadm-init class=md-nav__link> kubeadm init </a> </li> <li class=md-nav__item> <a href=#kubeconfig-file class=md-nav__link> kubeconfig file </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#install-calico class=md-nav__link> Install Calico </a> </li> <li class=md-nav__item> <a href=#setup-work-nodes class=md-nav__link> Setup Work Nodes </a> </li> <li class=md-nav__item> <a href=#check-cluster-status class=md-nav__link> Check Cluster Status </a> </li> <li class=md-nav__item> <a href=#post-installation class=md-nav__link> Post Installation </a> <nav class=md-nav aria-label="Post Installation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bash-autocomplete class=md-nav__link> Bash Autocomplete </a> </li> <li class=md-nav__item> <a href=#alias class=md-nav__link> Alias </a> </li> <li class=md-nav__item> <a href=#update-default-context class=md-nav__link> Update Default Context </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#install-helm class=md-nav__link> Install Helm </a> </li> <li class=md-nav__item> <a href=#reset-cluster class=md-nav__link> Reset cluster </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_2 type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=3> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_3 type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=3> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_4 type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_5 type=checkbox id=__nav_3_2_5> <label class=md-nav__link for=__nav_3_2_5> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=3> <label class=md-nav__title for=__nav_3_2_5> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_6 type=checkbox id=__nav_3_2_6> <label class=md-nav__link for=__nav_3_2_6> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_6> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_7 type=checkbox id=__nav_3_2_7> <label class=md-nav__link for=__nav_3_2_7> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_7> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_8 type=checkbox id=__nav_3_2_8> <label class=md-nav__link for=__nav_3_2_8> Topics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Topics data-md-level=3> <label class=md-nav__title for=__nav_3_2_8> <span class="md-nav__icon md-icon"></span> Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> CKA学习笔记 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CKA学习笔记 data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> CKA学习笔记 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_1 type=checkbox id=__nav_3_3_1> <label class=md-nav__link for=__nav_3_3_1> 安装 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=安装 data-md-level=3> <label class=md-nav__title for=__nav_3_3_1> <span class="md-nav__icon md-icon"></span> 安装 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/installation/single-local/ class=md-nav__link> 单节点虚拟机安装Kubernetes </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/installation/multiple-local/ class=md-nav__link> 多节点虚拟机安装Kubernetes </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/installation/aliyun-ubuntu/ class=md-nav__link> 阿里云ECS安装Kubernetes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_2 type=checkbox id=__nav_3_3_2> <label class=md-nav__link for=__nav_3_3_2> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=3> <label class=md-nav__title for=__nav_3_3_2> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/docker/ class=md-nav__link> Docker基础 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_3 type=checkbox id=__nav_3_3_3> <label class=md-nav__link for=__nav_3_3_3> 基础知识 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=基础知识 data-md-level=3> <label class=md-nav__title for=__nav_3_3_3> <span class="md-nav__icon md-icon"></span> 基础知识 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/memo/ class=md-nav__link> Kubernetes随笔 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/overview/ class=md-nav__link> Kubernetes集群概览 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/basics/ class=md-nav__link> kubectl基础 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_4 type=checkbox id=__nav_3_3_4> <label class=md-nav__link for=__nav_3_3_4> 核心概念 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=核心概念 data-md-level=3> <label class=md-nav__title for=__nav_3_3_4> <span class="md-nav__icon md-icon"></span> 核心概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_5 type=checkbox id=__nav_3_3_5> <label class=md-nav__link for=__nav_3_3_5> 应用体系 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=应用体系 data-md-level=3> <label class=md-nav__title for=__nav_3_3_5> <span class="md-nav__icon md-icon"></span> 应用体系 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/secrets/ class=md-nav__link> secrets </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/rbac/ class=md-nav__link> RBAC鉴权 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/ingress/ class=md-nav__link> Ingress-nginx </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_6 type=checkbox id=__nav_3_3_6> <label class=md-nav__link for=__nav_3_3_6> 进阶概念 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=进阶概念 data-md-level=3> <label class=md-nav__title for=__nav_3_3_6> <span class="md-nav__icon md-icon"></span> 进阶概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling (HPA) </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_7 type=checkbox id=__nav_3_3_7> <label class=md-nav__link for=__nav_3_3_7> 日常维护 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=日常维护 data-md-level=3> <label class=md-nav__title for=__nav_3_3_7> <span class="md-nav__icon md-icon"></span> 日常维护 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/healthcheck/ class=md-nav__link> 健康检查 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/helming/ class=md-nav__link> Helm Chart </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_8 type=checkbox id=__nav_3_3_8> <label class=md-nav__link for=__nav_3_3_8> 主题讨论 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=主题讨论 data-md-level=3> <label class=md-nav__title for=__nav_3_3_8> <span class="md-nav__icon md-icon"></span> 主题讨论 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/casestudy-operation-resources/ class=md-nav__link> Kubernetes资源常见操作 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/casestudy-health-check/ class=md-nav__link> 健康检查 </a> </li> <li class=md-nav__item> <a href=../../../cka_cn/foundamentals/casestudy-calico/ class=md-nav__link> 安装Calico </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../demo/cap_on_kyma/ class=md-nav__link> Build CAP Application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/Foundation/ch00/ class=md-nav__link> Python安装 </a> </li> <li class=md-nav__item> <a href=../../../../python/Foundation/ch01/ class=md-nav__link> Python语言基础 </a> </li> <li class=md-nav__item> <a href=../../../../python/Foundation/ch02/ class=md-nav__link> Python打包和解包 </a> </li> <li class=md-nav__item> <a href=../../../../python/Foundation/ch03/ class=md-nav__link> Python内置函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../../python/Foundation/ch04/ class=md-nav__link> Python面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../../python/Foundation/ch05/ class=md-nav__link> Python面向对象三大特性 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> 数据结构和算法 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=数据结构和算法 data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> 数据结构和算法 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/DataStructure/01_PythonFundmantal/ class=md-nav__link> 基础知识回顾 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataStructure/02_CollectionsOverview/ class=md-nav__link> 多项集的概述 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataStructure/03_TimeComplexity/ class=md-nav__link> 搜索、排序以及复杂度分析 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataStructure/04_ArrayChain/ class=md-nav__link> 数组和链接结构 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataStructure/05_InterfacePolymorphism/ class=md-nav__link> 接口、实现和多态 </a> </li> <li class=md-nav__item> <a href=../../../../python/DataStructure/06_InheritanceAbstractClass/ class=md-nav__link> 继承与抽象类 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_5 type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5> Effective Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Effective Python" data-md-level=2> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Effective Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule01/ class=md-nav__link> 第01条 查询自己使用的Python版本 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule02/ class=md-nav__link> 第02条 遵循PEP 8风格指南 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule03/ class=md-nav__link> 第03条 了解bytes与str的区别 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule04/ class=md-nav__link> 第04条 用支持插值的f-string取代C风格的格式字符串与str.format方法 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule05/ class=md-nav__link> 第05条 用辅助函数取代复杂的表达式 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule06/ class=md-nav__link> 第06条 把数据结构直接拆分到多个变量里，不要专门通过下标访问 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule07/ class=md-nav__link> 第07条 尽量用enumerate取代range </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule08/ class=md-nav__link> 第08条 用zip函数同时遍历两个迭代器 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule09/ class=md-nav__link> 第09条 不要在for与while循环后面写else块 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule10/ class=md-nav__link> 第10条 用赋值表达式减少重复代码 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule11/ class=md-nav__link> 第11条 学会对序列做切片 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule12/ class=md-nav__link> 第12条 不要在切片里同时指定起止下标与步进 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule13/ class=md-nav__link> 第13条 通过带星号的unpacking操作来捕获多个元素,不要用切片 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule14/ class=md-nav__link> 第14条 用sort方法的key参数来表示复杂的排序逻辑 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule15/ class=md-nav__link> 第15条 不要过分依赖给字典添加条目时所用的顺序 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule16/ class=md-nav__link> 第16条 用get处理键不在字典中的情况,不要使用in与KeyError </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule17/ class=md-nav__link> 第17条 用defaultdict处理内部状态中缺失的元素,而不要用setdefault </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule18/ class=md-nav__link> 第18条 学会利用__missing__构造依赖键的默认值 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule19/ class=md-nav__link> 第19条 不要把函数返回的多个数值拆分到三个以上的变量中 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule20/ class=md-nav__link> 第20条 遇到意外状况时应该抛出异常,不要返回None </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule21/ class=md-nav__link> 第21条 了解如何在闭包里面使用外围作用域中的变量 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule22/ class=md-nav__link> 第22条 用数量可变的位置参数给函数设计清晰的参数列表 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule23/ class=md-nav__link> 第23条 用关键字参数来表示可选的行为 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule24/ class=md-nav__link> 第24条 用None和docstring来描述默认值会变的参数 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule25/ class=md-nav__link> 第25条 用只能以关键字指定和只能按位置传入的参数来设计清晰的参数列表 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule26/ class=md-nav__link> 第26条 用functools.wraps定义函数修饰器 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule27/ class=md-nav__link> 第27条 用列表推导取代map与filter </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule28/ class=md-nav__link> 第28条 控制推导逻辑的子表达式不要超过两个 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule29/ class=md-nav__link> 第29条 用赋值表达式消除推导中的重复代码 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule30/ class=md-nav__link> 第30条 不要让函数直接返回列表，应该让它逐个生成列表里的值 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule31/ class=md-nav__link> 第31条 谨慎地迭代函数所收到的参数 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule32/ class=md-nav__link> 第32条 考虑用生成器表达式改写数据量较大的列表推导 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule33/ class=md-nav__link> 第33条 通过yield from把多个生成器连起来用 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule34/ class=md-nav__link> 第34条 不要用send给生成器注入数据 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule35/ class=md-nav__link> 第35条 不要通过throw变换生成器的状态 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule36/ class=md-nav__link> 第36条 考虑用itertools拼装迭代器与生成器 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule37/ class=md-nav__link> 第37条 用组合起来的类来实现多层结构，不要用嵌套的内置类型 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule38/ class=md-nav__link> 第38条 让简单的接口接受函数，而不是类的实例 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule39/ class=md-nav__link> 第39条 通过@classmethod多态来构造同一体系中的各类对象 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule40/ class=md-nav__link> 第40条 通过super初始化超类 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule41/ class=md-nav__link> 第41条 考虑用mix-in类来表示可组合的功能 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule42/ class=md-nav__link> 第42条 优先考虑用public属性表示应受保护的数据,不要用private属性表示 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule43/ class=md-nav__link> 第43条 自定义的容器类型应该从collections.abc继承 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule44/ class=md-nav__link> 第44条 用纯属性与修饰器取代旧式的setter与getter方法 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule45/ class=md-nav__link> 第45条 考虑用@property实现新的属性访问逻辑,不要急着重构原有的代码 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule46/ class=md-nav__link> 第46条 用描述符来改写需要复用的@property方法 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule47/ class=md-nav__link> 第47条 针对惰性属性使用__getattr__、__getattribute__及__setattr__ </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule48/ class=md-nav__link> 第48条 用__init_subclass__验证子类写得是否正确 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule49/ class=md-nav__link> 第49条 用__init_subclass__记录现有的子类 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule50/ class=md-nav__link> 第50条 用__set_name__给类属性加注解 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule51/ class=md-nav__link> 第51条 优先考虑通过类修饰器来提供可组合的扩充功能，不要使用元类 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule52/ class=md-nav__link> 第52条 用subprocess管理子进程 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule53/ class=md-nav__link> 第53条 可以用线程执行阻塞式I/O,但不要用它做并行计算 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule54/ class=md-nav__link> 第54条 利用Lock防止多个线程争用同一份数据 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule55/ class=md-nav__link> 第55条 用Queue来协调各线程之间的工作进度 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule56/ class=md-nav__link> 第56条 学会判断什么场合必须做并发 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule57/ class=md-nav__link> 第57条 不要在每次fan-out时都新建一批Thread实例 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule58/ class=md-nav__link> 第58条 学会正确地重构代码,以便用Queue做并发 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule59/ class=md-nav__link> 第59条 如果必须用线程做并发,那就考虑通过ThreadPoolExecutor实现 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule60/ class=md-nav__link> 第60条 用协程实现高并发的I/O </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule61/ class=md-nav__link> 第61条 学会用asyncio改写那些通过线程实现的I/O </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule62/ class=md-nav__link> 第62条 结合线程与协程,将代码顺利迁移到asyncio </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule63/ class=md-nav__link> 第63条 让asyncio的事件循环保持畅通,以便进一步提升程序的响应能力 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule64/ class=md-nav__link> 第64条 考虑用concurrent.futures实现真正的并行计算 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule65/ class=md-nav__link> 第65条 合理利用try/except/else/finally结构中的每个代码块 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule66/ class=md-nav__link> 第66条 考虑用contextlib和with语句来改写可复用的try/finally代码 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule67/ class=md-nav__link> 第67条 用datetime模块处理本地时间,不要用time模块 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule68/ class=md-nav__link> 第68条 用copyreg实现可靠的pickle操作 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule69/ class=md-nav__link> 第69条 在需要准确计算的场合,用decimal表示相应的数值 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule70/ class=md-nav__link> 第70条 先分析性能，然后再优化 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule71/ class=md-nav__link> 第71条 优先考虑用deque实现生产者-消费者队列 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule72/ class=md-nav__link> 第72条 考虑用bisect搜索已排序的序列 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule73/ class=md-nav__link> 第73条 学会使用heapq制作优先级队列 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule74/ class=md-nav__link> 第74条 考虑用memoryview与bytearray来实现无须拷贝的bytes操作 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule75/ class=md-nav__link> 第75条 通过repr字符串输出调试信息 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule76/ class=md-nav__link> 第76条 在TestCase子类里验证相关的行为 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule77/ class=md-nav__link> 第77条 把测试前、后的准备与清理逻辑写在setUp、tearDown、setUpModule与tearDownModule中,以防用例之间互相干扰 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule78/ class=md-nav__link> 第78条 用Mock来模拟受测代码所依赖的复杂函数 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule79/ class=md-nav__link> 第79条 把受测代码所依赖的系统封装起来，以便于模拟和测试 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule80/ class=md-nav__link> 第80条 考虑用pdb做交互调试 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule81/ class=md-nav__link> 第81条 用tracemalloc来掌握内存的使用与泄漏情况 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule82/ class=md-nav__link> 第82条 学会寻找由其他Python开发者所构建的模块 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule83/ class=md-nav__link> 第83条 用虚拟环境隔离项目,并重建依赖关系 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule84/ class=md-nav__link> 第84条 每一个函数、类与模块都要写docstring </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule85/ class=md-nav__link> 第85条 用包来安排模块,以提供稳固的API </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule86/ class=md-nav__link> 第86条 考虑用模块级别的代码配置不同的部署环境 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule87/ class=md-nav__link> 第87条 为自编的模块定义根异常,让调用者能够专门处理与此API有关的异常 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule88/ class=md-nav__link> 第88条 用适当的方式打破循环依赖关系 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule89/ class=md-nav__link> 第89条 重构时考虑通过warnings提醒开发者API已经发生变化 </a> </li> <li class=md-nav__item> <a href=../../../../python/Pythonic90Rules/Rule90/ class=md-nav__link> 第90条 考虑通过typing做静态分析,以消除bug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6 type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> 读书有感 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=读书有感 data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> 读书有感 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../Reading/Developers/ class=md-nav__link> 程序员的职业和生存指南 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#local-vm-setting class=md-nav__link> Local VM setting </a> </li> <li class=md-nav__item> <a href=#ubuntu-post-installation class=md-nav__link> Ubuntu Post Installation </a> </li> <li class=md-nav__item> <a href=#install-containerd class=md-nav__link> Install Containerd </a> </li> <li class=md-nav__item> <a href=#install-nerdctl class=md-nav__link> Install nerdctl </a> </li> <li class=md-nav__item> <a href=#install-kubernetes class=md-nav__link> Install Kubernetes </a> </li> <li class=md-nav__item> <a href=#setup-master-node class=md-nav__link> Setup Master Node </a> <nav class=md-nav aria-label="Setup Master Node"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#kubeadm-init class=md-nav__link> kubeadm init </a> </li> <li class=md-nav__item> <a href=#kubeconfig-file class=md-nav__link> kubeconfig file </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#install-calico class=md-nav__link> Install Calico </a> </li> <li class=md-nav__item> <a href=#setup-work-nodes class=md-nav__link> Setup Work Nodes </a> </li> <li class=md-nav__item> <a href=#check-cluster-status class=md-nav__link> Check Cluster Status </a> </li> <li class=md-nav__item> <a href=#post-installation class=md-nav__link> Post Installation </a> <nav class=md-nav aria-label="Post Installation"> <ul class=md-nav__list> <li class=md-nav__item> <a href=#bash-autocomplete class=md-nav__link> Bash Autocomplete </a> </li> <li class=md-nav__item> <a href=#alias class=md-nav__link> Alias </a> </li> <li class=md-nav__item> <a href=#update-default-context class=md-nav__link> Update Default Context </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#install-helm class=md-nav__link> Install Helm </a> </li> <li class=md-nav__item> <a href=#reset-cluster class=md-nav__link> Reset cluster </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/k8s/cka_en/installation/multiple-local.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=multiple-nodes-installation>Multiple Nodes Installation<a class=headerlink href=#multiple-nodes-installation title="Permanent link"> ¶</a></h1> <h2 id=local-vm-setting>Local VM setting<a class=headerlink href=#local-vm-setting title="Permanent link"> ¶</a></h2> <p>VMWare Setting.</p> <ul> <li>VMnet1: host-only, subnet: 192.168.150.0/24</li> <li>VMnet8: NAT, subnet: 11.0.1.0/24</li> </ul> <p>Create guest machine with VMWare Player.</p> <ul> <li>4 GB RAM</li> <li>1 CPUs with 2 Cores</li> <li>Ubuntu Server 22.04</li> <li>NAT</li> </ul> <p>Info:</p> <ul> <li>Kubernetes running on Containerd.</li> </ul> <h2 id=ubuntu-post-installation>Ubuntu Post Installation<a class=headerlink href=#ubuntu-post-installation title="Permanent link"> ¶</a></h2> <p>Info:</p> <ul> <li>Log onto each VM with the account created during Ubuntu installation, and perform below tasks on every VM.</li> </ul> <p>Create user <code>vagrant</code> on all guests.</p> <div class=highlight><pre><span></span><code>sudo adduser vagrant
sudo usermod -aG adm,sudo,syslog,cdrom,dip,plugdev,lxd,root vagrant
sudo passwd vagrant
</code></pre></div> <p>Set password for <code>root</code> on all guests.</p> <div class=highlight><pre><span></span><code>sudo passwd root
</code></pre></div> <p>Enable root ssh logon.</p> <div class=highlight><pre><span></span><code>sudo vi /etc/ssh/sshd_config
</code></pre></div> <p>Update parameter <code>PermitRootLogin</code> from <code>prohibit-password</code> to <code>yes</code>.</p> <div class=highlight><pre><span></span><code><span class=go>PermitRootLogin yes</span>
<span class=gp>#</span>PermitRootLogin prohibit-password
</code></pre></div> <p>Restart the sshd service.</p> <div class=highlight><pre><span></span><code>sudo systemctl restart sshd
</code></pre></div> <p>Change host name, e.g., <code>ubu1</code>.</p> <div class=highlight><pre><span></span><code>sudo hostnamectl set-hostname ubu1
sudo hostnamectl set-hostname ubu1 --pretty
</code></pre></div> <p>Verify if the hostname is set to expected name, e.g., <code>ubu1</code>.</p> <div class=highlight><pre><span></span><code>cat /etc/machine-info
</code></pre></div> <p>Verify if the hostname is set to expected name, e.g., <code>ubu1</code>.</p> <div class=highlight><pre><span></span><code>cat /etc/hostname
</code></pre></div> <p>Verify if the hostname of <code>127.0.1.1</code> is set to expected name, e.g., <code>ubu1</code>. And add all nodes into the file <code>/etc/hosts</code>.</p> <div class=highlight><pre><span></span><code><span class=go>sudo vi /etc/hosts</span>
</code></pre></div> <p>Related setting looks like below.</p> <div class=highlight><pre><span></span><code><span class=go>127.0.1.1 ubu1</span>
<span class=go>11.0.1.129 ubu1</span>
<span class=go>11.0.1.130 ubu2</span>
<span class=go>11.0.1.131 ubu3</span>
<span class=go>11.0.1.132 ubu4</span>
</code></pre></div> <p>Create file <code>/etc/netplan/00-installer-config.yaml</code>.</p> <div class=highlight><pre><span></span><code>sudo vi /etc/netplan/00-installer-config.yaml
</code></pre></div> <p>Update it with information below to set VM with fixed IP with actual IP address, e.g, <code>11.0.1.129</code>.</p> <div class=highlight><pre><span></span><code><span class=nt>network</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>ethernets</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>ens33</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class=nt>dhcp4</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">false</span><span class=w></span>
<span class=w>      </span><span class=nt>addresses</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">11.0.1.129/24</span><span class=w></span>
<span class=w>      </span><span class=nt>nameservers</span><span class=p>:</span><span class=w></span>
<span class=w>        </span><span class=nt>addresses</span><span class=p>:</span><span class=w></span>
<span class=w>        </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">11.0.1.2</span><span class=w></span>
<span class=w>      </span><span class=nt>routes</span><span class=p>:</span><span class=w></span>
<span class=w>      </span><span class="p p-Indicator">-</span><span class=w> </span><span class=nt>to</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">default</span><span class=w></span>
<span class=w>        </span><span class=nt>via</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">11.0.1.2</span><span class=w></span>
<span class=w>  </span><span class=nt>version</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">2</span><span class=w></span>
</code></pre></div> <p>Effect above change.</p> <div class=highlight><pre><span></span><code>sudo netplan apply
</code></pre></div> <p>Attention:</p> <ul> <li>The current ssh connection will be broken due to network setting change.</li> </ul> <p>Disable swap and firewall on all nodes.</p> <div class=highlight><pre><span></span><code>sudo swapoff -a
sudo ufw disable
sudo ufw status verbose
</code></pre></div> <p>And comment the last line of swap setting in file <code>/etc/fstab</code>. Need <em>reboot</em> guest here.</p> <div class=highlight><pre><span></span><code>sudo vi /etc/fstab
</code></pre></div> <p>Result likes below.</p> <div class=highlight><pre><span></span><code><span class=go>/dev/disk/by-uuid/df370d2a-83e5-4895-8c7f-633f2545e3fe / ext4 defaults 0 1</span>
<span class=gp># </span>/swap.img     none    swap    sw      <span class=m>0</span>       <span class=m>0</span>
</code></pre></div> <p>Setup timezone on all nodes</p> <div class=highlight><pre><span></span><code>sudo ln -sf /usr/share/zoneinfo/Asia/Shanghai /etc/localtime

sudo cp /etc/profile /etc/profile.bak
<span class=nb>echo</span> <span class=s1>&#39;LANG=&quot;en_US.UTF-8&quot;&#39;</span> <span class=p>|</span> sudo tee -a /etc/profile

<span class=nb>source</span> /etc/profile
</code></pre></div> <p>Something like this after execute command <code>ll /etc/localtime</code></p> <div class=highlight><pre><span></span><code><span class=go>lrwxrwxrwx 1 root root 33 Jul 15 22:00 /etc/localtime -&gt; /usr/share/zoneinfo/Asia/Shanghai</span>
</code></pre></div> <p>Kernel setting.</p> <div class=highlight><pre><span></span><code>cat <span class=s>&lt;&lt;EOF | sudo tee /etc/modules-load.d/containerd.conf</span>
<span class=s>overlay</span>
<span class=s>br_netfilter</span>
<span class=s>EOF</span>
</code></pre></div> <p>Load to kernel.</p> <div class=highlight><pre><span></span><code>sudo modprobe overlay
sudo modprobe br_netfilter
</code></pre></div> <p>Network setting.</p> <div class=highlight><pre><span></span><code>cat <span class=s>&lt;&lt;EOF | sudo tee /etc/sysctl.d/99-kubernetes-cri.conf</span>
<span class=s>net.bridge.bridge-nf-call-iptables  = 1</span>
<span class=s>net.ipv4.ip_forward                 = 1</span>
<span class=s>net.bridge.bridge-nf-call-ip6tables = 1</span>
<span class=s>EOF</span>
</code></pre></div> <p>Effect changes above.</p> <div class=highlight><pre><span></span><code>sudo sysctl --system
</code></pre></div> <p>Attention:</p> <ul> <li>Reboot the VM.</li> </ul> <p>Attention:</p> <ul> <li>Log onto the VM with account <code>vagrant</code> to verify if above changes were updated as expected.</li> <li>IP address.</li> </ul> <div class=highlight><pre><span></span><code>ip addr list
</code></pre></div> <ul> <li>Hostname.</li> </ul> <div class=highlight><pre><span></span><code>cat /etc/machine-info
cat /etc/hostname
hostname
</code></pre></div> <ul> <li>Firewall.</li> </ul> <div class=highlight><pre><span></span><code>sudo ufw status verbose
</code></pre></div> <ul> <li>Kernel setting.</li> </ul> <div class=highlight><pre><span></span><code>lsmod <span class=p>|</span> grep -i overlay
lsmod <span class=p>|</span> grep -i br_netfilter
</code></pre></div> <ul> <li>Network setting.</li> </ul> <div class=highlight><pre><span></span><code>sudo sysctl -a <span class=p>|</span> grep -i net.bridge.bridge-nf-call-ip*
sudo sysctl -a <span class=p>|</span> grep -i net.ipv4.ip_forward
</code></pre></div> <h2 id=install-containerd>Install Containerd<a class=headerlink href=#install-containerd title="Permanent link"> ¶</a></h2> <p>Install Containerd sevice on all nodes.</p> <p>Backup source file.</p> <div class=highlight><pre><span></span><code>sudo cp /etc/apt/sources.list /etc/apt/sources.list.bak
</code></pre></div> <p>Install Containered.</p> <div class=highlight><pre><span></span><code>sudo apt-get update <span class=o>&amp;&amp;</span> sudo apt-get install -y containerd
</code></pre></div> <p>Configure Containerd. Modify file <code>/etc/containerd/config.toml</code>.</p> <div class=highlight><pre><span></span><code>sudo mkdir -p /etc/containerd
containerd config default <span class=p>|</span> sudo tee /etc/containerd/config.toml
sudo vi /etc/containerd/config.toml
</code></pre></div> <p>Update <code>sandbox_image</code> with new value <code>"registry.aliyuncs.com/google_containers/pause:3.6"</code>. Update <code>SystemdCgroup</code> with new value <code>true</code>.</p> <div class=highlight><pre><span></span><code><span class=go>[plugins]</span>
<span class=go>  [plugins.&quot;io.containerd.gc.v1.scheduler&quot;]</span>

<span class=go>  [plugins.&quot;io.containerd.grpc.v1.cri&quot;]</span>
<span class=go>    sandbox_image = &quot;registry.aliyuncs.com/google_containers/pause:3.6&quot;</span>

<span class=go>    [plugins.&quot;io.containerd.grpc.v1.cri&quot;.cni]</span>
<span class=go>    [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd]</span>
<span class=go>      [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.default_runtime]</span>
<span class=go>        [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.default_runtime.options]</span>
<span class=go>      [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes]</span>
<span class=go>        [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc]</span>

<span class=go>          [plugins.&quot;io.containerd.grpc.v1.cri&quot;.containerd.runtimes.runc.options]</span>
<span class=go>            SystemdCgroup = true</span>
</code></pre></div> <p>Restart Containerd service.</p> <div class=highlight><pre><span></span><code>sudo systemctl restart containerd
sudo systemctl status containerd
</code></pre></div> <h2 id=install-nerdctl>Install nerdctl<a class=headerlink href=#install-nerdctl title="Permanent link"> ¶</a></h2> <p>Install nerdctl sevice on all nodes.</p> <p>The goal of <a href=https://github.com/containerd/nerdctl><code>nerdctl</code></a> is to facilitate experimenting the cutting-edge features of containerd that are not present in Docker.</p> <p>Binaries are available here: <a href=https://github.com/containerd/nerdctl/releases>https://github.com/containerd/nerdctl/releases</a></p> <div class=highlight><pre><span></span><code>wget https://github.com/containerd/nerdctl/releases/download/v0.22.2/nerdctl-0.22.2-linux-amd64.tar.gz
tar -zxvf nerdctl-0.22.2-linux-amd64.tar.gz
sudo cp nerdctl /usr/bin/
</code></pre></div> <p>Verify nerdctl.</p> <div class=highlight><pre><span></span><code>sudo nerdctl --help
</code></pre></div> <p>To list local Kubernetes containers.</p> <div class=highlight><pre><span></span><code>sudo nerdctl -n k8s.io ps
</code></pre></div> <h2 id=install-kubernetes>Install Kubernetes<a class=headerlink href=#install-kubernetes title="Permanent link"> ¶</a></h2> <p>Install Kubernetes on all nodes.</p> <p>Install dependencied packages.</p> <div class=highlight><pre><span></span><code>sudo apt-get update <span class=o>&amp;&amp;</span> sudo apt-get install -y apt-transport-https ca-certificates curl
</code></pre></div> <p>Install gpg certificate.</p> <div class=highlight><pre><span></span><code>sudo curl -fsSLo /usr/share/keyrings/kubernetes-archive-keyring.gpg https://mirrors.aliyun.com/kubernetes/apt/doc/apt-key.gpg
</code></pre></div> <p>Add Kubernetes repo.</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span> <span class=s2>&quot;deb [signed-by=/usr/share/keyrings/kubernetes-archive-keyring.gpg] https://mirrors.aliyun.com/kubernetes/apt/ kubernetes-xenial main&quot;</span> <span class=p>|</span> sudo tee /etc/apt/sources.list.d/kubernetes.list
</code></pre></div> <p>Update and install dependencied packages.</p> <div class=highlight><pre><span></span><code>sudo apt-get update
sudo apt-get install ebtables
sudo apt-get install libxtables12
sudo apt-get upgrade iptables
</code></pre></div> <p>Check available versions of kubeadm.</p> <div class=highlight><pre><span></span><code>apt policy kubeadm
</code></pre></div> <p>Install <code>1.24.1-00</code> version.</p> <div class=highlight><pre><span></span><code>sudo apt-get -y install <span class=nv>kubelet</span><span class=o>=</span><span class=m>1</span>.24.1-00 <span class=nv>kubeadm</span><span class=o>=</span><span class=m>1</span>.24.1-00 <span class=nv>kubectl</span><span class=o>=</span><span class=m>1</span>.24.1-00 --allow-downgrades
</code></pre></div> <h2 id=setup-master-node>Setup Master Node<a class=headerlink href=#setup-master-node title="Permanent link"> ¶</a></h2> <h3 id=kubeadm-init>kubeadm init<a class=headerlink href=#kubeadm-init title="Permanent link"> ¶</a></h3> <p>Set up Control Plane on VM playing master node.</p> <p>Check kubeadm default parameters for initialization.</p> <div class=highlight><pre><span></span><code>kubeadm config print init-defaults
</code></pre></div> <p>Reuslt:</p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kubeadm.k8s.io/v1beta3</span><span class=w></span>
<span class=nt>bootstrapTokens</span><span class=p>:</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class=nt>groups</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">system:bootstrappers:kubeadm:default-node-token</span><span class=w></span>
<span class=w>  </span><span class=nt>token</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">abcdef.0123456789abcdef</span><span class=w></span>
<span class=w>  </span><span class=nt>ttl</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">24h0m0s</span><span class=w></span>
<span class=w>  </span><span class=nt>usages</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">signing</span><span class=w></span>
<span class=w>  </span><span class="p p-Indicator">-</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">authentication</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">InitConfiguration</span><span class=w></span>
<span class=nt>localAPIEndpoint</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>advertiseAddress</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.2.3.4</span><span class=w></span>
<span class=w>  </span><span class=nt>bindPort</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">6443</span><span class=w></span>
<span class=nt>nodeRegistration</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>criSocket</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">unix:///var/run/containerd/containerd.sock</span><span class=w></span>
<span class=w>  </span><span class=nt>imagePullPolicy</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">IfNotPresent</span><span class=w></span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">node</span><span class=w></span>
<span class=w>  </span><span class=nt>taints</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">null</span><span class=w></span>
<span class=nn>---</span><span class=w></span>
<span class=nt>apiServer</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>timeoutForControlPlane</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">4m0s</span><span class=w></span>
<span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kubeadm.k8s.io/v1beta3</span><span class=w></span>
<span class=nt>certificatesDir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/etc/kubernetes/pki</span><span class=w></span>
<span class=nt>clusterName</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">kubernetes</span><span class=w></span>
<span class=nt>controllerManager</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span><span class=w></span>
<span class=nt>dns</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span><span class=w></span>
<span class=nt>etcd</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>local</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>dataDir</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">/var/lib/etcd</span><span class=w></span>
<span class=nt>imageRepository</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">k8s.gcr.io</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">ClusterConfiguration</span><span class=w></span>
<span class=nt>kubernetesVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">1.24.0</span><span class=w></span>
<span class=nt>networking</span><span class=p>:</span><span class=w></span>
<span class=w>  </span><span class=nt>dnsDomain</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">cluster.local</span><span class=w></span>
<span class=w>  </span><span class=nt>serviceSubnet</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">10.96.0.0/12</span><span class=w></span>
<span class=nt>scheduler</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span><span class=w></span>
</code></pre></div> <p>Dry rune and run. Save the output, which will be used later on work nodes.</p> <p>With <code>kubeadm init</code> to initiate cluster, we need understand below three options about network.</p> <ul> <li><code>--pod-network-cidr</code>:</li> <li>Specify range of IP addresses for the pod network. If set, the control plane will automatically allocate CIDRs for every node.</li> <li>Be noted that <code>10.244.0.0/16</code> is default range of flannel. If it's changed here, please do change the same when deploy <code>Flannel</code>.</li> <li><code>--apiserver-bind-port</code>:</li> <li>Port for the API Server to bind to. (default 6443)</li> <li><code>--service-cidr</code>:</li> <li>Use alternative range of IP address for service VIPs. (default "10.96.0.0/12")</li> </ul> <p>Note:</p> <ul> <li>service VIPs (a.k.a. Cluster IP), specified by option <code>--service-cidr</code>.</li> <li>podCIDR (a.k.a. endpoint IP)，specified by option <code>--pod-network-cidr</code>.</li> </ul> <p>There are 4 distinct networking problems to address:</p> <ul> <li>Highly-coupled container-to-container communications: this is solved by Pods (podCIDR) and localhost communications.</li> <li>Pod-to-Pod communications:</li> <li>a.k.a. container-to-container.</li> <li>Example with Flannel, the flow is: Pod &rarr; veth pair &rarr; cni0 &rarr; flannel.1 &rarr; host eth0 &rarr; host eth0 &rarr; flannel.1 &rarr; cni0 &rarr; veth pair &rarr; Pod.</li> <li>Pod-to-Service communications:</li> <li>Flow: Pod &rarr; Kernel &rarr; Servive iptables &rarr; service &rarr; Pod iptables &rarr; Pod</li> <li>External-to-Service communications:</li> <li>LoadBalancer: SLB &rarr; NodePort &rarr; Service &rarr; Pod</li> </ul> <p><code>kube-proxy</code> is responsible for iptables, not traffic.</p> <div class=highlight><pre><span></span><code>sudo kubeadm init <span class=se>\</span>
  --dry-run <span class=se>\</span>
  --pod-network-cidr<span class=o>=</span><span class=m>10</span>.244.0.0/16 <span class=se>\</span>
  --service-cidr<span class=o>=</span><span class=m>192</span>.244.0.0/16 <span class=se>\</span>
  --image-repository<span class=o>=</span>registry.aliyuncs.com/google_containers <span class=se>\</span>
  --kubernetes-version<span class=o>=</span>v1.24.1

sudo kubeadm init <span class=se>\</span>
  --pod-network-cidr<span class=o>=</span><span class=m>10</span>.244.0.0/16 <span class=se>\</span>
  --service-cidr<span class=o>=</span><span class=m>192</span>.244.0.0/16 <span class=se>\</span>
  --image-repository<span class=o>=</span>registry.aliyuncs.com/google_containers <span class=se>\</span>
  --kubernetes-version<span class=o>=</span>v1.24.1
</code></pre></div> <h3 id=kubeconfig-file>kubeconfig file<a class=headerlink href=#kubeconfig-file title="Permanent link"> ¶</a></h3> <p>Set <code>kubeconfig</code> file for current user (here it's <code>vagrant</code>).</p> <div class=highlight><pre><span></span><code>mkdir -p <span class=nv>$HOME</span>/.kube
sudo cp -i /etc/kubernetes/admin.conf <span class=nv>$HOME</span>/.kube/config
sudo chown <span class=k>$(</span>id -u<span class=k>)</span>:<span class=k>$(</span>id -g<span class=k>)</span> <span class=nv>$HOME</span>/.kube/config
</code></pre></div> <p>Kubernetes provides a command line tool <code>kubectl</code> for communicating with a Kubernetes cluster's control plane, using the Kubernetes API.</p> <p>kubectl controls the Kubernetes <em>cluster manager</em>.</p> <p>For configuration, kubectl looks for a file named config in the <code>$HOME/.kube</code> directory, which is a copy of file <code>/etc/kubernetes/admin.conf</code> generated by <code>kubeadm init</code>.</p> <p>We can specify other kubeconfig files by setting the <code>KUBECONFIG</code> environment variable or by setting the <code>--kubeconfig flag</code>. If the <code>KUBECONFIG</code> environment variable doesn't exist, kubectl uses the default kubeconfig file, <code>$HOME/.kube/config</code>.</p> <p>A <em>context</em> element in a kubeconfig file is used to group access parameters under a convenient name. Each context has three parameters: cluster, namespace, and user. By default, the kubectl command-line tool uses parameters from the current context to communicate with the cluster.</p> <p>A sample of <code>.kube/config</code>.</p> <div class=highlight><pre><span></span><code><span class=nt>apiVersion</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">v1</span><span class=w></span>
<span class=nt>clusters</span><span class=p>:</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class=nt>cluster</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>certificate-authority-data</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;certificate string&gt;</span><span class=w></span>
<span class=w>    </span><span class=nt>server</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">https://&lt;eth0 ip&gt;:6443</span><span class=w></span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;cluster name&gt;</span><span class=w></span>
<span class=nt>contexts</span><span class=p>:</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class=nt>context</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>cluster</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;cluster name&gt;</span><span class=w></span>
<span class=w>    </span><span class=nt>namespace</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;namespace name&gt;</span><span class=w></span>
<span class=w>    </span><span class=nt>user</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;user name&gt;</span><span class=w></span>
<span class=w>  </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;context user&gt;@&lt;context name&gt;</span><span class=w></span>
<span class=nt>current-context</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;context name&gt;</span><span class=w></span>
<span class=nt>kind</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">Config</span><span class=w></span>
<span class=nt>preferences</span><span class=p>:</span><span class=w> </span><span class="p p-Indicator">{}</span><span class=w></span>
<span class=nt>users</span><span class=p>:</span><span class=w></span>
<span class="p p-Indicator">-</span><span class=w> </span><span class=nt>name</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;user name&gt;</span><span class=w></span>
<span class=w>  </span><span class=nt>user</span><span class=p>:</span><span class=w></span>
<span class=w>    </span><span class=nt>client-certificate-data</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;certificate string&gt;</span><span class=w></span>
<span class=w>    </span><span class=nt>client-key-data</span><span class=p>:</span><span class=w> </span><span class="l l-Scalar l-Scalar-Plain">&lt;certificate string&gt;</span><span class=w></span>
</code></pre></div> <p>To get the current context:</p> <div class=highlight><pre><span></span><code>kubectl config get-contexts
</code></pre></div> <p>Result</p> <div class=highlight><pre><span></span><code><span class=go>CURRENT   NAME                          CLUSTER      AUTHINFO           NAMESPACE</span>
<span class=go>*         kubernetes-admin@kubernetes   kubernetes   kubernetes-admin   </span>
</code></pre></div> <h2 id=install-calico>Install Calico<a class=headerlink href=#install-calico title="Permanent link"> ¶</a></h2> <p>Here is guidance of <a href=https://projectcalico.docs.tigera.io/getting-started/kubernetes/hardway/ >End-to-end Calico installation</a>. Detail practice demo, can be found in section "Install Calico" of "A1.Discussion" below.</p> <p>Install Calico</p> <div class=highlight><pre><span></span><code>curl https://docs.projectcalico.org/manifests/calico.yaml -O
kubectl apply -f calico.yaml
</code></pre></div> <p>Result</p> <div class=highlight><pre><span></span><code><span class=go>configmap/calico-config created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/bgpconfigurations.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/bgppeers.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/blockaffinities.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/caliconodestatuses.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/clusterinformations.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/felixconfigurations.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/globalnetworkpolicies.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/globalnetworksets.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/hostendpoints.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/ipamblocks.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/ipamconfigs.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/ipamhandles.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/ippools.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/ipreservations.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/kubecontrollersconfigurations.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/networkpolicies.crd.projectcalico.org created</span>
<span class=go>customresourcedefinition.apiextensions.k8s.io/networksets.crd.projectcalico.org created</span>
<span class=go>clusterrole.rbac.authorization.k8s.io/calico-kube-controllers created</span>
<span class=go>clusterrolebinding.rbac.authorization.k8s.io/calico-kube-controllers created</span>
<span class=go>clusterrole.rbac.authorization.k8s.io/calico-node created</span>
<span class=go>clusterrolebinding.rbac.authorization.k8s.io/calico-node created</span>
<span class=go>daemonset.apps/calico-node created</span>
<span class=go>serviceaccount/calico-node created</span>
<span class=go>deployment.apps/calico-kube-controllers created</span>
<span class=go>serviceaccount/calico-kube-controllers created</span>
<span class=go>poddisruptionbudget.policy/calico-kube-controllers created</span>
</code></pre></div> <p>Verify status of Calico. It may take minutes to complete initialization.</p> <div class=highlight><pre><span></span><code>kubectl get pod -n kube-system <span class=p>|</span> grep calico
</code></pre></div> <p>Result</p> <div class=highlight><pre><span></span><code><span class=go>calico-kube-controllers-555bc4b957-l8bn2   0/1     Pending    0          28s</span>
<span class=go>calico-node-255pc                          0/1     Init:1/3   0          29s</span>
<span class=go>calico-node-7tmnb                          0/1     Init:1/3   0          29s</span>
<span class=go>calico-node-w8nvl                          0/1     Init:1/3   0          29s</span>
</code></pre></div> <p>Verify network status.</p> <div class=highlight><pre><span></span><code>sudo nerdctl network ls
</code></pre></div> <p>Result</p> <div class=highlight><pre><span></span><code><span class=go>NETWORK ID      NAME               FILE</span>
<span class=go>                k8s-pod-network    /etc/cni/net.d/10-calico.conflist</span>
<span class=go>17f29b073143    bridge             /etc/cni/net.d/nerdctl-bridge.conflist</span>
<span class=go>                host               </span>
<span class=go>                none </span>
</code></pre></div> <h2 id=setup-work-nodes>Setup Work Nodes<a class=headerlink href=#setup-work-nodes title="Permanent link"> ¶</a></h2> <p>Use <code>kubeadm token</code> to generate the join token and hash value.</p> <div class=highlight><pre><span></span><code>kubeadm token create --print-join-command
</code></pre></div> <p>Command usage:</p> <div class=highlight><pre><span></span><code>sudo kubeadm join &lt;your master node eth0 ip&gt;:6443 --token &lt;token generated by kubeadm init&gt; --discovery-token-ca-cert-hash &lt;<span class=nb>hash</span> key generated by kubeadm init&gt;
</code></pre></div> <p>Result looks like below.</p> <div class=highlight><pre><span></span><code><span class=go>[preflight] Running pre-flight checks</span>
<span class=go>        [WARNING SystemVerification]: missing optional cgroups: blkio</span>
<span class=go>[preflight] Reading configuration from the cluster...</span>
<span class=go>[preflight] FYI: You can look at this config file with &#39;kubectl -n kube-system get cm kubeadm-config -o yaml&#39;</span>
<span class=go>[kubelet-start] Writing kubelet configuration to file &quot;/var/lib/kubelet/config.yaml&quot;</span>
<span class=go>[kubelet-start] Writing kubelet environment file with flags to file &quot;/var/lib/kubelet/kubeadm-flags.env&quot;</span>
<span class=go>[kubelet-start] Starting the kubelet</span>
<span class=go>[kubelet-start] Waiting for the kubelet to perform the TLS Bootstrap...</span>

<span class=go>This node has joined the cluster:</span>
<span class=go>* Certificate signing request was sent to apiserver and a response was received.</span>
<span class=go>* The Kubelet was informed of the new secure connection details.</span>

<span class=go>Run &#39;kubectl get nodes&#39; on the control-plane to see this node join the cluster.</span>
</code></pre></div> <h2 id=check-cluster-status>Check Cluster Status<a class=headerlink href=#check-cluster-status title="Permanent link"> ¶</a></h2> <p>Cluster info:</p> <div class=highlight><pre><span></span><code>kubectl cluster-info
</code></pre></div> <p>Output</p> <div class=highlight><pre><span></span><code><span class=go>Kubernetes control plane is running at https://11.0.1.129:6443</span>
<span class=go>CoreDNS is running at https://11.0.1.129:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy</span>
<span class=go>To further debug and diagnose cluster problems, use &#39;kubectl cluster-info dump&#39;.</span>
</code></pre></div> <p>Node info:</p> <div class=highlight><pre><span></span><code>kubectl get nodes -owide
</code></pre></div> <p>Pod info:</p> <div class=highlight><pre><span></span><code>kubectl get pod -A
</code></pre></div> <h2 id=post-installation>Post Installation<a class=headerlink href=#post-installation title="Permanent link"> ¶</a></h2> <h3 id=bash-autocomplete>Bash Autocomplete<a class=headerlink href=#bash-autocomplete title="Permanent link"> ¶</a></h3> <p>On each node.</p> <p>Set <code>kubectl</code> <a href=https://github.com/scop/bash-completion>auto-completion</a> following the <a href=https://kubernetes.io/docs/tasks/tools/included/optional-kubectl-configs-bash-linux/ >guideline</a>.</p> <div class=highlight><pre><span></span><code>apt install -y bash-completion

<span class=nb>source</span> /usr/share/bash-completion/bash_completion
<span class=nb>source</span> &lt;<span class=o>(</span>kubectl completion bash<span class=o>)</span>

<span class=nb>echo</span> <span class=s2>&quot;source &lt;(kubectl completion bash)&quot;</span> &gt;&gt; ~/.bashrc
<span class=nb>source</span> ~/.bashrc
</code></pre></div> <h3 id=alias>Alias<a class=headerlink href=#alias title="Permanent link"> ¶</a></h3> <p>If we set an alias for kubectl, we can extend shell completion to work with that alias:</p> <div class=highlight><pre><span></span><code><span class=nb>echo</span> <span class=s1>&#39;alias k=kubectl&#39;</span> &gt;&gt;~/.bashrc
<span class=nb>echo</span> <span class=s1>&#39;complete -o default -F __start_kubectl k&#39;</span> &gt;&gt;~/.bashrc
</code></pre></div> <h3 id=update-default-context>Update Default Context<a class=headerlink href=#update-default-context title="Permanent link"> ¶</a></h3> <p>Get current context.</p> <div class=highlight><pre><span></span><code>kubectl config get-contexts 
</code></pre></div> <p>In below result, we know:</p> <ul> <li>Contenxt name is <code>kubernetes-admin@kubernetes</code>.</li> <li>Cluster name is <code>kubernetes</code>.</li> <li>User is <code>kubernetes-admin</code>.</li> <li>No namespace explicitly defined.</li> </ul> <div class=highlight><pre><span></span><code>CURRENT   NAME                          CLUSTER      AUTHINFO           NAMESPACE
*         kubernetes-admin@kubernetes   kubernetes   kubernetes-admin 
</code></pre></div> <p>To set a context with new update, e.g, update default namespace, etc..</p> <div class=highlight><pre><span></span><code><span class=c1># Usage:</span>
kubectl config set-context &lt;context name&gt; --cluster<span class=o>=</span>&lt;cluster name&gt; --namespace<span class=o>=</span>&lt;namespace name&gt; --user<span class=o>=</span>&lt;user name&gt; 

<span class=c1># Set default namespace</span>
kubectl config set-context kubernetes-admin@kubernetes --cluster<span class=o>=</span>kubernetes --namespace<span class=o>=</span>default --user<span class=o>=</span>kubernetes-admin
</code></pre></div> <p>To switch to a new context.</p> <div class=highlight><pre><span></span><code>kubectl config use-context &lt;context name&gt;
</code></pre></div> <div class=highlight><pre><span></span><code>kubectl config use-context kubernetes-admin@kubernetes
</code></pre></div> <p>Reference:</p> <ul> <li><a href=https://kubernetes.io/docs/concepts/configuration/organize-cluster-access-kubeconfig/ >kubectl</a></li> <li><a href=https://kubernetes.io/docs/reference/generated/kubectl/kubectl-commands>commandline</a></li> </ul> <h2 id=install-helm>Install Helm<a class=headerlink href=#install-helm title="Permanent link"> ¶</a></h2> <p>Helm is the Kubernetes package manager. It doesn't come with Kubernetes.</p> <p>Three concepts of helm:</p> <ul> <li>A <em>Chart</em> is a Helm package.</li> <li>It contains all of the resource definitions necessary to run an application, tool, or service inside of a Kubernetes cluster.</li> <li>Think of it like the Kubernetes equivalent of a Homebrew formula, an Apt dpkg, or a Yum RPM file.</li> <li>A <em>Repository</em> is the place where charts can be collected and shared.</li> <li>It's like Perl's CPAN archive or the Fedora Package Database, but for Kubernetes packages.</li> <li>A <em>Release</em> is an instance of a chart running in a Kubernetes cluster.</li> <li>One chart can often be installed many times into the same cluster. And each time it is installed, a new release is created.</li> <li>Consider a MySQL chart. If you want two databases running in your cluster, you can install that chart twice. Each one will have its own release, which will in turn have its own release name.</li> </ul> <p>Reference:</p> <ul> <li><a href=https://helm.sh/docs/intro/install/ >installation guide</a></li> <li><a href=https://github.com/helm/helm/releases>binary release</a></li> <li><a href=https://github.com/helm/helm>source code</a>.</li> </ul> <p>Helm Client Installation:</p> <div class=highlight><pre><span></span><code>curl -fsSL -o get_helm.sh https://raw.githubusercontent.com/helm/helm/main/scripts/get-helm-3
chmod <span class=m>700</span> get_helm.sh
./get_helm.sh
</code></pre></div> <p>Output:</p> <div class=highlight><pre><span></span><code><span class=go>Downloading https://get.helm.sh/helm-v3.9.1-linux-amd64.tar.gz</span>
<span class=go>Verifying checksum... Done.</span>
<span class=go>Preparing to install helm into /usr/local/bin</span>
<span class=go>helm installed into /usr/local/bin/helm</span>
</code></pre></div> <p>Note:</p> <ul> <li><a href=https://helm.sh/docs/helm/helm_init/ ><code>helm init</code></a> does not exist in Helm 3, following the removal of Tiller. You no longer need to install Tiller in your cluster in order to use Helm.</li> <li><code>helm search</code> can be used to search two different types of source:</li> <li><code>helm search hub</code> searches the <a href=https://artifacthub.io/ >Artifact Hub</a>, which lists helm charts from dozens of different repositories.</li> <li><code>helm search repo</code> searches the repositories that you have added to your local helm client (with helm repo add). This search is done over local data, and no public network connection is needed.</li> </ul> <p>Reference:</p> <ul> <li><a href=../../foundamentals/helming/ >Helming development</a></li> </ul> <h2 id=reset-cluster>Reset cluster<a class=headerlink href=#reset-cluster title="Permanent link"> ¶</a></h2> <p>Caution: below steps will destroy current cluster.</p> <p>Delete all nodes in the cluster.</p> <div class=highlight><pre><span></span><code>kubeadm reset
</code></pre></div> <p>Clean up rule of <code>iptables</code>.</p> <div class=highlight><pre><span></span><code>iptables -F <span class=o>&amp;&amp;</span> iptables -t nat -F <span class=o>&amp;&amp;</span> iptables -t mangle -F <span class=o>&amp;&amp;</span> iptables -X
</code></pre></div> <p>Clean up rule of <code>IPVS</code> if using <code>IPVS</code>.</p> <div class=highlight><pre><span></span><code>ipvsadm --clear
</code></pre></div> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../single-local/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Single Node Installation" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Single Node Installation </div> </div> </a> <a href=../aliyun-ubuntu/ class="md-footer__link md-footer__link--next" aria-label="Next: Installation on Aliyun ECS" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Installation on Aliyun ECS </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>