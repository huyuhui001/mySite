<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/k8s/foundamentals/casestudy-operation-resources/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>Operations on Resources - MEMO</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#case-study-operations-on-resources class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=MEMO class="md-header__button md-logo" aria-label=MEMO data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> MEMO </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Operations on Resources </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Welcome </a> </li> <li class=md-tabs__item> <a href=../../installation/single-local/ class="md-tabs__link md-tabs__link--active"> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../../linux/Administration/01/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../python/Foundation/ch00/ class=md-tabs__link> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=MEMO class="md-nav__button md-logo" aria-label=MEMO data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> MEMO </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Welcome <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Welcome data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Welcome </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Content </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2 checked> <label class=md-nav__link for=__nav_2> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_1 type=checkbox id=__nav_2_1> <label class=md-nav__link for=__nav_2_1> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=2> <label class=md-nav__title for=__nav_2_1> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_5 type=checkbox id=__nav_2_5> <label class=md-nav__link for=__nav_2_5> Application Modelling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modelling" data-md-level=2> <label class=md-nav__title for=__nav_2_5> <span class="md-nav__icon md-icon"></span> Application Modelling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_6 type=checkbox id=__nav_2_6> <label class=md-nav__link for=__nav_2_6> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_2_6> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_7 type=checkbox id=__nav_2_7> <label class=md-nav__link for=__nav_2_7> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=2> <label class=md-nav__title for=__nav_2_7> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_8 type=checkbox id=__nav_2_8 checked> <label class=md-nav__link for=__nav_2_8> Case Study <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Case Study" data-md-level=2> <label class=md-nav__title for=__nav_2_8> <span class="md-nav__icon md-icon"></span> Case Study </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> Operations on Resources <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> Operations on Resources </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#node-label class=md-nav__link> Node Label </a> </li> <li class=md-nav__item> <a href=#annotation class=md-nav__link> Annotation </a> </li> <li class=md-nav__item> <a href=#namespace class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=#serviceaccount-authorization class=md-nav__link> ServiceAccount Authorization </a> </li> <li class=md-nav__item> <a href=#deployment class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=#expose-service class=md-nav__link> Expose Service </a> </li> <li class=md-nav__item> <a href=#scale-out-deployment class=md-nav__link> Scale out Deployment </a> </li> <li class=md-nav__item> <a href=#rolling-update class=md-nav__link> Rolling update </a> </li> <li class=md-nav__item> <a href=#event class=md-nav__link> Event </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> Logging </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_9 type=checkbox id=__nav_2_9> <label class=md-nav__link for=__nav_2_9> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_2_9> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../demo/cap_on_kyma/ class=md-nav__link> Build CAP application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_1 type=checkbox id=__nav_3_1> <label class=md-nav__link for=__nav_3_1> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_3_1> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_1 type=checkbox id=__nav_4_1> <label class=md-nav__link for=__nav_4_1> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_1> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Foundation/ch00/ class=md-nav__link> 安装 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch01/ class=md-nav__link> 语言基础 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch02/ class=md-nav__link> 打包Packing和拆包Unpacking </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch03/ class=md-nav__link> 函数及文件 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch04/ class=md-nav__link> 面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/ch05/ class=md-nav__link> 面向对象特性 </a> </li> <li class=md-nav__item> <a href=../../../python/Foundation/Algorithms/ class=md-nav__link> 数据结构和算法 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch10/ class=md-nav__link> NumPy进阶 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../../../python/DataAnalysis/ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3> <label class=md-nav__link for=__nav_4_3> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../python/Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#node-label class=md-nav__link> Node Label </a> </li> <li class=md-nav__item> <a href=#annotation class=md-nav__link> Annotation </a> </li> <li class=md-nav__item> <a href=#namespace class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=#serviceaccount-authorization class=md-nav__link> ServiceAccount Authorization </a> </li> <li class=md-nav__item> <a href=#deployment class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=#expose-service class=md-nav__link> Expose Service </a> </li> <li class=md-nav__item> <a href=#scale-out-deployment class=md-nav__link> Scale out Deployment </a> </li> <li class=md-nav__item> <a href=#rolling-update class=md-nav__link> Rolling update </a> </li> <li class=md-nav__item> <a href=#event class=md-nav__link> Event </a> </li> <li class=md-nav__item> <a href=#logging class=md-nav__link> Logging </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/k8s/foundamentals/casestudy-operation-resources.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=case-study-operations-on-resources>Case Study: Operations on Resources<a class=headerlink href=#case-study-operations-on-resources title="Permanent link"> ¶</a></h1> <div class="admonition scenario"> <p class=admonition-title>Scenario</p> <ul> <li>Node Label</li> <li>Annotation</li> <li>Namespace</li> <li>ServiceAccount Authorization<ul> <li>Grant API access authorization to default ServiceAccount</li> </ul> </li> <li>Deployment</li> <li>Expose Service</li> <li>Scale out the Deployment</li> <li>Rolling update</li> <li>Rolling back update</li> <li>Event</li> <li>Logging</li> </ul> </div> <h2 id=node-label>Node Label<a class=headerlink href=#node-label title="Permanent link"> ¶</a></h2> <ul> <li>Add/update/remove node Label.</li> </ul> <div class=highlight><pre><span></span><code><span class=gp># </span>Update node label
<span class=go>kubectl label node cka002 node=demonode</span>

<span class=gp># </span>Get node info with label info
<span class=go>kubectl get node --show-labels</span>

<span class=gp># </span>Search node by label
<span class=go>kubectl get node -l node=demonode</span>

<span class=gp># </span>Remove a lable of node
<span class=go>kubectl label node cka002 node-</span>
</code></pre></div> <h2 id=annotation>Annotation<a class=headerlink href=#annotation title="Permanent link"> ¶</a></h2> <p>Create Nginx deployment <div class=highlight><pre><span></span><code><span class=go>kubectl create deploy nginx --image=nginx:mainline</span>
</code></pre></div></p> <p>Get Annotation info. <div class=highlight><pre><span></span><code><span class=go>kubectl describe deployment/nginx</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>......
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=nginx
......
</code></pre></div></p> <p>Add new Annotation. <div class=highlight><pre><span></span><code><span class=go>kubectl annotate deployment nginx owner=James.H</span>
</code></pre></div></p> <p>Now annotation looks like below. <div class=highlight><pre><span></span><code>......
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 1
                        owner: James.H
Selector:               app=nginx
......
</code></pre></div></p> <p>Update/Overwrite Annotation. <div class=highlight><pre><span></span><code><span class=go>kubectl annotate deployment/nginx owner=K8s --overwrite</span>
</code></pre></div> Now annotation looks like below. <div class=highlight><pre><span></span><code>......
Annotations:            deployment.kubernetes.io/revision: 1
                        owner: K8s
Selector:               app=nginx
......
</code></pre></div></p> <p>Remove Annotation <div class=highlight><pre><span></span><code><span class=go>kubectl annotate deployment/nginx owner-</span>
</code></pre></div> <div class=highlight><pre><span></span><code>......
Labels:                 app=nginx
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=nginx
......
</code></pre></div></p> <p>Clean up <div class=highlight><pre><span></span><code><span class=go>kubectl delete deployment nginx</span>
</code></pre></div></p> <h2 id=namespace>Namespace<a class=headerlink href=#namespace title="Permanent link"> ¶</a></h2> <ul> <li>Get current available namespaces.</li> </ul> <p><div class=highlight><pre><span></span><code><span class=go>kubectl get namespace</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>NAME              STATUS   AGE
default           Active   3h45m
dev               Active   3h11m
kube-node-lease   Active   3h45m
kube-public       Active   3h45m
kube-system       Active   3h45m
</code></pre></div></p> <ul> <li>Get Pod under a specific namespace.</li> </ul> <p><div class=highlight><pre><span></span><code><span class=go>kubectl get pod -n kube-system</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>NAME                                       READY   STATUS    RESTARTS   AGE
calico-kube-controllers-5c64b68895-jr4nl   1/1     Running   0          3h25m
calico-node-dsx76                          1/1     Running   0          3h25m
calico-node-p5rf2                          1/1     Running   0          3h25m
calico-node-tr22l                          1/1     Running   0          3h25m
coredns-6d8c4cb4d-g4jxc                    1/1     Running   0          3h45m
coredns-6d8c4cb4d-sqcvj                    1/1     Running   0          3h45m
etcd-cka001                                1/1     Running   0          3h45m
kube-apiserver-cka001                      1/1     Running   0          3h45m
kube-controller-manager-cka001             1/1     Running   0          3h45m
kube-proxy-5cdbj                           1/1     Running   0          3h41m
kube-proxy-cm4hc                           1/1     Running   0          3h45m
kube-proxy-g4w52                           1/1     Running   0          3h41m
kube-scheduler-cka001                      1/1     Running   0          3h45m
</code></pre></div></p> <ul> <li>Get Pods in all namespaces.</li> </ul> <div class=highlight><pre><span></span><code><span class=go>kubectl get pod --all-namespaces</span>
<span class=go>kubectl get pod -A</span>
</code></pre></div> <h2 id=serviceaccount-authorization>ServiceAccount Authorization<a class=headerlink href=#serviceaccount-authorization title="Permanent link"> ¶</a></h2> <p>With Kubernetes 1.23 and lower version, when we create a new namespace, Kubernetes will automatically create a ServiceAccount <code>default</code> and a token <code>default-token-xxxxx</code>.</p> <p>With Kubernetes 1.24, only ServiceAccount <code>default</code> is created automatically when a new namespace is created, need manually create a toke linked to the ServiceAccount <code>default</code>.</p> <p>Here is an example to create a new namespace <code>dev</code>, we can see that only ServiceAcccount: <code>default</code> was created in namespace <code>dev</code>, no secretes (token) linked to the ServiceAccount <code>default</code>.</p> <div class=highlight><pre><span></span><code><span class=go>kubectl create namespace dev</span>
<span class=go>kubectl get serviceaccount -n dev</span>
<span class=go>kubectl get secrets -n dev</span>
</code></pre></div> <p>There is a default cluster role <code>admin</code>. But there is no clusterrole binding to the cluster role <code>admin</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl get clusterrole admin</span>
<span class=go>kubectl get clusterrolebinding | grep ClusterRole/admin</span>
</code></pre></div></p> <p>Role and rolebinding is namespaces based. On namespace <code>dev</code>, there is no role and rolebinding. <div class=highlight><pre><span></span><code><span class=go>kubectl get role -n dev</span>
<span class=go>kubectl get rolebinding -n dev</span>
</code></pre></div></p> <p>A Secret in the Kubernetes cluster is an object and it is used to store sensitive information such as username, password, and token, etc. The objective of Secrets is to encode or hash the credentials. The secrets can be reused in the various Pod definition file.</p> <p>A <code>kubernetes.io/service-account-token</code> type of Secret is used to store a token that identifies a service account. When using this Secret type, you need to ensure that the <code>kubernetes.io/service-account.name</code> annotation is set to an existing service account name.</p> <p>Let's create token for the ServiceAcccount: <code>default</code> in namespace <code>dev</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl apply -f - &lt;&lt; EOF</span>
<span class=go>apiVersion: v1</span>
<span class=go>kind: Secret</span>
<span class=go>metadata:</span>
<span class=go>  name: default-token-dev</span>
<span class=go>  namespace: dev</span>
<span class=go>  annotations:</span>
<span class=go>    kubernetes.io/service-account.name: &quot;default&quot;</span>
<span class=go>type: kubernetes.io/service-account-token</span>

<span class=go>EOF</span>
</code></pre></div></p> <p>Now we get ServiceAcccount: <code>default</code> and Secret (token) <code>default-token-dev</code> in namespace <code>dev</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl get serviceaccount -n dev</span>
<span class=go>kubectl get secrets -n dev</span>
</code></pre></div></p> <p>Get token of the service account <code>default</code>. <div class=highlight><pre><span></span><code><span class=go>TOKEN=$(kubectl -n dev describe secret $(kubectl -n dev get secrets | grep default | cut -f1 -d &#39; &#39;) | grep -E &#39;^token&#39; | cut -f2 -d&#39;:&#39; | tr -d &#39; &#39;)</span>
<span class=go>echo $TOKEN</span>
</code></pre></div></p> <p>Get API Service address. <div class=highlight><pre><span></span><code><span class=go>APISERVER=$(kubectl config view | grep https | cut -f 2- -d &quot;:&quot; | tr -d &quot; &quot;)</span>
<span class=go>echo $APISERVER</span>
</code></pre></div></p> <p>Get Pod resources in namespace <code>dev</code> via API server with JSON layout. <div class=highlight><pre><span></span><code><span class=go>curl $APISERVER/api/v1/namespaces/dev/pods --header &quot;Authorization: Bearer $TOKEN&quot; --insecure</span>
</code></pre></div></p> <p>We will receive <code>403 forbidden</code> error message. The ServiceAccount <code>default</code> does not have authorization to access pod in namespace <code>dev</code>.</p> <p>Let's create a rolebinding <code>rolebinding-admin</code> to bind cluster role <code>admin</code> to service account <code>default</code> in namespapce <code>dev</code>. Hence service account <code>default</code> is granted adminstrator authorization in namespace <code>dev</code>. <div class=highlight><pre><span></span><code><span class=gp># </span>Usage:
<span class=go>kubectl create rolebinding &lt;rule&gt; --clusterrole=&lt;clusterrule&gt; --serviceaccount=&lt;namespace&gt;:&lt;name&gt; --namespace=&lt;namespace&gt;</span>

<span class=gp># </span>Crate rolebinding:
<span class=go>kubectl create rolebinding rolebinding-admin --clusterrole=admin --serviceaccount=dev:default --namespace=dev</span>
</code></pre></div></p> <p>Result looks like below by executing <code>kubectl get rolebinding -n dev</code>. <div class=highlight><pre><span></span><code>NAME                ROLE                AGE
rolebinding-admin   ClusterRole/admin   10s
</code></pre></div></p> <p>Try again, get pod resources in namespace <code>dev</code> via API server with JSON layout. <div class=highlight><pre><span></span><code><span class=go>curl $APISERVER/api/v1/namespaces/dev/pods --header &quot;Authorization: Bearer $TOKEN&quot; --insecure</span>
</code></pre></div></p> <p>Clean up. <div class=highlight><pre><span></span><code><span class=go>kubectl delete namespace dev</span>
</code></pre></div></p> <h2 id=deployment>Deployment<a class=headerlink href=#deployment title="Permanent link"> ¶</a></h2> <p>Create a Ubuntu Pod for operation. And attach to the running Pod. <div class=highlight><pre><span></span><code><span class=go>kubectl create -f - &lt;&lt; EOF</span>
<span class=go>apiVersion: v1</span>
<span class=go>kind: Pod</span>
<span class=go>metadata:</span>
<span class=go>  name: ubuntu</span>
<span class=go>  labels:</span>
<span class=go>    app: ubuntu</span>
<span class=go>spec:</span>
<span class=go>  containers:</span>
<span class=go>  - name: ubuntu</span>
<span class=go>    image: ubuntu:latest</span>
<span class=go>    command: [&quot;/bin/sleep&quot;, &quot;3650d&quot;]</span>
<span class=go>    imagePullPolicy: IfNotPresent</span>
<span class=go>  restartPolicy: Always</span>
<span class=go>EOF</span>

<span class=go>kubectl exec --stdin --tty ubuntu -- /bin/bash</span>
</code></pre></div></p> <p>Create a deployment, option <code>--image</code> specifies a image，option <code>--port</code> specifies port for external access. A pod is also created when deployment is created. <div class=highlight><pre><span></span><code><span class=go>kubectl create deployment myapp --image=docker.io/jocatalin/kubernetes-bootcamp:v1 --replicas=1 --port=8080</span>
</code></pre></div></p> <p>Get deployment status <div class=highlight><pre><span></span><code><span class=go>kubectl get deployment myapp -o wide</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>NAME    READY   UP-TO-DATE   AVAILABLE   AGE   CONTAINERS            IMAGES                                       SELECTOR
myapp   1/1     1            1           79s   kubernetes-bootcamp   docker.io/jocatalin/kubernetes-bootcamp:v1   app=myapp
</code></pre></div></p> <p>Get detail information of deployment. <div class=highlight><pre><span></span><code><span class=go>kubectl describe deployment myapp</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>Name:                   myapp
Namespace:              dev
CreationTimestamp:      Sat, 23 Jul 2022 14:36:43 +0800
Labels:                 app=myapp
Annotations:            deployment.kubernetes.io/revision: 1
Selector:               app=myapp
Replicas:               1 desired | 1 updated | 1 total | 1 available | 0 unavailable
StrategyType:           RollingUpdate
MinReadySeconds:        0
RollingUpdateStrategy:  25% max unavailable, 25% max surge
Pod Template:
  Labels:  app=myapp
  Containers:
   kubernetes-bootcamp:
    Image:        docker.io/jocatalin/kubernetes-bootcamp:v1
    Port:         8080/TCP
    Host Port:    0/TCP
    Environment:  &lt;none&gt;
    Mounts:       &lt;none&gt;
  Volumes:        &lt;none&gt;
Conditions:
  Type           Status  Reason
  ----           ------  ------
  Available      True    MinimumReplicasAvailable
  Progressing    True    NewReplicaSetAvailable
OldReplicaSets:  &lt;none&gt;
NewReplicaSet:   myapp-b5d775f5d (1/1 replicas created)
Events:
  Type    Reason             Age   From                   Message
  ----    ------             ----  ----                   -------
  Normal  ScalingReplicaSet  95s   deployment-controller  Scaled up replica set myapp-b5d775f5d to 1
</code></pre></div></p> <h2 id=expose-service>Expose Service<a class=headerlink href=#expose-service title="Permanent link"> ¶</a></h2> <p>Get the Pod and Deployment we created just now. <div class=highlight><pre><span></span><code><span class=go>kubectl get deployment myapp -o wide</span>
<span class=go>kubectl get pod -o wide</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>NAME                    READY   STATUS    RESTARTS   AGE     IP             NODE     NOMINATED NODE   READINESS GATES
myapp-b5d775f5d-cx8dx   1/1     Running   0          2m34s   10.244.102.7   cka003   &lt;none&gt;           &lt;none&gt;
</code></pre></div></p> <p>Send http request to the Pod <code>curl 10.244.102.7:8080</code> with below result. <div class=highlight><pre><span></span><code>Hello Kubernetes bootcamp! | Running on: myapp-b5d775f5d-6jtgs | v=1
</code></pre></div></p> <p>To make pod be accessed outside, we need expose port <code>8080</code> to a node port. A related service will be created. <div class=highlight><pre><span></span><code><span class=go>kubectl expose deployment myapp --type=NodePort --port=8080</span>
</code></pre></div></p> <p>Get details of service <code>myapp</code> by executing <code>kubectl get svc myapp -o wide</code>. <div class=highlight><pre><span></span><code>NAME    TYPE       CLUSTER-IP    EXTERNAL-IP   PORT(S)          AGE   SELECTOR
myapp   NodePort   11.244.74.3   &lt;none&gt;        8080:30514/TCP   7s    app=myapp
</code></pre></div></p> <p>Send http request to service port. <div class=highlight><pre><span></span><code><span class=go>curl 11.244.74.3:8080</span>
<span class=go>Hello Kubernetes bootcamp! | Running on: myapp-b5d775f5d-cx8dx | v=1</span>
</code></pre></div></p> <p>Get more details of the service. <div class=highlight><pre><span></span><code><span class=go>kubectl get svc myapp -o yaml</span>
<span class=go>kubectl describe svc myapp</span>
</code></pre></div></p> <p>Get details of related endpoint <code>myapp</code> by executing <code>kubectl get endpoints myapp -o wide</code>. <div class=highlight><pre><span></span><code>NAME    ENDPOINTS           AGE
myapp   10.244.102.7:8080   43s
</code></pre></div></p> <p>Send http request to the service and node sucessfully. Pod port <code>8080</code> is mapped to node port <code>32566</code>.</p> <p>Send http request to node port on <code>cka003</code>. <div class=highlight><pre><span></span><code><span class=go>curl &lt;cka003_node_ip&gt;:30514</span>
<span class=go>Hello Kubernetes bootcamp! | Running on: myapp-b5d775f5d-6jtgs | v=1</span>
</code></pre></div></p> <p>Attach to Ubuntu Pod we created and send http request to the Service and Pod and Node of <code>myapp</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl exec --stdin --tty ubuntu -- /bin/bash</span>
<span class=go>curl 10.244.102.7:8080</span>
<span class=go>curl 11.244.74.3:8080</span>
<span class=go>curl &lt;cka003_node_ip&gt;:30514</span>
<span class=go>Hello Kubernetes bootcamp! | Running on: myapp-b5d775f5d-6jtgs | v=1</span>
</code></pre></div></p> <h2 id=scale-out-deployment>Scale out Deployment<a class=headerlink href=#scale-out-deployment title="Permanent link"> ¶</a></h2> <p>Scale out by replicaset. We set three replicasets to scale out deployment <code>myapp</code>. The number of deployment <code>myapp</code> is now three. <div class=highlight><pre><span></span><code><span class=go>kubectl scale deployment myapp --replicas=3</span>
</code></pre></div></p> <p>Get status of deployment <div class=highlight><pre><span></span><code><span class=go>kubectl get deployment myapp</span>
</code></pre></div></p> <p>Get status of replicaset <div class=highlight><pre><span></span><code><span class=go>kubectl get replicaset</span>
</code></pre></div></p> <h2 id=rolling-update>Rolling update<a class=headerlink href=#rolling-update title="Permanent link"> ¶</a></h2> <p>Command usage: <code>kubectl set image (-f FILENAME | TYPE NAME) CONTAINER_NAME_1=CONTAINER_IMAGE_1 ... CONTAINER_NAME_N=CONTAINER_IMAGE_N</code>.</p> <p>With the command <code>kubectl get deployment</code>, we will get deployment name <code>myapp</code> and related container name <code>kubernetes-bootcamp</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl get deployment myapp -o wide</span>
</code></pre></div></p> <p>With the command <code>kubectl set image</code> to update image to many versions and log the change under deployment's annotations with option <code>--record</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl set image deployment/myapp kubernetes-bootcamp=docker.io/jocatalin/kubernetes-bootcamp:v2 --record</span>
</code></pre></div></p> <p>Current replicas status <div class=highlight><pre><span></span><code><span class=go>kubectl get replicaset -o wide -l app=myapp</span>
</code></pre></div> Result. Pods are running on new Replicas. <div class=highlight><pre><span></span><code>NAME               DESIRED   CURRENT   READY   AGE   CONTAINERS            IMAGES                                       SELECTOR
myapp-5dbd68cc99   1         1         0       8s    kubernetes-bootcamp   docker.io/jocatalin/kubernetes-bootcamp:v2   app=myapp,pod-template-hash=5dbd68cc99
myapp-b5d775f5d    3         3         3       14m   kubernetes-bootcamp   docker.io/jocatalin/kubernetes-bootcamp:v1   app=myapp,pod-template-hash=b5d775f5d
</code></pre></div></p> <p>We can get the change history under <code>metadata.annotations</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl get deployment myapp -o yaml</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>apiVersion: apps/v1
kind: Deployment
metadata:
  annotations:
    deployment.kubernetes.io/revision: &quot;2&quot;
    kubernetes.io/change-cause: kubectl set image deployment/myapp kubernetes-bootcamp=docker.io/jocatalin/kubernetes-bootcamp:v2
      --record=true
  ......
</code></pre></div></p> <p>We can also get the change history by command <code>kubectl rollout history</code>, and show details with specific revision <code>--revision=&lt;revision_number&gt;</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl rollout history deployment/myapp</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>deployment.apps/myapp 
REVISION  CHANGE-CAUSE
1         &lt;none&gt;
2         kubectl set image deployment/myapp kubernetes-bootcamp=docker.io/jocatalin/kubernetes-bootcamp:v2 --record=true
</code></pre></div></p> <p>Get rollout history with specific revision. <div class=highlight><pre><span></span><code><span class=go>kubectl rollout history deployment/myapp --revision=2</span>
</code></pre></div></p> <p>Roll back to previous revision with command <code>kubectl rollout undo</code>, or roll back to specific revision with option <code>--to-revision=&lt;revision_number&gt;</code>. <div class=highlight><pre><span></span><code><span class=go>kubectl rollout undo deployment/myapp --to-revision=1</span>
</code></pre></div></p> <p>Revision <code>1</code> was replaced by new revision <code>3</code> now. <div class=highlight><pre><span></span><code><span class=go>kubectl rollout history deployment/myapp</span>
</code></pre></div> Result <div class=highlight><pre><span></span><code>deployment.apps/myapp 
REVISION  CHANGE-CAUSE
2         kubectl set image deployment/myapp kubernetes-bootcamp=docker.io/jocatalin/kubernetes-bootcamp:v2 --record=true
3         &lt;none&gt;
</code></pre></div></p> <h2 id=event>Event<a class=headerlink href=#event title="Permanent link"> ¶</a></h2> <p>Get detail event info of related Pod. <div class=highlight><pre><span></span><code><span class=go>kubectl describe pod myapp-b5d775f5d-jlx6g</span>
</code></pre></div></p> <p>Result looks like below. <div class=highlight><pre><span></span><code>......
Events:
  Type    Reason     Age   From               Message
  ----    ------     ----  ----               -------
  Normal  Scheduled  54s   default-scheduler  Successfully assigned dev/myapp-b5d775f5d-jlx6g to cka003
  Normal  Pulled     53s   kubelet            Container image &quot;docker.io/jocatalin/kubernetes-bootcamp:v1&quot; already present on machine
  Normal  Created    53s   kubelet            Created container kubernetes-bootcamp
  Normal  Started    53s   kubelet            Started container kubernetes-bootcamp
</code></pre></div></p> <p>Get detail event info of entire cluster. <div class=highlight><pre><span></span><code><span class=go>kubectl get event</span>
</code></pre></div></p> <h2 id=logging>Logging<a class=headerlink href=#logging title="Permanent link"> ¶</a></h2> <p>Get log info of Pod. <div class=highlight><pre><span></span><code><span class=go>kubectl logs -f &lt;pod_name&gt;</span>
<span class=go>kubectl logs -f &lt;pod_name&gt; -c &lt;container_name&gt; </span>
</code></pre></div></p> <p>Get a Pod logs <div class=highlight><pre><span></span><code><span class=go>kubectl logs -f myapp-b5d775f5d-jlx6g</span>
</code></pre></div> <div class=highlight><pre><span></span><code>Kubernetes Bootcamp App Started At: 2022-07-23T06:54:18.532Z | Running On:  myapp-b5d775f5d-jlx6g
</code></pre></div></p> <p>Get log info of K8s components. <div class=highlight><pre><span></span><code><span class=go>kubectl logs kube-apiserver-cka001 -n kube-system</span>
<span class=go>kubectl logs kube-controller-manager-cka001 -n kube-system</span>
<span class=go>kubectl logs kube-scheduler-cka001 -n kube-system</span>
<span class=go>kubectl logs etcd-cka001 -n kube-system</span>
<span class=go>systemctl status kubelet</span>
<span class=go>journalctl -fu kubelet</span>
<span class=go>kubectl logs kube-proxy-5cdbj -n kube-system</span>
</code></pre></div></p> <p>Clean up. <div class=highlight><pre><span></span><code><span class=go>kubectl delete service myapp</span>
<span class=go>kubectl delete deployment myapp</span>
</code></pre></div></p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../helming/ class="md-footer__link md-footer__link--prev" aria-label="Previous: Helming" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> Helming </div> </div> </a> <a href=../casestudy-health-check/ class="md-footer__link md-footer__link--next" aria-label="Next: Health Check" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Health Check </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>