<!doctype html><html lang=en class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><link href=https://huyuhui001.github.io/mySite/python/DataAnalysis/ch10/ rel=canonical><link rel=icon href=../../../assets/images/favicon.png><meta name=generator content="mkdocs-1.3.1, mkdocs-material-8.4.3"><title>NumPy进阶 - 知行斋</title><link rel=stylesheet href=../../../assets/stylesheets/main.6b80c2a2.min.css><link rel=stylesheet href=../../../assets/stylesheets/palette.cbb835fc.min.css><meta name=theme-color content=#009485><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback"><style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style><link rel=stylesheet href=../../../extra.css><script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script></head> <body dir=ltr data-md-color-scheme data-md-color-primary=teal data-md-color-accent=green> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#numpy class=md-skip> Skip to content </a> </div> <div data-md-component=announce> </div> <header class="md-header md-header--lifted" data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../.. title=知行斋 class="md-header__button md-logo" aria-label=知行斋 data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> 知行斋 </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> NumPy进阶 </span> </div> </div> </div> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=Search placeholder=Search autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </label> <nav class=md-search__options aria-label=Search> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg> </button> </nav> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> Initializing search </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> </nav> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../.. class=md-tabs__link> Site </a> </li> <li class=md-tabs__item> <a href=../../../linux/ class=md-tabs__link> Linux </a> </li> <li class=md-tabs__item> <a href=../../../k8s/ class=md-tabs__link> Kubernetes </a> </li> <li class=md-tabs__item> <a href=../../ class="md-tabs__link md-tabs__link--active"> Python </a> </li> </ul> </div> </nav> </header> <div class=md-container data-md-component=container> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../.. title=知行斋 class="md-nav__button md-logo" aria-label=知行斋 data-md-component=logo> <img src=../../../assets/logo.jpg alt=logo> </a> 知行斋 </label> <div class=md-nav__source> <a href=https://github.com/huyuhui001/mySite title="Go to repository" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><!-- Font Awesome Free 6.2.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> huyuhui001/mySite </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_1 type=checkbox id=__nav_1> <label class=md-nav__link for=__nav_1> Site <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Site data-md-level=1> <label class=md-nav__title for=__nav_1> <span class="md-nav__icon md-icon"></span> Site </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../.. class=md-nav__link> Index </a> </li> <li class=md-nav__item> <a href=../../../about/ class=md-nav__link> About </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> Linux <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Linux data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> Linux </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_2 type=checkbox id=__nav_2_2> <label class=md-nav__link for=__nav_2_2> Linux SRE <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Linux SRE" data-md-level=2> <label class=md-nav__title for=__nav_2_2> <span class="md-nav__icon md-icon"></span> Linux SRE </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/SRE/01-fundamentals/ class=md-nav__link> 第一章 Linux基础 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/02-filesystem/ class=md-nav__link> 第二章 文件系统 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/03-identity-security/ class=md-nav__link> 第三章 身份与安全 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/04-TextTools/ class=md-nav__link> 第四章 文本编辑 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/05-RegExpress/ class=md-nav__link> 第五章 正则表达式 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/06-FileLookup/ class=md-nav__link> 第六章 文件查找 </a> </li> <li class=md-nav__item> <a href=../../../linux/SRE/07-FilePacking/ class=md-nav__link> 第七章 文件打包和解包 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_3 type=checkbox id=__nav_2_3> <label class=md-nav__link for=__nav_2_3> SUSE Linux Administration <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Linux Administration" data-md-level=2> <label class=md-nav__title for=__nav_2_3> <span class="md-nav__icon md-icon"></span> SUSE Linux Administration </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/Administration/01/ class=md-nav__link> Linux File System Overview </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/02/ class=md-nav__link> Useful Commands </a> </li> <li class=md-nav__item> <a href=../../../linux/Administration/03/ class=md-nav__link> Shell </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2_4 type=checkbox id=__nav_2_4> <label class=md-nav__link for=__nav_2_4> SUSE Enterprise Storage Foundation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="SUSE Enterprise Storage Foundation" data-md-level=2> <label class=md-nav__title for=__nav_2_4> <span class="md-nav__icon md-icon"></span> SUSE Enterprise Storage Foundation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_memo/ class=md-nav__link> SUSE Enterprise Storage Foundation </a> </li> <li class=md-nav__item> <a href=../../../linux/SES/linux_ses_demo/ class=md-nav__link> SUSE Enterprise Storage Basic Operation </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Kubernetes data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2 type=checkbox id=__nav_3_2> <label class=md-nav__link for=__nav_3_2> CKA Learning Memo <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="CKA Learning Memo" data-md-level=2> <label class=md-nav__title for=__nav_3_2> <span class="md-nav__icon md-icon"></span> CKA Learning Memo </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_1 type=checkbox id=__nav_3_2_1> <label class=md-nav__link for=__nav_3_2_1> Installation <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Installation data-md-level=3> <label class=md-nav__title for=__nav_3_2_1> <span class="md-nav__icon md-icon"></span> Installation </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/installation/single-local/ class=md-nav__link> Single Node Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/installation/multiple-local/ class=md-nav__link> Multiple Nodes Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/installation/aliyun-ubuntu/ class=md-nav__link> Installation on Aliyun ECS </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_2 type=checkbox id=__nav_3_2_2> <label class=md-nav__link for=__nav_3_2_2> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=3> <label class=md-nav__title for=__nav_3_2_2> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/docker/ class=md-nav__link> Fundamentals </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_3 type=checkbox id=__nav_3_2_3> <label class=md-nav__link for=__nav_3_2_3> Foundamentals <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Foundamentals data-md-level=3> <label class=md-nav__title for=__nav_3_2_3> <span class="md-nav__icon md-icon"></span> Foundamentals </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/memo/ class=md-nav__link> Memo </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/overview/ class=md-nav__link> Overview </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/basics/ class=md-nav__link> kubectl basics </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_4 type=checkbox id=__nav_3_2_4> <label class=md-nav__link for=__nav_3_2_4> Core Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Core Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_4> <span class="md-nav__icon md-icon"></span> Core Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_5 type=checkbox id=__nav_3_2_5> <label class=md-nav__link for=__nav_3_2_5> Application Modeling <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Application Modeling" data-md-level=3> <label class=md-nav__title for=__nav_3_2_5> <span class="md-nav__icon md-icon"></span> Application Modeling </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/secrets/ class=md-nav__link> Secrets </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/rbac/ class=md-nav__link> Role Based Access Control (RBAC) </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/ingress/ class=md-nav__link> Ingress </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_6 type=checkbox id=__nav_3_2_6> <label class=md-nav__link for=__nav_3_2_6> Advanced Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Advanced Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_6> <span class="md-nav__icon md-icon"></span> Advanced Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_7 type=checkbox id=__nav_3_2_7> <label class=md-nav__link for=__nav_3_2_7> Operating Kubernetes <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Operating Kubernetes" data-md-level=3> <label class=md-nav__title for=__nav_3_2_7> <span class="md-nav__icon md-icon"></span> Operating Kubernetes </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/healthcheck/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/helming/ class=md-nav__link> Helming </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_2_8 type=checkbox id=__nav_3_2_8> <label class=md-nav__link for=__nav_3_2_8> Topics <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Topics data-md-level=3> <label class=md-nav__title for=__nav_3_2_8> <span class="md-nav__icon md-icon"></span> Topics </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/casestudy-operation-resources/ class=md-nav__link> Operations on Resources </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/casestudy-health-check/ class=md-nav__link> Health Check </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/casestudy-calico/ class=md-nav__link> Calico Installation </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_en/foundamentals/kyma/ class=md-nav__link> Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3 type=checkbox id=__nav_3_3> <label class=md-nav__link for=__nav_3_3> CKA学习笔记 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=CKA学习笔记 data-md-level=2> <label class=md-nav__title for=__nav_3_3> <span class="md-nav__icon md-icon"></span> CKA学习笔记 </label> <ul class=md-nav__list data-md-scrollfix> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_1 type=checkbox id=__nav_3_3_1> <label class=md-nav__link for=__nav_3_3_1> 安装 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=安装 data-md-level=3> <label class=md-nav__title for=__nav_3_3_1> <span class="md-nav__icon md-icon"></span> 安装 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/installation/single-local/ class=md-nav__link> 单节点虚拟机安装Kubernetes </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/installation/multiple-local/ class=md-nav__link> 多节点虚拟机安装Kubernetes </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/installation/aliyun-ubuntu/ class=md-nav__link> 阿里云ECS安装Kubernetes </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_2 type=checkbox id=__nav_3_3_2> <label class=md-nav__link for=__nav_3_3_2> Docker <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Docker data-md-level=3> <label class=md-nav__title for=__nav_3_3_2> <span class="md-nav__icon md-icon"></span> Docker </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/docker/ class=md-nav__link> Docker基础 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_3 type=checkbox id=__nav_3_3_3> <label class=md-nav__link for=__nav_3_3_3> 基础知识 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=基础知识 data-md-level=3> <label class=md-nav__title for=__nav_3_3_3> <span class="md-nav__icon md-icon"></span> 基础知识 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/memo/ class=md-nav__link> Kubernetes随笔 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/overview/ class=md-nav__link> Kubernetes集群概览 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/basics/ class=md-nav__link> kubectl基础 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_4 type=checkbox id=__nav_3_3_4> <label class=md-nav__link for=__nav_3_3_4> 核心概念 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=核心概念 data-md-level=3> <label class=md-nav__title for=__nav_3_3_4> <span class="md-nav__icon md-icon"></span> 核心概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/pod/ class=md-nav__link> Pod </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/deployment/ class=md-nav__link> Deployment </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/service/ class=md-nav__link> Service </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_5 type=checkbox id=__nav_3_3_5> <label class=md-nav__link for=__nav_3_3_5> 应用体系 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=应用体系 data-md-level=3> <label class=md-nav__title for=__nav_3_3_5> <span class="md-nav__icon md-icon"></span> 应用体系 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/namespace/ class=md-nav__link> Namespace </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/statefulset/ class=md-nav__link> StatefulSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/daemonset/ class=md-nav__link> DaemonSet </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/job/ class=md-nav__link> Job and Cronjob </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/configuration/ class=md-nav__link> Configuration </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/secrets/ class=md-nav__link> secrets </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/persistence/ class=md-nav__link> Persistence </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/rbac/ class=md-nav__link> RBAC鉴权 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/ingress/ class=md-nav__link> Ingress-nginx </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_6 type=checkbox id=__nav_3_3_6> <label class=md-nav__link for=__nav_3_3_6> 进阶概念 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=进阶概念 data-md-level=3> <label class=md-nav__title for=__nav_3_3_6> <span class="md-nav__icon md-icon"></span> 进阶概念 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/scheduling/ class=md-nav__link> Scheduling </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/hpa/ class=md-nav__link> Horizontal Pod Autoscaling (HPA) </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/policy/ class=md-nav__link> Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/networkpolicy/ class=md-nav__link> Network Policy </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/clustermgt/ class=md-nav__link> Cluster Management </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_7 type=checkbox id=__nav_3_3_7> <label class=md-nav__link for=__nav_3_3_7> 日常维护 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=日常维护 data-md-level=3> <label class=md-nav__title for=__nav_3_3_7> <span class="md-nav__icon md-icon"></span> 日常维护 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/troubleshooting/ class=md-nav__link> Troubleshooting </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/healthcheck/ class=md-nav__link> 健康检查 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/helming/ class=md-nav__link> Helm Chart </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_3_8 type=checkbox id=__nav_3_3_8> <label class=md-nav__link for=__nav_3_3_8> 主题讨论 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=主题讨论 data-md-level=3> <label class=md-nav__title for=__nav_3_3_8> <span class="md-nav__icon md-icon"></span> 主题讨论 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/casestudy-operation-resources/ class=md-nav__link> Kubernetes资源常见操作 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/casestudy-health-check/ class=md-nav__link> 健康检查 </a> </li> <li class=md-nav__item> <a href=../../../k8s/cka_cn/foundamentals/casestudy-calico/ class=md-nav__link> 安装Calico </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3_4 type=checkbox id=__nav_3_4> <label class=md-nav__link for=__nav_3_4> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_3_4> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../k8s/demo/cap_on_kyma/ class=md-nav__link> Build CAP Application on Kyma </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4 checked> <label class=md-nav__link for=__nav_4> Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../ class=md-nav__link> Index </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_2 type=checkbox id=__nav_4_2> <label class=md-nav__link for=__nav_4_2> Python基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python基础 data-md-level=2> <label class=md-nav__title for=__nav_4_2> <span class="md-nav__icon md-icon"></span> Python基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Foundation/ch00/ class=md-nav__link> Python安装 </a> </li> <li class=md-nav__item> <a href=../../Foundation/ch01/ class=md-nav__link> Python语言基础 </a> </li> <li class=md-nav__item> <a href=../../Foundation/ch02/ class=md-nav__link> Python打包和解包 </a> </li> <li class=md-nav__item> <a href=../../Foundation/ch03/ class=md-nav__link> Python内置函数及文件 </a> </li> <li class=md-nav__item> <a href=../../Foundation/ch04/ class=md-nav__link> Python面向对象概念 </a> </li> <li class=md-nav__item> <a href=../../Foundation/ch05/ class=md-nav__link> Python面向对象三大特性 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--active md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_3 type=checkbox id=__nav_4_3 checked> <label class=md-nav__link for=__nav_4_3> Python数据分析基础 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Python数据分析基础 data-md-level=2> <label class=md-nav__title for=__nav_4_3> <span class="md-nav__icon md-icon"></span> Python数据分析基础 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../ch01/ class=md-nav__link> NumPy基础 </a> </li> <li class="md-nav__item md-nav__item--active"> <input class="md-nav__toggle md-toggle" data-md-toggle=toc type=checkbox id=__toc> <label class="md-nav__link md-nav__link--active" for=__toc> NumPy进阶 <span class="md-nav__icon md-icon"></span> </label> <a href=./ class="md-nav__link md-nav__link--active"> NumPy进阶 </a> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ndarray class=md-nav__link> ndarray对象的内部机理 </a> <nav class=md-nav aria-label=ndarray对象的内部机理> <ul class=md-nav__list> <li class=md-nav__item> <a href=#numpy-dtype class=md-nav__link> NumPy dtype层次结构 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 高级数组操作 </a> <nav class=md-nav aria-label=高级数组操作> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 重塑数组 </a> </li> <li class=md-nav__item> <a href=#cf class=md-nav__link> C顺序和F顺序 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 数组连接和分隔 </a> </li> <li class=md-nav__item> <a href=#r_c_ class=md-nav__link> 数组堆叠的方法：r_和c_ </a> </li> <li class=md-nav__item> <a href=#tilerepeat class=md-nav__link> 重复元素：tile和repeat </a> </li> <li class=md-nav__item> <a href=#fancy-indexingtakeput class=md-nav__link> 神奇索引（Fancy Indexing）的等价方法：take和put </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 广播 </a> <nav class=md-nav aria-label=广播> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 广播的规则 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 一维广播 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 二维广播 </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 三维广播 </a> </li> <li class=md-nav__item> <a href=#n class=md-nav__link> N维广播 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 通过广播设定数组的值 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ufunc class=md-nav__link> ufunc高级应用 </a> <nav class=md-nav aria-label=ufunc高级应用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ufunc_1 class=md-nav__link> ufunc实例方法 </a> </li> <li class=md-nav__item> <a href=#pythonufunc class=md-nav__link> 使用Python编写新的ufunc方法 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 结构化和记录式数组 </a> <nav class=md-nav aria-label=结构化和记录式数组> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dtype class=md-nav__link> 嵌套dtype和多维字段 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 为什么要使用结构化数组 </a> </li> </ul> </nav> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=../ch02/ class=md-nav__link> Pandas入门 </a> </li> <li class=md-nav__item> <a href=../ch03/ class=md-nav__link> 数据载入、存储及文件格式 </a> </li> <li class=md-nav__item> <a href=../ch04/ class=md-nav__link> 数据清洗与准备 </a> </li> <li class=md-nav__item> <a href=../ch05/ class=md-nav__link> 数据规整：连接、联合与重塑 </a> </li> <li class=md-nav__item> <a href=../ch06/ class=md-nav__link> 绘图与可视化 </a> </li> <li class=md-nav__item> <a href=../ch07/ class=md-nav__link> 数据聚合与分组操作 </a> </li> <li class=md-nav__item> <a href=../ch08/ class=md-nav__link> 时间序列 </a> </li> <li class=md-nav__item> <a href=../ch09/ class=md-nav__link> 高阶pandas </a> </li> <li class=md-nav__item> <a href=../ch11/ class=md-nav__link> Python建模库介绍 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_4 type=checkbox id=__nav_4_4> <label class=md-nav__link for=__nav_4_4> 数据结构和算法 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=数据结构和算法 data-md-level=2> <label class=md-nav__title for=__nav_4_4> <span class="md-nav__icon md-icon"></span> 数据结构和算法 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../DataStructure/01_PythonFundmantal/ class=md-nav__link> 基础知识回顾 </a> </li> <li class=md-nav__item> <a href=../../DataStructure/02_CollectionsOverview/ class=md-nav__link> 多项集的概述 </a> </li> <li class=md-nav__item> <a href=../../DataStructure/03_TimeComplexity/ class=md-nav__link> 搜索、排序以及复杂度分析 </a> </li> <li class=md-nav__item> <a href=../../DataStructure/04_ArrayChain/ class=md-nav__link> 数组和链接结构 </a> </li> <li class=md-nav__item> <a href=../../DataStructure/05_InterfacePolymorphism/ class=md-nav__link> 接口、实现和多态 </a> </li> <li class=md-nav__item> <a href=../../DataStructure/06_InheritanceAbstractClass/ class=md-nav__link> 继承与抽象类 </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_5 type=checkbox id=__nav_4_5> <label class=md-nav__link for=__nav_4_5> Effective Python <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label="Effective Python" data-md-level=2> <label class=md-nav__title for=__nav_4_5> <span class="md-nav__icon md-icon"></span> Effective Python </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule01/ class=md-nav__link> 第01条 查询自己使用的Python版本 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule02/ class=md-nav__link> 第02条 遵循PEP 8风格指南 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule03/ class=md-nav__link> 第03条 了解bytes与str的区别 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule04/ class=md-nav__link> 第04条 用支持插值的f-string取代C风格的格式字符串与str.format方法 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule05/ class=md-nav__link> 第05条 用辅助函数取代复杂的表达式 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule06/ class=md-nav__link> 第06条 把数据结构直接拆分到多个变量里，不要专门通过下标访问 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule07/ class=md-nav__link> 第07条 尽量用enumerate取代range </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule08/ class=md-nav__link> 第08条 用zip函数同时遍历两个迭代器 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule09/ class=md-nav__link> 第09条 不要在for与while循环后面写else块 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule10/ class=md-nav__link> 第10条 用赋值表达式减少重复代码 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule11/ class=md-nav__link> 第11条 学会对序列做切片 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule12/ class=md-nav__link> 第12条 不要在切片里同时指定起止下标与步进 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule13/ class=md-nav__link> 第13条 通过带星号的unpacking操作来捕获多个元素,不要用切片 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule14/ class=md-nav__link> 第14条 用sort方法的key参数来表示复杂的排序逻辑 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule15/ class=md-nav__link> 第15条 不要过分依赖给字典添加条目时所用的顺序 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule16/ class=md-nav__link> 第16条 用get处理键不在字典中的情况,不要使用in与KeyError </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule17/ class=md-nav__link> 第17条 用defaultdict处理内部状态中缺失的元素,而不要用setdefault </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule18/ class=md-nav__link> 第18条 学会利用__missing__构造依赖键的默认值 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule19/ class=md-nav__link> 第19条 不要把函数返回的多个数值拆分到三个以上的变量中 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule20/ class=md-nav__link> 第20条 遇到意外状况时应该抛出异常,不要返回None </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule21/ class=md-nav__link> 第21条 了解如何在闭包里面使用外围作用域中的变量 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule22/ class=md-nav__link> 第22条 用数量可变的位置参数给函数设计清晰的参数列表 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule23/ class=md-nav__link> 第23条 用关键字参数来表示可选的行为 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule24/ class=md-nav__link> 第24条 用None和docstring来描述默认值会变的参数 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule25/ class=md-nav__link> 第25条 用只能以关键字指定和只能按位置传入的参数来设计清晰的参数列表 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule26/ class=md-nav__link> 第26条 用functools.wraps定义函数修饰器 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule27/ class=md-nav__link> 第27条 用列表推导取代map与filter </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule28/ class=md-nav__link> 第28条 控制推导逻辑的子表达式不要超过两个 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule29/ class=md-nav__link> 第29条 用赋值表达式消除推导中的重复代码 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule30/ class=md-nav__link> 第30条 不要让函数直接返回列表，应该让它逐个生成列表里的值 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule31/ class=md-nav__link> 第31条 谨慎地迭代函数所收到的参数 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule32/ class=md-nav__link> 第32条 考虑用生成器表达式改写数据量较大的列表推导 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule33/ class=md-nav__link> 第33条 通过yield from把多个生成器连起来用 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule34/ class=md-nav__link> 第34条 不要用send给生成器注入数据 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule35/ class=md-nav__link> 第35条 不要通过throw变换生成器的状态 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule36/ class=md-nav__link> 第36条 考虑用itertools拼装迭代器与生成器 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule37/ class=md-nav__link> 第37条 用组合起来的类来实现多层结构，不要用嵌套的内置类型 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule38/ class=md-nav__link> 第38条 让简单的接口接受函数，而不是类的实例 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule39/ class=md-nav__link> 第39条 通过@classmethod多态来构造同一体系中的各类对象 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule40/ class=md-nav__link> 第40条 通过super初始化超类 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule41/ class=md-nav__link> 第41条 考虑用mix-in类来表示可组合的功能 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule42/ class=md-nav__link> 第42条 优先考虑用public属性表示应受保护的数据,不要用private属性表示 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule43/ class=md-nav__link> 第43条 自定义的容器类型应该从collections.abc继承 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule44/ class=md-nav__link> 第44条 用纯属性与修饰器取代旧式的setter与getter方法 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule45/ class=md-nav__link> 第45条 考虑用@property实现新的属性访问逻辑,不要急着重构原有的代码 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule46/ class=md-nav__link> 第46条 用描述符来改写需要复用的@property方法 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule47/ class=md-nav__link> 第47条 针对惰性属性使用__getattr__、__getattribute__及__setattr__ </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule48/ class=md-nav__link> 第48条 用__init_subclass__验证子类写得是否正确 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule49/ class=md-nav__link> 第49条 用__init_subclass__记录现有的子类 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule50/ class=md-nav__link> 第50条 用__set_name__给类属性加注解 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule51/ class=md-nav__link> 第51条 优先考虑通过类修饰器来提供可组合的扩充功能，不要使用元类 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule52/ class=md-nav__link> 第52条 用subprocess管理子进程 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule53/ class=md-nav__link> 第53条 可以用线程执行阻塞式I/O,但不要用它做并行计算 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule54/ class=md-nav__link> 第54条 利用Lock防止多个线程争用同一份数据 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule55/ class=md-nav__link> 第55条 用Queue来协调各线程之间的工作进度 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule56/ class=md-nav__link> 第56条 学会判断什么场合必须做并发 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule57/ class=md-nav__link> 第57条 不要在每次fan-out时都新建一批Thread实例 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule58/ class=md-nav__link> 第58条 学会正确地重构代码,以便用Queue做并发 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule59/ class=md-nav__link> 第59条 如果必须用线程做并发,那就考虑通过ThreadPoolExecutor实现 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule60/ class=md-nav__link> 第60条 用协程实现高并发的I/O </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule61/ class=md-nav__link> 第61条 学会用asyncio改写那些通过线程实现的I/O </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule62/ class=md-nav__link> 第62条 结合线程与协程,将代码顺利迁移到asyncio </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule63/ class=md-nav__link> 第63条 让asyncio的事件循环保持畅通,以便进一步提升程序的响应能力 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule64/ class=md-nav__link> 第64条 考虑用concurrent.futures实现真正的并行计算 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule65/ class=md-nav__link> 第65条 合理利用try/except/else/finally结构中的每个代码块 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule66/ class=md-nav__link> 第66条 考虑用contextlib和with语句来改写可复用的try/finally代码 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule67/ class=md-nav__link> 第67条 用datetime模块处理本地时间,不要用time模块 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule68/ class=md-nav__link> 第68条 用copyreg实现可靠的pickle操作 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule69/ class=md-nav__link> 第69条 在需要准确计算的场合,用decimal表示相应的数值 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule70/ class=md-nav__link> 第70条 先分析性能，然后再优化 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule71/ class=md-nav__link> 第71条 优先考虑用deque实现生产者-消费者队列 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule72/ class=md-nav__link> 第72条 考虑用bisect搜索已排序的序列 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule73/ class=md-nav__link> 第73条 学会使用heapq制作优先级队列 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule74/ class=md-nav__link> 第74条 考虑用memoryview与bytearray来实现无须拷贝的bytes操作 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule75/ class=md-nav__link> 第75条 通过repr字符串输出调试信息 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule76/ class=md-nav__link> 第76条 在TestCase子类里验证相关的行为 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule77/ class=md-nav__link> 第77条 把测试前、后的准备与清理逻辑写在setUp、tearDown、setUpModule与tearDownModule中,以防用例之间互相干扰 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule78/ class=md-nav__link> 第78条 用Mock来模拟受测代码所依赖的复杂函数 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule79/ class=md-nav__link> 第79条 把受测代码所依赖的系统封装起来，以便于模拟和测试 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule80/ class=md-nav__link> 第80条 考虑用pdb做交互调试 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule81/ class=md-nav__link> 第81条 用tracemalloc来掌握内存的使用与泄漏情况 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule82/ class=md-nav__link> 第82条 学会寻找由其他Python开发者所构建的模块 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule83/ class=md-nav__link> 第83条 用虚拟环境隔离项目,并重建依赖关系 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule84/ class=md-nav__link> 第84条 每一个函数、类与模块都要写docstring </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule85/ class=md-nav__link> 第85条 用包来安排模块,以提供稳固的API </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule86/ class=md-nav__link> 第86条 考虑用模块级别的代码配置不同的部署环境 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule87/ class=md-nav__link> 第87条 为自编的模块定义根异常,让调用者能够专门处理与此API有关的异常 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule88/ class=md-nav__link> 第88条 用适当的方式打破循环依赖关系 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule89/ class=md-nav__link> 第89条 重构时考虑通过warnings提醒开发者API已经发生变化 </a> </li> <li class=md-nav__item> <a href=../../Pythonic90Rules/Rule90/ class=md-nav__link> 第90条 考虑通过typing做静态分析,以消除bug </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4_6 type=checkbox id=__nav_4_6> <label class=md-nav__link for=__nav_4_6> Demos <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Demos data-md-level=2> <label class=md-nav__title for=__nav_4_6> <span class="md-nav__icon md-icon"></span> Demos </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../Demo/CourseSystem/ class=md-nav__link> 选课系统 </a> </li> </ul> </nav> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label="Table of contents"> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> Table of contents </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#ndarray class=md-nav__link> ndarray对象的内部机理 </a> <nav class=md-nav aria-label=ndarray对象的内部机理> <ul class=md-nav__list> <li class=md-nav__item> <a href=#numpy-dtype class=md-nav__link> NumPy dtype层次结构 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 高级数组操作 </a> <nav class=md-nav aria-label=高级数组操作> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 重塑数组 </a> </li> <li class=md-nav__item> <a href=#cf class=md-nav__link> C顺序和F顺序 </a> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 数组连接和分隔 </a> </li> <li class=md-nav__item> <a href=#r_c_ class=md-nav__link> 数组堆叠的方法：r_和c_ </a> </li> <li class=md-nav__item> <a href=#tilerepeat class=md-nav__link> 重复元素：tile和repeat </a> </li> <li class=md-nav__item> <a href=#fancy-indexingtakeput class=md-nav__link> 神奇索引（Fancy Indexing）的等价方法：take和put </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 广播 </a> <nav class=md-nav aria-label=广播> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 广播的规则 </a> </li> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 一维广播 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 二维广播 </a> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 三维广播 </a> </li> <li class=md-nav__item> <a href=#n class=md-nav__link> N维广播 </a> </li> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 通过广播设定数组的值 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#ufunc class=md-nav__link> ufunc高级应用 </a> <nav class=md-nav aria-label=ufunc高级应用> <ul class=md-nav__list> <li class=md-nav__item> <a href=#ufunc_1 class=md-nav__link> ufunc实例方法 </a> </li> <li class=md-nav__item> <a href=#pythonufunc class=md-nav__link> 使用Python编写新的ufunc方法 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 结构化和记录式数组 </a> <nav class=md-nav aria-label=结构化和记录式数组> <ul class=md-nav__list> <li class=md-nav__item> <a href=#dtype class=md-nav__link> 嵌套dtype和多维字段 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 为什么要使用结构化数组 </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <a href=https://github.com/huyuhui001/mySite/edit/main/docs/python/DataAnalysis/ch10.md title="Edit this page" class="md-content__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25Z"/></svg> </a> <h1 id=numpy>NumPy进阶<a class=headerlink href=#numpy title="Permanent link"> ¶</a></h1> <p>包含以下内容：</p> <ul> <li>ndarray对象的内部机理</li> <li>高级数组操作<ul> <li>重塑数组</li> <li>C顺序和F顺序</li> <li>连接和分隔数组</li> <li>堆叠助手：r 和c</li> <li>重复元素：tile和repeat</li> <li>神奇索引的等价方法：take和put</li> </ul> </li> <li>广播</li> <li>ufunc高级应用</li> <li>结构化和记录式数组</li> </ul> <h2 id=ndarray>ndarray对象的内部机理<a class=headerlink href=#ndarray title="Permanent link"> ¶</a></h2> <p>NumPy的<code>ndarray</code>提供了一种将同质数据块（可以是连续或跨越）解释为多维数组对象的方式。 <code>ndarray</code>的数据类型<code>dtype</code>决定了数据的解释方式，比如浮点数、整数、布尔值等。 <code>ndarray</code>的所有数组对象都是数据块的一个跨度视图（strided view）。</p> <p>数组视图<code>arr[::2,::-1]</code>不复制任何数据的原因是什么？ 简单地说，<code>ndarray</code>不只是一块内存和一个<code>dtype</code>，它还有跨度信息，这使得数组能以各种步幅（step size）在内存中移动。</p> <p>更准确地讲，<code>ndarray</code>内部由以下内容组成：</p> <ul> <li>一个指向数据（内存或内存映射文件中的一块数据）的指针。</li> <li>数据类型或<code>dtype</code>，描述在数组中的固定大小值的格子。</li> <li>一个表示数组形状（shape）的元组。</li> <li>一个跨度元组（stride），其中的整数指的是为了前进到当前维度下一个元素需要“跨过”的字节数。</li> </ul> <p>例如，一个10×5的数组，其shape为(10, 5)： <div class=highlight><pre><span></span><code>s = np.ones((10, 5)).shape
print(s)
# (10, 5)
</code></pre></div></p> <p>一个典型的（C阶）3×4×5 float64值（8字节）的数组具有跨度（160,40,8）（通常特定轴上的跨度越大，沿着该轴执行计算的代价越高）： <div class=highlight><pre><span></span><code>s = np.ones((3, 4, 5), dtype=np.float64).strides
print(s)
# (160, 40, 8)
</code></pre></div></p> <p>数组跨度（strides）是构建“零复制”数组视图的关键因素。</p> <p>数组跨度甚至可以是负的，这使得数组能够穿过内存“向后”移动（例如，在诸如obj[::-1]或obj[:, ::-1]的切片中就是这种情况）。</p> <h3 id=numpy-dtype>NumPy dtype层次结构<a class=headerlink href=#numpy-dtype title="Permanent link"> ¶</a></h3> <p>有时候需要通过一些代码来检查数组是否包含整数、浮点数、字符串或Python对象。 由于浮点数有多种类型（float16到float128），因此检查dtype是否在类型列表中会非常麻烦。 dtype有超类，如np.integer和np.floating，它们可以和np.issubdtype函数一起使用： <div class=highlight><pre><span></span><code>ints = np.ones(10, dtype=np.uint16)
floats = np.ones(10, dtype=np.float32)
</code></pre></div></p> <p>可以通过调用类型的mro方法来查看特定dtype的所有父类： <div class=highlight><pre><span></span><code>print(np.float64.mro())
# [&lt;class &#39;numpy.float64&#39;&gt;,
#  &lt;class &#39;numpy.floating&#39;&gt;,
#  &lt;class &#39;numpy.inexact&#39;&gt;,
#  &lt;class &#39;numpy.number&#39;&gt;,
#  &lt;class &#39;numpy.generic&#39;&gt;,
#  &lt;class &#39;float&#39;&gt;,
#  &lt;class &#39;object&#39;&gt;]

print(np.issubdtype(ints.dtype, np.integer))
# True
print(np.issubdtype(floats.dtype, np.floating))
# True
print(np.issubdtype(floats.dtype, np.number))
# True
print(np.issubdtype(floats.dtype, np.generic))
# True
</code></pre></div></p> <h2 id=_1>高级数组操作<a class=headerlink href=#_1 title="Permanent link"> ¶</a></h2> <h3 id=_2>重塑数组<a class=headerlink href=#_2 title="Permanent link"> ¶</a></h3> <p>通常，通过<code>reshape</code>将数组从一个形状转换为另一个形状，并且不复制任何数据。 <code>reshape</code>里面有两种重塑顺序，按C顺序（行方向）的重塑和按Fortran顺序（列方向）的重塑。 首先是取数，然后是放数，取数按什么顺序，放数就按什么顺序。</p> <p>下面是官网的解释：</p> <div class=highlight><pre><span></span><code>‘C’ means to read / write the elements using C-like index order, with the last axis index changing fastest, back to the first axis index changing slowest.

‘F’ means to read / write the elements using Fortran-like index order, with the first index changing fastest, and the last index changing slowest.

Note that the ‘C’ and ‘F’ options take no account of the memory layout of the underlying array, and only refer to the order of indexing.

‘A’ means to read / write the elements in Fortran-like index order if a is Fortran contiguous in memory, C-like order otherwise.
</code></pre></div> <p>一维数组重塑： <div class=highlight><pre><span></span><code>arr = np.arange(8)
print(arr)
# [0 1 2 3 4 5 6 7]

a = arr.reshape((4, 2), order=&#39;C&#39;)
print(a)
# [[0 1]
#  [2 3]
#  [4 5]
#  [6 7]]

a = arr.reshape((4, 2), order=&#39;F&#39;)
print(a)
# [[0 4]
#  [1 5]
#  [2 6]
#  [3 7]]
</code></pre></div></p> <p>多维数组重塑：传递的形状维度可以有一个值是-1，表示维度通过数据进行推断： <div class=highlight><pre><span></span><code>a = arr.reshape((4, 2)).reshape((2, 4))
print(a)
# [[0 1 2 3]
#  [4 5 6 7]]

arr = np.arange(15)
a = arr.reshape((5, -1))  # 15 / 5 = 3列
print(a)
# [[ 0  1  2]
#  [ 3  4  5]
#  [ 6  7  8]
#  [ 9 10 11]
#  [12 13 14]]
print(a.shape)
# (5, 3)
</code></pre></div></p> <p>数组的<code>shape</code>属性是一个**元组**，它也可以被传递给<code>reshape</code>，接上例： <div class=highlight><pre><span></span><code>other_arr = np.ones((3, 5))
print(other_arr.shape)
# (3, 5)

a = arr.reshape(other_arr.shape)
print(a.shape)
# (3, 5)
</code></pre></div></p> <p><code>reshape</code>的反操作可以将更高维度的数组转换为一维数组，这种操作通常被成为扁平化（flattening）或分散化（raveling）。</p> <p>如果结果中的值在原始数组中是连续的，则<code>ravel</code>不会生成底层数值的副本。<code>flatten</code>方法的行为类似于<code>ravel</code>，但它总是生成数据的副本。 <div class=highlight><pre><span></span><code>arr = np.arange(15).reshape((5, 3))
print(arr)
# [[ 0  1  2]
#  [ 3  4  5]
#  [ 6  7  8]
#  [ 9 10 11]
#  [12 13 14]]

a = arr.ravel()
print(a)
# [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]

a = arr.flatten()
print(a)
# [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]
</code></pre></div></p> <h3 id=cf>C顺序和F顺序<a class=headerlink href=#cf title="Permanent link"> ¶</a></h3> <p>数据可以按照不同的顺序进行重塑或扁平化。默认情况下，NumPy数组是按行方向顺序创建的。</p> <p>对于一个二维的数据数组，**C顺序**说明数组每行中的元素存储在相邻的存储单元中。**F顺序**意味着每列数据中的值都存储在相邻的内存位置中。</p> <p>可以通过设置<code>reshape</code>和<code>ravel</code>函数的<code>order</code>参数来表示数据在数组中使用哪种顺序。 <div class=highlight><pre><span></span><code>arr = np.arange(15).reshape((5, 3))
print(arr)
# [[ 0  1  2]
#  [ 3  4  5]
#  [ 6  7  8]
#  [ 9 10 11]
#  [12 13 14]]

print(arr.ravel())
# [ 0  1  2  3  4  5  6  7  8  9 10 11 12 13 14]

print(arr.ravel(&#39;F&#39;))
# [ 0  3  6  9 12  1  4  7 10 13  2  5  8 11 14]
</code></pre></div></p> <p>C顺序和Fortran顺序的核心区别就是在维度方向上遍历的方式。 C顺序/行方向顺序首先遍历更高的维度（例如，在轴0上行进之前先在轴1上行进）。 Fortran顺序/列方向顺序最后遍历更高的维度（例如，在轴1上行进之前先在轴0上行进）。</p> <h3 id=_3>数组连接和分隔<a class=headerlink href=#_3 title="Permanent link"> ¶</a></h3> <p><code>numpy.concatenate</code>可以获取数组的序列（元组、列表等），并沿着输入轴将它们按顺序连接在一起： <div class=highlight><pre><span></span><code>arr1 = np.array(
    [
        [1, 2, 3],
        [4, 5, 6]
    ]
)

arr2 = np.array(
    [
        [7, 8, 9],
        [10, 11, 12]
    ]
)

a = np.concatenate([arr1, arr2], axis=0)
print(a)
# [[ 1  2  3]
#  [ 4  5  6]
#  [ 7  8  9]
#  [10 11 12]]

a = np.concatenate([arr1, arr2], axis=1)
print(a)
# [[ 1  2  3  7  8  9]
#  [ 4  5  6 10 11 12]]
</code></pre></div></p> <p>其他类似<code>concatenate</code>的函数。<code>vstack</code>类似<code>concatenate</code>沿<code>axis=0</code>操作，<code>hstack</code>类似<code>concatenate</code>沿<code>axis=1</code>操作。 <div class=highlight><pre><span></span><code>a = np.vstack((arr1, arr2))
print(a)
# [[ 1  2  3]
#  [ 4  5  6]
#  [ 7  8  9]
#  [10 11 12]]

a = np.hstack((arr1, arr2))
print(a)
# [[ 1  2  3  7  8  9]
#  [ 4  5  6 10 11 12]]
</code></pre></div></p> <p><code>split</code>可以将一个数组沿轴向切片成多个数组。先看一维数组。<code>np.split(arr, 3)</code>表示将数组拆分时的**索引位置** <div class=highlight><pre><span></span><code>arr = np.array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;, &#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;])
print(arr)
# [&#39;a&#39; &#39;b&#39; &#39;c&#39; &#39;d&#39; &#39;e&#39; &#39;f&#39; &#39;g&#39; &#39;h&#39; &#39;i&#39; &#39;j&#39; &#39;k&#39;]

print(np.split(arr, 3))

print(np.split(arr, [3]))  # 从索引位置为3进行拆分
# [array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;, &#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;], dtype=&#39;&lt;U1&#39;)]

print(np.split(arr, [3, 7]))  # 从索引位置为3和7进行拆分
# [array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;h&#39;, &#39;i&#39;, &#39;j&#39;, &#39;k&#39;], dtype=&#39;&lt;U1&#39;)]

print(np.split(arr, [3, 7, 9]))  # 从索引位置为3、7、9进行拆分
# [array([&#39;a&#39;, &#39;b&#39;, &#39;c&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;d&#39;, &#39;e&#39;, &#39;f&#39;, &#39;g&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;h&#39;, &#39;i&#39;], dtype=&#39;&lt;U1&#39;), array([&#39;j&#39;, &#39;k&#39;], dtype=&#39;&lt;U1&#39;)]
</code></pre></div></p> <p>二维数组和一维数组类似。</p> <p><code>np.split(arr, [1, 2])</code>默认axis=0，沿水平方向进行拆分，拆分行索引分别为行号1和行号2，即[0, 1)，[1, 2)，[2, 4]三个行区间。</p> <p><code>np.split(arr, [1, 2], axis=1)</code>沿垂直方向进行拆分，拆分列索引分别为列号1和列号2，即[0, 1)，[1, 2)，[2, 3]三个列区间。</p> <p>如果拆分区间出现倒序，如<code>np.split(arr, [3, 1])</code>，沿水平方向拆分，第一个行区间是[0, 3)，第二个行区间是[3, 1)，无结果，当前行索引为0，未达到最大行数，所以输出第三个区间[1, 4]。同理可推<code>np.split(arr, [3, 1], axis=1)</code>的三个列区间。 <div class=highlight><pre><span></span><code>arr = np.arange(15).reshape((5, 3))
print(arr)
# [[ 0  1  2]
#  [ 3  4  5]
#  [ 6  7  8]
#  [ 9 10 11]
#  [12 13 14]]

result = np.split(arr, [1, 2])
print(result)
# [array([[0, 1, 2]]), 
#  array([[3, 4, 5]]), 
#  array([[ 6,  7,  8],
#        [ 9, 10, 11],
#        [12, 13, 14]])]

result = np.split(arr, [1, 2], axis=1)
print(result)
# [array([[ 0],
#         [ 3],
#         [ 6],
#         [ 9],
#         [12]]), 
#  array([[ 1],
#         [ 4],
#         [ 7],
#         [10],
#         [13]]), 
#  array([[ 2],
#         [ 5],
#         [ 8],
#         [11],
#         [14]])]

result = np.split(arr, [3, 1])
print(result)
# [array([[0, 1, 2],
#        [3, 4, 5],
#        [6, 7, 8]]),
#  array([], shape=(0, 3), dtype=int64),
#  array([[ 3,  4,  5],
#         [ 6,  7,  8],
#         [ 9, 10, 11],
#         [12, 13, 14]])

result = np.split(arr, [3, 1], axis=1)
print(result)
# [array([[ 0,  1,  2],
#         [ 3,  4,  5],
#         [ 6,  7,  8],
#         [ 9, 10, 11],
#         [12, 13, 14]]), 
#  array([], shape=(5, 0), dtype=int64), 
#  array([[ 1,  2],
#         [ 4,  5],
#         [ 7,  8],
#         [10, 11],
#         [13, 14]])]
</code></pre></div></p> <h3 id=r_c_>数组堆叠的方法：r_和c_<a class=headerlink href=#r_c_ title="Permanent link"> ¶</a></h3> <p>在NumPy中有两个特殊的对象：r_和c_，它们可以使堆栈数组的操作更为简洁：</p> <ul> <li><code>np.r_</code>是按列连接两个矩阵，就是把两矩阵上下相加，要求列数相等。</li> <li><code>np.c_</code>是按行连接两个矩阵，就是把两矩阵左右相加，要求行数相等。</li> </ul> <div class=highlight><pre><span></span><code>arr = np.arange(6)
arr1 = arr.reshape((3, 2))
arr2 = np.random.randn(3, 2)

print(arr)
# [0 1 2 3 4 5]
print(arr1)
# [[0 1]
#  [2 3]
#  [4 5]]
print(arr2)
# [[ 0.15407269  0.56316672]
#  [-1.2390795  -1.59294986]
#  [ 0.082398    0.75602857]]

a = np.r_[arr1, arr2]
print(a)
# [[ 0.          1.        ]
#  [ 2.          3.        ]
#  [ 4.          5.        ]
#  [ 0.15407269  0.56316672]
#  [-1.2390795  -1.59294986]
#  [ 0.082398    0.75602857]]

a = np.c_[arr1, arr2]
print(a)
# [[ 0.          1.          0.15407269  0.56316672]
#  [ 2.          3.         -1.2390795  -1.59294986]
#  [ 4.          5.          0.082398    0.75602857]]

a = np.c_[np.r_[arr1, arr2], arr]
print(a)
# [[ 0.          1.          0.        ]
#  [ 2.          3.          1.        ]
#  [ 4.          5.          2.        ]
#  [ 0.15407269  0.56316672  3.        ]
#  [-1.2390795  -1.59294986  4.        ]
#  [ 0.082398    0.75602857  5.        ]]
</code></pre></div> <p>还可以将切片转换为数组： <div class=highlight><pre><span></span><code>a = np.c_[1:6, -10:-5]
print(a)
# [[  1 -10]
#  [  2  -9]
#  [  3  -8]
#  [  4  -7]
#  [  5  -6]]
</code></pre></div></p> <h3 id=tilerepeat>重复元素：tile和repeat<a class=headerlink href=#tilerepeat title="Permanent link"> ¶</a></h3> <p><code>repeat</code>和<code>tile</code>函数是用于重复或复制数组的两个有用的工具。<code>repeat</code>函数按照给定次数对数组中的*每个元素*进行复制，生成一个更大的数组。</p> <p>对于NumPy而言，复制或重复数组的需求可能不如其他数组编程框架（如MATLAB）那样常见。其中一个原因是广播通常会更好地满足这一需求。 <div class=highlight><pre><span></span><code>arr = np.arange(3)
print(arr)
# [0 1 2]

a = arr.repeat(3)
print(a)
# [0 0 0 1 1 1 2 2 2]
</code></pre></div></p> <p>默认情况下，如果你传递一个整数，每个元素都会复制相应的次数。如果你传递了一个整数数组，每个元素都会重复相应的不同次数： <div class=highlight><pre><span></span><code>arr = np.arange(3)
print(arr)
# [0 1 2]

a = arr.repeat([2, 3, 4])
print(a)
# [0 0 1 1 1 2 2 2 2]
</code></pre></div></p> <p>多维数组可以在指定的轴向上对它们的元素进行重复，注意，如果没有传递轴，数组将首先扁平化（沿0轴复制）。 <div class=highlight><pre><span></span><code>arr = np.random.randn(2, 2)
print(arr)
# [[-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]]

a = arr.repeat(2, axis=0)
print(a)
# [[-0.15870621  0.26521446]
#  [-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]
#  [-1.35042383 -0.65562376]]

a = arr.repeat(2, axis=1)
print(a)
# [[-0.15870621 -0.15870621  0.26521446  0.26521446]
#  [-1.35042383 -1.35042383 -0.65562376 -0.65562376]]
</code></pre></div></p> <p>同样，需要按照不同次数重复多维数组的切片时，可以传递一个整数数组： <div class=highlight><pre><span></span><code>arr = np.random.randn(2, 2)
print(arr)
# [[-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]]

a = arr.repeat([2, 3], axis=0)
print(a)
# [[-0.15870621  0.26521446]
#  [-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]
#  [-1.35042383 -0.65562376]
#  [-1.35042383 -0.65562376]]
</code></pre></div></p> <p><code>tile</code>是一种快捷方法，它可以沿着轴向堆叠副本。在视觉上，你可以把它看作类似于“铺设瓷砖”。 <code>np.tile(arr, 2)</code>第二个参数是瓷砖的数量。用标量来说，铺设是逐行进行的，而不是逐列，第二个参数也可以是表示“铺瓷砖”布局的元组。 <div class=highlight><pre><span></span><code>arr = np.random.randn(2, 2)
print(arr)
# [[-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]]

a = np.tile(arr, 2)
print(a)
# [[-0.15870621  0.26521446 -0.15870621  0.26521446]
#  [-1.35042383 -0.65562376 -1.35042383 -0.65562376]]

a = np.tile(arr, (2, 1))
print(a)
# [[-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]
#  [-0.15870621  0.26521446]
#  [-1.35042383 -0.65562376]]

a = np.tile(arr, (3, 2))
print(a)
# [[-0.15870621  0.26521446 -0.15870621  0.26521446]
#  [-1.35042383 -0.65562376 -1.35042383 -0.65562376]
#  [-0.15870621  0.26521446 -0.15870621  0.26521446]
#  [-1.35042383 -0.65562376 -1.35042383 -0.65562376]
#  [-0.15870621  0.26521446 -0.15870621  0.26521446]
#  [-1.35042383 -0.65562376 -1.35042383 -0.65562376]]
</code></pre></div></p> <h3 id=fancy-indexingtakeput>神奇索引（Fancy Indexing）的等价方法：take和put<a class=headerlink href=#fancy-indexingtakeput title="Permanent link"> ¶</a></h3> <p><code>take</code>函数可以获取数组子集，<code>put</code>函数可以设置数组子集。其他一些ndarray方法可以用于特殊情况下在单个轴上的数据选取. <div class=highlight><pre><span></span><code>arr = np.arange(10) * 100
inds = [7, 1, 2, 6]

print(arr)
# [  0 100 200 300 400 500 600 700 800 900]
print(inds)
# [7, 1, 2, 6]

# 从arr序列中依次获取索引为7,1,2,6位置上的元素。
a = np.take(arr, inds)
print(a)
# [700 100 200 600]
print(arr)
# [  0 100 200 300 400 500 600 700 800 900]


arr = np.arange(10) * 100
inds = [7, 1, 2, 6]

# 相当于将arr序列中索引为7,1,2,6位置上的元素用42来替换
np.put(arr, inds, 41)
print(arr)
# [  0  41  41 300 400 500  41  41 800 900]

arr = np.arange(10) * 100
inds = [7, 1, 2, 6]

np.put(arr, inds, [40, 41, 42])
print(arr)
# [  0  41  42 300 400 500  40  40 800 900]
</code></pre></div></p> <p>注意，上例如果改写为<code>a = np.put(arr, inds, 41)</code>，则返回<code>None</code>。 <div class=highlight><pre><span></span><code>a = np.put(arr, inds, 41)
print(a)
# None
</code></pre></div></p> <p>如果要在别的轴上使用<code>take</code>，可以通过传递<code>axis</code>关键字来实现。 <div class=highlight><pre><span></span><code>inds = [2, 0, 2, 1]
arr = np.random.randn(2, 4)
print(arr)
# [[-0.82371274 -0.16911898 -0.01903239 -0.91792531]
#  [-0.55176496 -0.30111564  0.33872999  0.32454671]]

a = arr.take(inds, axis=1)
print(a)
# [[-0.01903239 -0.82371274 -0.01903239 -0.16911898]
#  [ 0.33872999 -0.55176496  0.33872999 -0.30111564]]
</code></pre></div></p> <h2 id=_4>广播<a class=headerlink href=#_4 title="Permanent link"> ¶</a></h2> <p>**广播（broadcasting）**指的是不同形状的数组之间的算术运算的执行方式。受某些约束的影响，较小的数组在较大的数组上“广播”，以便它们具有兼容的形状。广播提供了一种矢量化数组操作的方法。</p> <p>NumPy 操作通常在*逐个元素*的基础上在数组对上完成。在最简单的情况下，两个数组必须具有完全相同的形状，如下例所示： <div class=highlight><pre><span></span><code>a = np.array([1, 3, 5])
b = np.array([2, 2, 2])

print(a * b)
# [ 2  6 10]

print(a + b)
# [3 5 7]
</code></pre></div></p> <p>当一个数组和一个标量值在一个操作中组合时，会发生最简单的广播示例，NumPy的广播规则放宽了这种约束。 <div class=highlight><pre><span></span><code>a = np.array([1, 3, 5])
b = 2

print(a * b)
# [ 2  6 10]

print(a + b)
# [3 5 7]
</code></pre></div></p> <p>结果等同于前面的示例，其中<code>b</code>是数组。可以假象将在算术运算期间标量<code>b</code>被*拉伸*成与数组<code>a</code>具有相同形状的数组。拉伸类比只是概念性的。NumPy在实际运算中直接使用原始标量值而不会去制作拉伸副本，因此广播操作效率更高效，在上例的乘法期间，通过广播操作，移动的内存较少（b是标量而不是数组）。</p> <h3 id=_5>广播的规则<a class=headerlink href=#_5 title="Permanent link"> ¶</a></h3> <p><strong>广播的规则</strong>：</p> <p>如果两个数组的后缘维度（trailing dimension，即从末尾开始算起的维度）的轴长度相符，或其中的一方的长度为1，则认为它们是广播兼容的。广播会在缺失和（或）长度为1的维度上进行。</p> <p>这句话是理解广播的核心。广播主要发生在两种情况，一种是两个数组的维数不相等，但是它们的后缘维度的轴长相符，另外一种是有一方的长度为1。</p> <p>如果不满足这些条件，则抛出 ValueError: operands could not be broadcast together 异常，指示数组具有不兼容的形状。结果数组的大小是沿输入的每个轴不是1的大小。</p> <p>将标量值跟数组合并时就会发生最简单的广播，标量值4已经被广播给乘法运算中的所有其他元素。 <div class=highlight><pre><span></span><code>arr = np.arange(5)
print(arr * 4)
# [ 0  4  8 12 16]
</code></pre></div></p> <h3 id=_6>一维广播<a class=headerlink href=#_6 title="Permanent link"> ¶</a></h3> <p>下面是一个一维数组沿0轴广播的例子： <div class=highlight><pre><span></span><code>arr1 = np.array([[0, 0, 0], [1, 1, 1], [2, 2, 2], [3, 3, 3]])
print(arr1.shape)
# (4, 3)

arr2 = np.array([1, 2, 3])
print(arr2.shape)
# (3,)

arr_sum = arr1 + arr2
print(arr_sum)
# [[1 2 3]
#  [2 3 4]
#  [3 4 5]
#  [4 5 6]]
</code></pre></div> <img alt=一维数组沿0轴广播 src=../Assets/05.png></p> <p>上例中<code>arr1</code>的<code>shape</code>为<code>(4,3)</code>，<code>arr2</code>的<code>shape</code>为<code>(3,)</code>。即，<code>arr1</code>是二维数组，<code>arr2</code>是一维数组。虽然它们的维度<code>shape</code>不同，但后缘维度都是<code>3</code>，符合广播规则，所以它们之间是可以执行相加操作。</p> <p>在这个例子当中是将arr2沿着0轴进行扩展。直观的描述是，<code>arr2</code>在参与运算时是以下面这样的形式进行0轴扩展的（沿0轴水平方向移动，在列方向进行“拉伸”）： <div class=highlight><pre><span></span><code>[[1 2 3]
 [1 2 3]
 [1 2 3]
 [1 2 3]]
</code></pre></div></p> <h3 id=_7>二维广播<a class=headerlink href=#_7 title="Permanent link"> ¶</a></h3> <p>在下面行减均值的例子中，根据规则，为了从轴1减均值（即从每行减去行平均值），对较小的数组<code>row_means</code>的塑形必须是（4, 1），即，重新塑造行意味着形状是（4,1）而不是（4, ）。 <div class=highlight><pre><span></span><code>arr = np.array([[1, 2, 3], [4, 5, 6], [1, 2, 3], [4, 5, 6]])
print(arr)
# [[1 2 3]
#  [4 5 6]
#  [1 2 3]
#  [4 5 6]]

row_means = arr.mean(1)

print(row_means)
# [2. 5. 2. 5.]

print(row_means.reshape(4, 1))
# [[2.]
#  [5.]
#  [2.]
#  [5.]]

demeaned = arr - row_means.reshape((4, 1))

print(demeaned)
# [[-1.  0.  1.]
#  [-1.  0.  1.]
#  [-1.  0.  1.]
#  [-1.  0.  1.]]

print(demeaned.mean(1))
# [0. 0. 0. 0.]
</code></pre></div> <img alt=二维数组沿1轴广播 src=../Assets/06.png></p> <h3 id=_8>三维广播<a class=headerlink href=#_8 title="Permanent link"> ¶</a></h3> <p>在轴0以外的轴上使用较低维数组进行算术运算也是相当普遍的。根据广播规则，“广播维度”在较小的数组中必须为1。</p> <p>在三维情况下，在三个维度中的任何一个维度上进行广播只是将数据重塑为形状兼容。</p> <p>因此，需要添加一个长度为1的新轴，专门用于广播目的。使用<code>reshape</code>是一种选择，但插入一个轴需要构造一个新形状的元组。NumPy数组提供了<code>np.newaxis</code>属性和“完整”切片来插入新轴。</p> <p>看下面的例子了解一些<code>np.newaxis</code>的用法。</p> <p><code>x1[:, np.newaxis]</code>对原<code>x1</code>添加了1轴，即，行方向有5个元素（5行），列方向只有1个元素（1列）。</p> <p><code>x1[np.newaxis, :]</code>对原<code>x1</code>添加了0轴，即，行方向有1个元素（1行），列方向只有5个元素（5列）。 <div class=highlight><pre><span></span><code>x1 = np.array([1, 2, 3, 4, 5])
print(x1.shape)
# (5,)

x1_new = x1[:, np.newaxis]
print(x1_new.shape)
# (5, 1)
print(x1_new)
# [[1]
#  [2]
#  [3]
#  [4]
#  [5]]

x2_new = x1[np.newaxis, :]
print(x1_new.shape)
# (1, 5)
print(x1_new)
# [[1 2 3 4 5]]
</code></pre></div></p> <p>下例一个通过<code>np.newaxis</code>对二维数组到三维的扩展。</p> <p><code>arr[np.newaxis, :, :, np.newaxis]</code>表示对<code>arr</code>添加0，3轴，原数组<code>arr</code>做为1，2轴。其等价写法是<code>arr[np.newaxis, ..., np.newaxis]</code></p> <p><code>arr[:, np.newaxis, np.newaxis]</code>表示对<code>arr</code>添加1，2轴，原数组<code>arr</code>做为0，3轴。其等价写法是<code>arr[np.newaxis, :, np.newaxis, :]</code>，理解上需要注意的是<code>:</code>只代表一个轴。 <div class=highlight><pre><span></span><code>arr = np.arange(3 * 4).reshape(3, 4)
print(arr.shape)
# (3, 4)
print(arr)
# [[ 0  1  2  3]
#  [ 4  5  6  7]
#  [ 8  9 10 11]]

arr_3D = arr[np.newaxis, :, :, np.newaxis]
print(arr_3D.shape)
# (1, 3, 1, 4)
arr_3D = arr[np.newaxis, ..., np.newaxis]
print(arr_3D.shape)
# (1, 3, 4, 1)
print(arr_3D)
# [[[[ 0]
#    [ 1]
#    [ 2]
#    [ 3]]
#
#   [[ 4]
#    [ 5]
#    [ 6]
#    [ 7]]
#
#   [[ 8]
#    [ 9]
#    [10]
#    [11]]]]

arr_3D = arr[np.newaxis, :, np.newaxis]
print(arr_3D.shape)
# (1, 3, 1, 4)
arr_3D = arr[np.newaxis, :, np.newaxis, :]
print(arr_3D.shape)
# (1, 3, 1, 4)
print(arr_3D)
# [[[[ 0  1  2  3]]
#
#   [[ 4  5  6  7]]
#
#   [[ 8  9 10 11]]]]

arr_3D = arr[:, np.newaxis, np.newaxis]
print(arr_3D.shape)
# (3, 1, 1, 4)
arr_3D = arr[:, np.newaxis, np.newaxis, :]
print(arr_3D.shape)
# (3, 1, 1, 4)
print(arr_3D)
# [[[[0 1 2]]]
#
#  [[[3 4 5]]]
#
#  [[[6 7 8]]]]
</code></pre></div></p> <p>下图显示了在三维数组的每个轴上广播所需的形状。</p> <p><img alt=三维数组的每个轴上广播所需的形状 src=../Assets/07.png></p> <p>下面的例子演示了基于一个三维数组进行的广播操作。</p> <div class=highlight><pre><span></span><code>arr = np.zeros((3, 2, 4))
print(arr.shape)
# (3, 2, 4)
print(arr)
# [[[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]
#
#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]
#
#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]]

# 生成0轴切片
arr_0 = np.arange(2)
print(arr_0.shape)
# (2,)
print(arr_0)
# [0 1]
arr_new = arr_0[np.newaxis, :, np.newaxis]
print(arr_new.shape)
# (1, 2, 1)
print(arr_new)
# [[[0]
#   [1]]]

arr = arr + arr_new
print(arr.shape)
# (3, 2, 4)
print(arr)
# [[[0. 0. 0. 0.]
#   [1. 1. 1. 1.]]
#
#  [[0. 0. 0. 0.]
#   [1. 1. 1. 1.]]
#
#  [[0. 0. 0. 0.]
#   [1. 1. 1. 1.]]]

# 生成1轴切片
arr = np.zeros((3, 2, 4))
arr_1 = np.arange(12).reshape(3, 4)
print(arr_1.shape)
# (3, 4)
arr_new = arr_1[:, np.newaxis, :]
print(arr_new.shape)
# (3, 1, 4)
print(arr_new)
# [[[ 0  1  2  3]]
# 
#  [[ 4  5  6  7]]
# 
#  [[ 8  9 10 11]]]
arr = arr + arr_new
print(arr)
# [[[ 0.  1.  2.  3.]
#   [ 0.  1.  2.  3.]]

#  [[ 4.  5.  6.  7.]
#   [ 4.  5.  6.  7.]]

#  [[ 8.  9. 10. 11.]
#   [ 8.  9. 10. 11.]]]

# 生成2轴切片
arr = np.zeros((3, 2, 4))
arr_2 = np.arange(6).reshape(3, 2)
arr_new = arr_2[:, :, np.newaxis]
print(arr_new.shape)
# (3, 2, 1)
print(arr_new)
# [[[0]
#   [1]]

#  [[2]
#   [3]]

#  [[4]
#   [5]]]
arr = arr + arr_new
print(arr)
# [[[0. 1. 2. 3.]
#   [1. 2. 3. 4.]]
#
#  [[1. 2. 3. 4.]
#   [2. 3. 4. 5.]]
#
#  [[2. 3. 4. 5.]
#   [3. 4. 5. 6.]]]


# 在轴2上减去均值
depth_means = arr.mean(2)
print(depth_means)
# [[0. 1.]
#  [2. 3.]
#  [4. 5.]]

arr_new = depth_means[:, :, np.newaxis]
print(arr_new.shape)
# (3, 2, 1)
demeaned = arr - arr_new
print(demeaned)
# [[[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]

#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]

#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]]
</code></pre></div> <h3 id=n>N维广播<a class=headerlink href=#n title="Permanent link"> ¶</a></h3> <p>和上例最后场景的计算结果相同。</p> <div class=highlight><pre><span></span><code>arr = np.zeros((3, 2, 4))

def demean_axis(arr, axis=0):
    means = arr.mean(axis)
    indexer = [slice(None)] * arr.ndim
    indexer[axis] = np.newaxis
    return arr - means[indexer]

print(demean_axis(arr, axis=2))
# [[[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]

#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]

#  [[0. 0. 0. 0.]
#   [0. 0. 0. 0.]]]
</code></pre></div> <h3 id=_9>通过广播设定数组的值<a class=headerlink href=#_9 title="Permanent link"> ¶</a></h3> <p>进行数组算术运算的广播规则同样也适用于通过数组索引设置值。</p> <div class=highlight><pre><span></span><code>arr = np.zeros((4, 3))
arr[:] = 5
print(arr)
# [[5. 5. 5.]
#  [5. 5. 5.]
#  [5. 5. 5.]
#  [5. 5. 5.]]

col = np.arange(4)
arr[:] = col[:, np.newaxis]
print(arr)
# [[0. 0. 0.]
#  [1. 1. 1.]
#  [2. 2. 2.]
#  [3. 3. 3.]]
</code></pre></div> <h2 id=ufunc>ufunc高级应用<a class=headerlink href=#ufunc title="Permanent link"> ¶</a></h2> <h3 id=ufunc_1>ufunc实例方法<a class=headerlink href=#ufunc_1 title="Permanent link"> ¶</a></h3> <p><strong>通用函数（或简称为ufunc ）**是一种<code>ndarrays</code>以逐元素方式操作的函数，支持数组广播，类型转换和其他一些标准功能。 也就是说，ufunc是一个函数的**矢量化包装器</strong>，它接受固定数量的特定输入并产生固定数量的特定输出。</p> <p>在NumPy中，通用函数是numpy.ufunc类的实例。 NumPy的每个二元ufunc（通用函数）都有特殊的方法来执行某些特殊的向量化操作。</p> <p><code>reduce</code>方法接收单个数组并通过执行一系列二元操作在指定的轴向上对数组的值进行聚合。</p> <p>例如，使用np.add.reduce是对数组中元素进行加和的另一种方法：起始值（对于add方法是0）取决于ufunc。如果传递了一个轴，则沿该轴执行缩聚（collapse）。 <div class=highlight><pre><span></span><code>arr = np.arange(10)

a = np.add.reduce(arr)
print(a)
# 45

a = arr.sum()
print(a)
# 45
</code></pre></div></p> <p>例如：使用np.logical_and来检查数组的每一行中的值是否被排序(logical_and.reduce等价于all方法)： <div class=highlight><pre><span></span><code>arr = np.random.randn(5, 5)
print(arr)
# [[ 0.75217836  1.26134639 -0.39387918  0.46348823 -1.0026674 ]
#  [ 0.72085602 -0.50487667  3.21023694 -0.2752039  -1.41158734]
#  [ 1.69031532  0.61134097  0.58282835  1.03043232 -0.1609196 ]
#  [-3.05141239  0.47221317  1.36464297  0.17500156  1.26158638]
#  [-0.21578318  0.37700321  1.05427816  1.56526207 -0.08290142]]

# 对数组arr行进行排序
a = arr[::2].sort(1)
print(a)
# None

a = arr[:, :-1] &lt; arr[:, 1:]
print(a)
# [[ True  True  True  True]
#  [False  True False False]
#  [ True  True  True  True]
#  [ True  True False  True]
#  [ True  True  True  True]]

a = np.logical_and.reduce(arr[:, :-1] &lt; arr[:, 1:], axis=1)
print(a)
# [ True False  True False  True]
</code></pre></div></p> <p><code>accumulate</code>与<code>reduce</code>是相关的，就像<code>cumsum</code>与<code>sum</code>相关一样。<code>accumulate</code>生成一个数组，其尺寸与中间“累计”值相同： <div class=highlight><pre><span></span><code>arr = np.arange(15).reshape((3, 5))
print(arr)
# [[ 0  1  2  3  4]
#  [ 5  6  7  8  9]
#  [10 11 12 13 14]]

a = np.add.accumulate(arr, axis=1)
print(a)
# [[ 0  1  3  6 10]
#  [ 5 11 18 26 35]
#  [10 21 33 46 60]]
</code></pre></div></p> <p><code>outer</code>在两个数组之间执行成对的交叉乘积： <div class=highlight><pre><span></span><code>arr = np.arange(3).repeat([1, 2, 2])
print(arr)
# [0 1 1 2 2]

a = np.multiply.outer(arr, np.arange(5))
print(a)
# [[0 0 0 0 0]
#  [0 1 2 3 4]
#  [0 1 2 3 4]
#  [0 2 4 6 8]
#  [0 2 4 6 8]]
</code></pre></div></p> <p><code>outer</code>输出的维度等于输入的维度总和： <div class=highlight><pre><span></span><code>x, y = np.random.randn(3, 4), np.random.randn(5)
result = np.subtract.outer(x, y)
print(result.shape)
# (3, 4, 5)
</code></pre></div></p> <p><code>reduceat</code>方法执行“本地缩聚”，本质上是一个数组groupby操作，在操作中数组的切片聚合在了一起。<code>reduceat</code>方法接受一系列的“箱体边缘”，这些箱体边缘表示如何分隔以及聚合数据值。</p> <p>下例是在arr的<code>[0:5)</code>、<code>[5:8)</code>和<code>[8:]</code>三个区间上执行了缩聚（此处是计算累加和）。 <div class=highlight><pre><span></span><code>arr = np.arange(10)
a = np.add.reduceat(arr, [0, 5, 8])
print(a)
# [10 18 17]
</code></pre></div></p> <p>可以传递一个axis参数： <div class=highlight><pre><span></span><code>arr = np.multiply.outer(np.arange(4), np.arange(5))
print(arr)
# [[ 0  0  0  0  0]
#  [ 0  1  2  3  4]
#  [ 0  2  4  6  8]
#  [ 0  3  6  9 12]]

a = np.add.reduceat(arr, [0, 2, 4], axis=1)
print(a)
# [[ 0  0  0]
#  [ 1  5  4]
#  [ 2 10  8]
#  [ 3 15 12]]
</code></pre></div></p> <h3 id=pythonufunc>使用Python编写新的ufunc方法<a class=headerlink href=#pythonufunc title="Permanent link"> ¶</a></h3> <p>有很多工具可以用于创建你自己的NumPy ufunc，最常用的是NumPy的C语言API，但不在这里讨论。这里主要关注纯Python的ufunc方法。</p> <p><code>numpy.frompyfunc</code>函数接收一个具有特定数字输入和输出的函数。使用<code>frompyfunc</code>创建的函数通常返回的是Python对象的数组，这并不方便。还有另一个函数<code>numpy.vectorize</code>允许指定输出的类型（但功能稍差）。</p> <p>例如，一个简单的按元素相加的函数可以如下： <div class=highlight><pre><span></span><code>def add_elements(x, y):
    return x + y

add_them = np.frompyfunc(add_elements, 2, 1)
result = add_them(np.arange(8), np.arange(8))
print(result)
# [0 2 4 6 8 10 12 14]

add_them = np.vectorize(add_elements, otypes=[np.float64])
result = add_them(np.arange(8), np.arange(8))
print(result)
# [ 0.  2.  4.  6.  8. 10. 12. 14.]
</code></pre></div></p> <h2 id=_10>结构化和记录式数组<a class=headerlink href=#_10 title="Permanent link"> ¶</a></h2> <p><code>ndarray</code>是一个同构数据的容器。也就是说，它表示一个内存块，其中每个元素占用相同数量的字节，由dtype确定。<code>ndarray</code>的这种特性不能用来表示异构的数据或表格型数据。</p> <p>**结构化数组**是一个<code>ndarray</code>，其中每个元素可以被认为代表C中的struct（因此是“结构化”的名称），或者是SQL表中具有多个命名字段的行： <div class=highlight><pre><span></span><code>dtype = [(&#39;x&#39;, np.float64), (&#39;y&#39;, np.int32)]

sarr = np.array(
    [
        (1.5, 6),
        (np.pi, -2)
    ],
    dtype=dtype
)

print(sarr)
# [(1.5       ,  6) (3.14159265, -2)]
</code></pre></div></p> <p>有几种方法可以指定结构化的dtype（请参阅NumPy官方在线文档）。一种典型的方式是使用(field_name, field_data_type)作为元组的列表。</p> <p>数组的元素是元组对象，其元素可以像字典一样访问，字段名称存储在dtype.names属性中。 <div class=highlight><pre><span></span><code>print(sarr[0])
# (1.5, 6)

print(sarr[&#39;x&#39;])
# [1.5        3.14159265]

print(sarr[0][&#39;y&#39;])
# 6
</code></pre></div></p> <h3 id=dtype>嵌套dtype和多维字段<a class=headerlink href=#dtype title="Permanent link"> ¶</a></h3> <p>当指定结构化的dtype时，可以另外传递一个形状（以int或元组的形式）： <div class=highlight><pre><span></span><code>dtype = [(&#39;x&#39;, np.int64, 3), (&#39;y&#39;, np.int32)]
arr = np.zeros(4, dtype=dtype)
print(arr)
# [([0, 0, 0], 0) ([0, 0, 0], 0) ([0, 0, 0], 0) ([0, 0, 0], 0)]
</code></pre></div></p> <p><code>x</code>字段引用的是每条记录中长度为3的数组： <div class=highlight><pre><span></span><code>print(arr[0][&#39;x&#39;])
# [0 0 0]
</code></pre></div></p> <p>访问<code>arr['x']</code>然后返回一个二维数组，而不是返回一个一维数组： <div class=highlight><pre><span></span><code>print(arr[&#39;x&#39;])
# [[0 0 0]
#  [0 0 0]
#  [0 0 0]
#  [0 0 0]]
</code></pre></div></p> <h3 id=_11>为什么要使用结构化数组<a class=headerlink href=#_11 title="Permanent link"> ¶</a></h3> <p>与pandas的DataFrame相比，NumPy结构化数组是一个相对底层的工具。</p> <p>结构化数组提供了一种将内存块解释为具有任意复杂嵌套列的表格结构的方法。</p> <p>由于数组中的每个元素都在内存中表示为固定数量的字节，因此结构化数组提供了读/写磁盘（包括内存映射）数据，以及在网络上传输数据和其他此类用途的非常快速有效的方法。</p> <p>作为结构化数组的另一种常见用途，将数据文件编写为固定长度的记录字节流是将C和C ++代码中的数据序列化的常用方法，这在业界传统系统中很常见。</p> <p>只要知道文件的格式（每个记录的大小以及每个元素的顺序、字节大小和数据类型），就可以用np.fromfile将数据读入内存。</p> </article> </div> </div> <a href=# class="md-top md-icon" data-md-component=top hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg> Back to top </a> </main> <footer class=md-footer> <nav class="md-footer__inner md-grid" aria-label=Footer> <a href=../ch01/ class="md-footer__link md-footer__link--prev" aria-label="Previous: NumPy基础" rel=prev> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg> </div> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Previous </span> NumPy基础 </div> </div> </a> <a href=../ch02/ class="md-footer__link md-footer__link--next" aria-label="Next: Pandas入门" rel=next> <div class=md-footer__title> <div class=md-ellipsis> <span class=md-footer__direction> Next </span> Pandas入门 </div> </div> <div class="md-footer__button md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg> </div> </a> </nav> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-copyright> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../..", "features": ["navigation.tabs", "navigation.tabs.sticky", "navigation.instant", "navigation.top"], "search": "../../../assets/javascripts/workers/search.ecf98df9.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script> <script src=../../../assets/javascripts/bundle.2ab50757.min.js></script> </body> </html>